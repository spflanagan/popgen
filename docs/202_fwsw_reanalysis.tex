%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Modified by Sarah P. Flanagan
%% From manuscriptPackage https://github.com/jhollist/manuscriptPackage/
%% Original default rstudio/pandoc latex file
%% upated by @jhollist 09/15/2014
%% inspired by @cboetting https://github.com/cboettig/template and
%% @rmflight blog posts:
%% http://rmflight.github.io/posts/2014/07/analyses_as_packages.html 
%% http://rmflight.github.io/posts/2014/07/vignetteAnalysis.html).  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt,]{article}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{xcolor}
\usepackage{fixltx2e} % provides \textsubscript
\def\tightlist{}
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{longtable,booktabs}

\usepackage{graphicx}
% Redefine \includegraphics so that, unless explicit options are
% given, the image width will not exceed the width of the page.
% Images get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\ScaleIfNeeded{%
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother
\let\Oldincludegraphics\includegraphics
{%
 \catcode`\@=11\relax%
 \gdef\includegraphics{\@ifnextchar[{\Oldincludegraphics}{\Oldincludegraphics[width=\ScaleIfNeeded]}}%
}%

\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={Supplemental Material for Multiple colonizations of freshwater by the Gulf pipefish reveal a shared genomic signature of adaptation},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Changes borrowed from @cboettig, added by @jhollist 
% A modified page layout 
\textwidth 6.75in
\oddsidemargin -0.15in
\evensidemargin -0.15in
\textheight 9in
\topmargin -0.5in
\usepackage{lineno} % add 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%Packages and layout changes by @jhollist 09/15/2014
\usepackage{ragged2e}
\usepackage[font=normalsize]{caption}
  \usepackage[singlespacing]{setspace}
\usepackage{parskip}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\lfoot{\thepage}
%%Changed default abstract width and added lines
\renewenvironment{abstract}{
  \hfill\begin{minipage}{1\textwidth}
  \rule{\textwidth}{1pt}\vspace{5pt}
  \normalsize
  \begin{justify}
  \bfseries\abstractname\vspace{5pt}
  \end{justify}}
  {\par\noindent\rule{\textwidth}{1pt}\end{minipage}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Supplemental Material for ``Multiple colonizations of freshwater by the
Gulf pipefish reveal a shared genomic signature of adaptation''}
\author{
Sarah P. Flanagan
Emily Rose
Adam Jones
}
\date{}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

\usepackage{lipsum} \usepackage{float} \floatplacement{figure}{H}

\begin{document}
%%Edited by @jhollist 09/15/2014
%%Adds title from YAML
\begin{singlespace}
\begin{center}
\huge Supplemental Material for ``Multiple colonizations of freshwater by the
Gulf pipefish reveal a shared genomic signature of adaptation''
\end{center}
%%Adds Author, correspond email asterisk, and affilnum from YAML
\begin{center}
\large
Sarah P. Flanagan \textsuperscript{*} \textsuperscript{1} 
Emily Rose \textsuperscript{2} 
Adam Jones \textsuperscript{3} 
\end{center}
%%Adds affiliations from YAML
\begin{justify}
\footnotesize \emph{ 
\\*
\textsuperscript{1}School of Biological Sciences, University of Canterbury, 4800 Private
Bag, Christchurch 8140 New Zealand\\*
\\*
\textsuperscript{2}Department of Biology, The University of Tampa, Tampa, FL 33606 USA\\*
\\*
\textsuperscript{3}Department of Biological Sciences, University of Idaho, Moscow, ID 83844
USA\\*
}
%%Adds corresponding author email(s) from YAML
\newcounter{num}
\setcounter{num}{1}
\\[0.1cm]
\footnotesize \emph{ 
\ifnum\value{num}=1%
\textsuperscript{*} corresponding author:
\fi
\href{mailto:spflanagan.phd@gmail.com}{\nolinkurl{spflanagan.phd@gmail.com}}
\stepcounter{num}
}
\end{justify}
%%Adds date from YAML
\normalsize

\begin{abstract}
This document includes supplementary material for the paper. In this
document, we walk through the generation of each of the figures in the
manuscript, including all of the additional analyses that were used to
decide on the final presentation of results. This document shows the
population structure analyses (Fsts, PCAdapt, Admixture, and Treemix),
which were used to generate Figure 1. The second major section of this
document deals with the identification of outliers and the
interpretation of outliers from multiple analyses. These analyses
combined to create Figure 2 and Figure 3.
\end{abstract}
\end{singlespace}

{
\hypersetup{linkcolor=black}
\setcounter{tocdepth}{2}
\tableofcontents
}

\section*{Overview of the study}\label{overview-of-the-study}
\addcontentsline{toc}{section}{Overview of the study}

The initial analyses are in \texttt{200\_fwsw\_analysis.Rmd} and
conducted the analyses on a dataset generated from comparing lumped
`freshwater' and `saltwater' populations, containing SNPs found in 50\%
of individuals and with a minor allele frequency of at least 5\%. The
revised paper will instead focus on two datasets:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  A dataset with all 16 populations, generated from all pairwise
  comparisons of populations, containing SNPs found in every population,
  in 75\% of individuals, and with a minor allele frequency of at least
  5\%.
\item
  A dataset containing only the 4 freshwater populations (TXFW, LAFW,
  ALFW, FLFW) and their nearest saltwater populations (TXCC, ALST, FLCC
  -- note ALST is the nearest neighbor to both ALFW and LAFW). This
  dataset also contains SNPs found in 75\% of individuals with a minor
  allele frequency of at least 5\%.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/gwscaR.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/gwscaR_plot.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/gwscaR_utility.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/gwscaR_fsts.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/gwscaR_popgen.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../../gwscaR/R/vcf2dadi.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/203_treemix_plotting_funcs.R"}\NormalTok{)}\CommentTok{#I've modified these functions}
\KeywordTok{library}\NormalTok{(knitr)}
\KeywordTok{library}\NormalTok{(scales)}
\KeywordTok{library}\NormalTok{(kableExtra)}
\KeywordTok{library}\NormalTok{(vegan)}
\KeywordTok{library}\NormalTok{(RColorBrewer)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop.list<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
    \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)}
\NormalTok{pop.labs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
            \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLFW"}\NormalTok{)}
\NormalTok{fw.list<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)}
\NormalTok{sw.list<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
    \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{)}
\NormalTok{lgs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"LG1"}\NormalTok{,}\StringTok{"LG2"}\NormalTok{,}\StringTok{"LG3"}\NormalTok{,}\StringTok{"LG4"}\NormalTok{,}\StringTok{"LG5"}\NormalTok{,}\StringTok{"LG6"}\NormalTok{,}\StringTok{"LG7"}\NormalTok{,}\StringTok{"LG8"}\NormalTok{,}\StringTok{"LG9"}\NormalTok{,}\StringTok{"LG10"}\NormalTok{,}\StringTok{"LG11"}\NormalTok{,}
    \StringTok{"LG12"}\NormalTok{,}\StringTok{"LG13"}\NormalTok{,}\StringTok{"LG14"}\NormalTok{,}\StringTok{"LG15"}\NormalTok{,}\StringTok{"LG16"}\NormalTok{,}\StringTok{"LG17"}\NormalTok{,}\StringTok{"LG18"}\NormalTok{,}\StringTok{"LG19"}\NormalTok{,}\StringTok{"LG20"}\NormalTok{,}\StringTok{"LG21"}\NormalTok{,}
    \StringTok{"LG22"}\NormalTok{)}
\NormalTok{lgn<-}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{22}\NormalTok{)}
\NormalTok{all.colors<-}\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\DecValTok{2}\NormalTok{),}\StringTok{"#2166ac"}\NormalTok{,}\StringTok{"black"}\NormalTok{,}\StringTok{"#2166ac"}\NormalTok{,}\StringTok{"black"}\NormalTok{,}\StringTok{"#2166ac"}\NormalTok{,}
        \KeywordTok{rep}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\DecValTok{8}\NormalTok{),}\StringTok{"#2166ac"}\NormalTok{)}
\CommentTok{#grp.colors<-c('#e41a1c','#377eb8','#4daf4a','#984ea3','#ffff33','#f781bf')}
\NormalTok{grp.colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#af8dc3'}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#d9f0d3'}\NormalTok{,}\StringTok{'#7fbf7b'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{)}
\NormalTok{col_vector<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{red=}\StringTok{'#e6194b'}\NormalTok{, }\DataTypeTok{green=}\StringTok{'#3cb44b'}\NormalTok{, }\DataTypeTok{blue=}\StringTok{'#4363d8'}\NormalTok{,}\DataTypeTok{yellow=}\StringTok{'#ffe119'}\NormalTok{, }
              \DataTypeTok{cyan=}\StringTok{'#46f0f0'}\NormalTok{,}\DataTypeTok{orange=}\StringTok{'#f58231'}\NormalTok{, }\DataTypeTok{teal=}\StringTok{'#008080'}\NormalTok{, }\DataTypeTok{purple=}\StringTok{'#911eb4'}\NormalTok{,  }
              \DataTypeTok{magenta=}\StringTok{'#f032e6'}\NormalTok{, }\DataTypeTok{lime=}\StringTok{'#bcf60c'}\NormalTok{, }\DataTypeTok{pink=}\StringTok{'#fabebe'}\NormalTok{,  }\DataTypeTok{lavendar=}\StringTok{'#e6beff'}\NormalTok{, }
              \DataTypeTok{brown=}\StringTok{'#9a6324'}\NormalTok{, }\DataTypeTok{olive=}\StringTok{'#808000'}\NormalTok{, }\DataTypeTok{apricot=}\StringTok{'#ffd8b1'}\NormalTok{,}\DataTypeTok{maroon=}\StringTok{'#800000'}\NormalTok{, }
              \DataTypeTok{mint=}\StringTok{'#aaffc3'}\NormalTok{, }\DataTypeTok{navy=}\StringTok{'#000075'}\NormalTok{, }\DataTypeTok{beige=}\StringTok{'#fffac8'}\NormalTok{, }\DataTypeTok{grey=}\StringTok{'#808080'}\NormalTok{, }
              \DataTypeTok{white=}\StringTok{'#ffffff'}\NormalTok{, }\DataTypeTok{black=}\StringTok{'#000000'}\NormalTok{)}

\NormalTok{col_vector<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#762a83'}\NormalTok{,}\StringTok{"#2166ac"}\NormalTok{,}\StringTok{'#762a83'}\NormalTok{,}\StringTok{"#2166ac"}\NormalTok{,}\StringTok{'#af8dc3'}\NormalTok{,}
              \StringTok{"#2166ac"}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#7fbf7b'}\NormalTok{,}
              \StringTok{'#1b7837'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{,}\StringTok{"#2166ac"}\NormalTok{)}

\NormalTok{ppi<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Pop=}\NormalTok{pop.labs,}\DataTypeTok{cols =}\NormalTok{ col_vector,}
                \DataTypeTok{pch=}\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{,}\DecValTok{16}\NormalTok{,}\DecValTok{17}\NormalTok{,}\DecValTok{18}\NormalTok{),}\DecValTok{4}\NormalTok{))}
\NormalTok{ppi}\OperatorTok{$}\NormalTok{pch[}\KeywordTok{grep}\NormalTok{(}\StringTok{"FW"}\NormalTok{,ppi}\OperatorTok{$}\NormalTok{Pop)]<-}\KeywordTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{,}\DecValTok{16}\NormalTok{,}\DecValTok{17}\NormalTok{,}\DecValTok{18}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Map of the populations}\label{map-of-the-populations}

First, we'll plot these populations on a map

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(maps);}\KeywordTok{library}\NormalTok{(gplots);}\KeywordTok{library}\NormalTok{(mapdata)}
\NormalTok{mar.coor<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"marine_coordinates_revised.csv"}\NormalTok{, }\DataTypeTok{header=}\NormalTok{T)}
\NormalTok{fw.coor<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"fw_coordinates.csv"}\NormalTok{, }\DataTypeTok{header=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{jpeg}\NormalTok{(}\StringTok{"all_sites_map.jpeg"}\NormalTok{, }\DataTypeTok{res=}\DecValTok{300}\NormalTok{, }\DataTypeTok{height=}\DecValTok{7}\NormalTok{,}\DataTypeTok{width=}\DecValTok{14}\NormalTok{, }\DataTypeTok{units=}\StringTok{"in"}\NormalTok{)}
\CommentTok{#pdf("all_sites_map.pdf",height=7,width=14)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DataTypeTok{pin=}\KeywordTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{,}\DecValTok{7}\NormalTok{))}
\KeywordTok{map}\NormalTok{(}\StringTok{"worldHires"}\NormalTok{, }\StringTok{"usa"}\NormalTok{,}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{100}\NormalTok{,}\OperatorTok{-}\DecValTok{76}\NormalTok{), }\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{,}\DecValTok{32}\NormalTok{), }
    \DataTypeTok{col=}\StringTok{"gray90"}\NormalTok{, }\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DataTypeTok{fill=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{myborder=}\DecValTok{0}\NormalTok{)}
\KeywordTok{map}\NormalTok{(}\StringTok{"worldHires"}\NormalTok{, }\StringTok{"mexico"}\NormalTok{,}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{100}\NormalTok{,}\OperatorTok{-}\DecValTok{76}\NormalTok{), }\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{,}\DecValTok{32}\NormalTok{), }
    \DataTypeTok{col=}\StringTok{"gray95"}\NormalTok{, }\DataTypeTok{fill=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{points}\NormalTok{(mar.coor}\OperatorTok{$}\NormalTok{lon, mar.coor}\OperatorTok{$}\NormalTok{lat,  }\DataTypeTok{col=}\StringTok{"black"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\KeywordTok{points}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\OperatorTok{*}\NormalTok{fw.coor}\OperatorTok{$}\NormalTok{lon, fw.coor}\OperatorTok{$}\NormalTok{lat,  }\DataTypeTok{col=}\StringTok{"cornflowerblue"}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{2}\NormalTok{, }\DataTypeTok{pch=}\DecValTok{18}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\KeywordTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{35}\NormalTok{),}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{80}\NormalTok{,}\OperatorTok{-}\DecValTok{85}\NormalTok{,}\OperatorTok{-}\DecValTok{90}\NormalTok{,}\OperatorTok{-}\DecValTok{95}\NormalTok{),}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{99.5}\NormalTok{,}\OperatorTok{-}\FloatTok{99.5}\NormalTok{),}\DataTypeTok{y=}\KeywordTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{,}\DecValTok{30}\NormalTok{),}\KeywordTok{c}\NormalTok{(}\StringTok{"25N"}\NormalTok{,}\StringTok{"30N"}\NormalTok{),}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{80}\NormalTok{,}\OperatorTok{-}\DecValTok{85}\NormalTok{,}\OperatorTok{-}\DecValTok{90}\NormalTok{,}\OperatorTok{-}\DecValTok{95}\NormalTok{),}\DataTypeTok{y=}\KeywordTok{rep}\NormalTok{(}\FloatTok{31.8}\NormalTok{,}\DecValTok{4}\NormalTok{),}\KeywordTok{c}\NormalTok{(}\StringTok{"80W"}\NormalTok{,}\StringTok{"85W"}\NormalTok{,}\StringTok{"90W"}\NormalTok{,}\StringTok{"95W"}\NormalTok{),}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{y=}\DecValTok{26}\NormalTok{,}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{90}\NormalTok{,}\StringTok{"Gulf of Mexico"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{y=}\FloatTok{25.5}\NormalTok{,}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{98.5}\NormalTok{,}\StringTok{"Mexico"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{91}\NormalTok{,}\DataTypeTok{y=}\DecValTok{31}\NormalTok{,}\StringTok{"USA"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{78}\NormalTok{,}\DataTypeTok{y=}\FloatTok{29.5}\NormalTok{,}\StringTok{"Atlantic Ocean"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{96.4}\NormalTok{,}\DataTypeTok{y=}\DecValTok{26}\NormalTok{,}\StringTok{"TXSP"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{96.6}\NormalTok{,}\DataTypeTok{y=}\FloatTok{27.2}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{95.6}\NormalTok{,}\DataTypeTok{y=}\FloatTok{28.3}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{col=}\StringTok{"cornflowerblue"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{94.4}\NormalTok{,}\DataTypeTok{y=}\DecValTok{29}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{90.5}\NormalTok{,}\DataTypeTok{y=}\FloatTok{29.8}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{col=}\StringTok{"cornflowerblue"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{88}\NormalTok{,}\DataTypeTok{y=}\DecValTok{30}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{87}\NormalTok{,}\DataTypeTok{y=}\FloatTok{30.75}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{col=}\StringTok{"cornflowerblue"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\DecValTok{85}\NormalTok{,}\DataTypeTok{y=}\FloatTok{29.4}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{83.7}\NormalTok{,}\DataTypeTok{y=}\DecValTok{29}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{83.4}\NormalTok{,}\DataTypeTok{y=}\FloatTok{27.6}\NormalTok{,}\StringTok{"FLFD"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{82.4}\NormalTok{,}\DataTypeTok{y=}\DecValTok{26}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{79.9}\NormalTok{,}\DataTypeTok{y=}\FloatTok{24.8}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{79.2}\NormalTok{,}\DataTypeTok{y=}\FloatTok{26.8}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{79.4}\NormalTok{,}\DataTypeTok{y=}\FloatTok{27.2}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{79.9}\NormalTok{,}\DataTypeTok{y=}\FloatTok{28.5}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\OperatorTok{-}\FloatTok{80.9}\NormalTok{,}\DataTypeTok{y=}\FloatTok{29.5}\NormalTok{,}\StringTok{"FLFW"}\NormalTok{,}\DataTypeTok{font=}\DecValTok{2}\NormalTok{,}\DataTypeTok{col=}\StringTok{"cornflowerblue"}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\subsection{Phenotypic variation}\label{phenotypic-variation}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{raw.pheno<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"../sw_results/popgen.pheno.txt"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{, }\DataTypeTok{header=}\NormalTok{T)}
\NormalTok{    raw.pheno}\OperatorTok{$}\NormalTok{PopID<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\})}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w+"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,raw.pheno}\OperatorTok{$}\NormalTok{ID)}
\NormalTok{    raw.pheno<-raw.pheno[raw.pheno}\OperatorTok{$}\NormalTok{PopID }\OperatorTok{%in%}\StringTok{ }\NormalTok{pop.list,]}
\NormalTok{    raw.pheno}\OperatorTok{$}\NormalTok{sex<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\}(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w)}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w+"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,raw.pheno}\OperatorTok{$}\NormalTok{ID)}
\NormalTok{    raw.pheno}\OperatorTok{$}\NormalTok{TailLength<-raw.pheno}\OperatorTok{$}\NormalTok{std.length}\OperatorTok{-}\NormalTok{raw.pheno}\OperatorTok{$}\NormalTok{SVL}
\NormalTok{    raw.pheno}\OperatorTok{$}\NormalTok{HeadLength<-raw.pheno}\OperatorTok{$}\NormalTok{HeadLength}\OperatorTok{-}\NormalTok{raw.pheno}\OperatorTok{$}\NormalTok{SnoutLength}

\NormalTok{fem.pheno<-raw.pheno[raw.pheno}\OperatorTok{$}\NormalTok{sex }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"F"}\NormalTok{,}\StringTok{"D"}\NormalTok{),}\OperatorTok{-}\DecValTok{8}\NormalTok{]}
\NormalTok{    fem.pheno<-fem.pheno[,}\KeywordTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{)]}
\NormalTok{    fem.pheno<-fem.pheno[}\KeywordTok{order}\NormalTok{(}\KeywordTok{match}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{PopID,pop.list)),]}
    \KeywordTok{write.table}\NormalTok{(fem.pheno,}\StringTok{"fem.pheno.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{row.names=}\NormalTok{F,}\DataTypeTok{col.names=}\NormalTok{T,}
        \DataTypeTok{quote=}\NormalTok{F)}
    
\NormalTok{mal.pheno<-raw.pheno[raw.pheno}\OperatorTok{$}\NormalTok{sex }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"P"}\NormalTok{,}\StringTok{"N"}\NormalTok{),}\OperatorTok{-}\DecValTok{8}\NormalTok{]}
\NormalTok{    mal.pheno<-mal.pheno[,}\KeywordTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{)]}
\NormalTok{    mal.pheno<-mal.pheno[}\KeywordTok{order}\NormalTok{(}\KeywordTok{match}\NormalTok{(mal.pheno}\OperatorTok{$}\NormalTok{PopID,pop.list)),]}
    \KeywordTok{write.table}\NormalTok{(mal.pheno,}\StringTok{"mal.pheno.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{row.names=}\NormalTok{F,}\DataTypeTok{col.names=}\NormalTok{T,}
        \DataTypeTok{quote=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fem.pheno<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"fem.pheno.txt"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T)}
\NormalTok{    fem.pheno<-fem.pheno[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{BandNum),]}
\NormalTok{mal.pheno<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"mal.pheno.txt"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fem.pheno}\OperatorTok{$}\NormalTok{PopID<-}\KeywordTok{factor}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{PopID)}
\NormalTok{fem.pheno<-fem.pheno[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{BandNum),]}
\NormalTok{mal.pheno}\OperatorTok{$}\NormalTok{PopID<-}\KeywordTok{factor}\NormalTok{(mal.pheno}\OperatorTok{$}\NormalTok{PopID)}
\NormalTok{bands.pcdat<-fem.pheno[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{BandNum),}
    \KeywordTok{c}\NormalTok{(}\StringTok{"PopID"}\NormalTok{,}\StringTok{"ID"}\NormalTok{,}\StringTok{"MBandArea"}\NormalTok{,}\StringTok{"BandNum"}\NormalTok{)]}
\CommentTok{# run pcas}
\NormalTok{band.pca<-}\KeywordTok{rda}\NormalTok{(bands.pcdat[,}\DecValTok{3}\OperatorTok{:}\DecValTok{4}\NormalTok{])}
\NormalTok{fem.pheno.pca<-}\KeywordTok{rda}\NormalTok{(fem.pheno[,}\DecValTok{4}\OperatorTok{:}\DecValTok{9}\NormalTok{])}
\NormalTok{mal.pheno.pca<-}\KeywordTok{rda}\NormalTok{(mal.pheno[,}\DecValTok{4}\OperatorTok{:}\DecValTok{9}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{####extract eigenvalue}
\NormalTok{band.eig<-band.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{eig}
\NormalTok{band.pc<-band.eig}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(band.eig)}\OperatorTok{*}\DecValTok{100}

\CommentTok{#extract PC scores}
\NormalTok{band.u<-}\KeywordTok{data.frame}\NormalTok{(bands.pcdat[,}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{],}
                   \StringTok{"BandPC1"}\NormalTok{=band.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{u[,}\DecValTok{1}\NormalTok{],}\DataTypeTok{stringsAsFactors=}\NormalTok{F)}
\NormalTok{band.u.sep<-}\KeywordTok{split}\NormalTok{(band.u, band.u[,}\DecValTok{1}\NormalTok{])}
\NormalTok{band.u.new<-}\KeywordTok{rbind}\NormalTok{(band.u.sep}\OperatorTok{$}\NormalTok{TXSP,band.u.sep}\OperatorTok{$}\NormalTok{TXCC,band.u.sep}\OperatorTok{$}\NormalTok{TXCB,}
\NormalTok{    band.u.sep}\OperatorTok{$}\NormalTok{ALST,band.u.sep}\OperatorTok{$}\NormalTok{FLSG,band.u.sep}\OperatorTok{$}\NormalTok{FLKB,}
\NormalTok{    band.u.sep}\OperatorTok{$}\NormalTok{FLFD,band.u.sep}\OperatorTok{$}\NormalTok{FLSI,band.u.sep}\OperatorTok{$}\NormalTok{FLAB,}
\NormalTok{    band.u.sep}\OperatorTok{$}\NormalTok{FLPB,band.u.sep}\OperatorTok{$}\NormalTok{FLHB,band.u.sep}\OperatorTok{$}\NormalTok{FLCC)}

\NormalTok{fem.pheno.eig<-fem.pheno.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{eig}
\NormalTok{fem.pheno.pc<-fem.pheno.eig}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(fem.pheno.eig)}\OperatorTok{*}\DecValTok{100}

\CommentTok{#extract PC scores}
\NormalTok{fem.pheno.u<-}\KeywordTok{data.frame}\NormalTok{(fem.pheno[,}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{],}
    \StringTok{"FemBodyPC1"}\NormalTok{=fem.pheno.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{u[,}\DecValTok{1}\NormalTok{],}\DataTypeTok{stringsAsFactors=}\NormalTok{F)}
\NormalTok{fem.u.sep<-}\KeywordTok{split}\NormalTok{(fem.pheno.u, fem.pheno.u[,}\DecValTok{1}\NormalTok{])}
\NormalTok{fem.u.new<-}\KeywordTok{rbind}\NormalTok{(fem.u.sep}\OperatorTok{$}\NormalTok{TXSP,fem.u.sep}\OperatorTok{$}\NormalTok{TXCC,fem.u.sep}\OperatorTok{$}\NormalTok{TXCB,}
\NormalTok{    fem.u.sep}\OperatorTok{$}\NormalTok{ALST,fem.u.sep}\OperatorTok{$}\NormalTok{FLSG,fem.u.sep}\OperatorTok{$}\NormalTok{FLKB,}
\NormalTok{    fem.u.sep}\OperatorTok{$}\NormalTok{FLFD,fem.u.sep}\OperatorTok{$}\NormalTok{FLSI,fem.u.sep}\OperatorTok{$}\NormalTok{FLAB,}
\NormalTok{    fem.u.sep}\OperatorTok{$}\NormalTok{FLPB,fem.u.sep}\OperatorTok{$}\NormalTok{FLHB,fem.u.sep}\OperatorTok{$}\NormalTok{FLCC)}

\NormalTok{mal.pheno.eig<-mal.pheno.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{eig}
\NormalTok{mal.pheno.pc<-mal.pheno.eig}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(mal.pheno.eig)}\OperatorTok{*}\DecValTok{100}

\CommentTok{#extract PC scores}
\NormalTok{mal.u<-}\KeywordTok{data.frame}\NormalTok{(mal.pheno[,}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{],}\StringTok{"MalBodyPC1"}\NormalTok{=mal.pheno.pca}\OperatorTok{$}\NormalTok{CA}\OperatorTok{$}\NormalTok{u[,}\DecValTok{1}\NormalTok{],}
    \DataTypeTok{stringsAsFactors=}\NormalTok{F)}
\NormalTok{mal.u.sep<-}\KeywordTok{split}\NormalTok{(mal.u, mal.u[,}\DecValTok{1}\NormalTok{])}
\NormalTok{mal.u.new<-}\KeywordTok{rbind}\NormalTok{(mal.u.sep}\OperatorTok{$}\NormalTok{TXSP,mal.u.sep}\OperatorTok{$}\NormalTok{TXCC,mal.u.sep}\OperatorTok{$}\NormalTok{TXCB,}
\NormalTok{    mal.u.sep}\OperatorTok{$}\NormalTok{ALST,mal.u.sep}\OperatorTok{$}\NormalTok{FLSG,mal.u.sep}\OperatorTok{$}\NormalTok{FLKB,}
\NormalTok{    mal.u.sep}\OperatorTok{$}\NormalTok{FLFD,mal.u.sep}\OperatorTok{$}\NormalTok{FLSI,mal.u.sep}\OperatorTok{$}\NormalTok{FLAB,}
\NormalTok{    mal.u.sep}\OperatorTok{$}\NormalTok{FLPB,mal.u.sep}\OperatorTok{$}\NormalTok{FLHB,mal.u.sep}\OperatorTok{$}\NormalTok{FLCC)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# females}
\NormalTok{fem.pop<-}\KeywordTok{as.character}\NormalTok{(bands.pcdat}\OperatorTok{$}\NormalTok{PopID)}
\NormalTok{fem.pop[fem.pop}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"FLFW"}
\NormalTok{fem.colors<-}\KeywordTok{as.character}\NormalTok{(fem.pop)}
\NormalTok{fem.pch<-}\KeywordTok{as.character}\NormalTok{(fem.pop)}
\NormalTok{fw.fem.col<-}\KeywordTok{as.character}\NormalTok{(fem.pop[fem.pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{fw.list])}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(fem.pop))\{}
\NormalTok{  fem.colors[i]<-}\KeywordTok{as.character}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{fem.pop[i],}\StringTok{"cols"}\NormalTok{])}
\NormalTok{  fem.pch[i]<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{fem.pop[i],}\StringTok{"pch"}\NormalTok{]))}
\NormalTok{\}}
\NormalTok{fem.pch<-}\KeywordTok{as.numeric}\NormalTok{(fem.pch)}

\CommentTok{# males}
\NormalTok{mal.pop<-}\KeywordTok{as.character}\NormalTok{(mal.pheno}\OperatorTok{$}\NormalTok{PopID)}
\NormalTok{mal.pop[mal.pop}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"FLFW"}
\NormalTok{mal.colors<-}\KeywordTok{as.character}\NormalTok{(mal.pop)}
\NormalTok{mal.pch<-}\KeywordTok{as.character}\NormalTok{(mal.pop)}
\NormalTok{fw.mal.col<-}\KeywordTok{as.character}\NormalTok{(mal.pop[mal.pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{fw.list])}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(mal.pop))\{}
\NormalTok{  mal.colors[i]<-}\KeywordTok{as.character}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{mal.pop[i],}\StringTok{"cols"}\NormalTok{])}
\NormalTok{  mal.pch[i]<-}\KeywordTok{as.character}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{mal.pop[i],}\StringTok{"pch"}\NormalTok{])}
\NormalTok{\}}
\NormalTok{mal.pch<-}\KeywordTok{as.numeric}\NormalTok{(mal.pch)}


\NormalTok{fw.fem.rows<-}\KeywordTok{which}\NormalTok{(fem.pheno}\OperatorTok{$}\NormalTok{PopID }\OperatorTok{%in%}\StringTok{ }\NormalTok{fw.list)}
\NormalTok{fw.mal.rows<-}\KeywordTok{which}\NormalTok{(mal.pheno}\OperatorTok{$}\NormalTok{PopID }\OperatorTok{%in%}\StringTok{ }\NormalTok{fw.list)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ptCex<-}\DecValTok{2}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{lwd=}\FloatTok{1.3}\NormalTok{)}
\NormalTok{mp<-}\KeywordTok{plot}\NormalTok{(mal.pheno.pca,}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{),}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{8.2}\NormalTok{,}\DecValTok{4}\NormalTok{)}
\NormalTok{    ,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{points}\NormalTok{(mal.pheno.pca,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(mal.colors,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{cex=}\NormalTok{ptCex,}\DataTypeTok{pch=}\NormalTok{mal.pch)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(mal.pheno.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(mal.pheno.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"Male Body Traits"}\NormalTok{),}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}

\NormalTok{fp<-}\KeywordTok{plot}\NormalTok{(fem.pheno.pca,}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{4}\NormalTok{,}\DecValTok{12}\NormalTok{),}
    \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\KeywordTok{points}\NormalTok{(fem.pheno.pca,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(fem.colors,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{cex=}\NormalTok{ptCex,}\DataTypeTok{pch=}\NormalTok{fem.pch)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(fem.pheno.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(fem.pheno.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"Female Body Traits"}\NormalTok{),}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}

\NormalTok{bp<-}\KeywordTok{plot}\NormalTok{(band.pca,}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}
         \DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{points}\NormalTok{(band.pca,}\DataTypeTok{pch=}\NormalTok{fem.pch,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(fem.colors,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{cex=}\NormalTok{ptCex)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(band.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(band.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\StringTok{"Female Band Traits"}\NormalTok{),}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}


\KeywordTok{plot}\NormalTok{(mp}\OperatorTok{$}\NormalTok{sites[fw.mal.rows,],}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(mp}\OperatorTok{$}\NormalTok{sites[fw.mal.rows,],}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.1}\NormalTok{),}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\NormalTok{.}\DecValTok{2}\NormalTok{,.}\DecValTok{2}\NormalTok{),}
    \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(mal.colors[fw.mal.rows],}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{cex=}\NormalTok{ptCex,}\DataTypeTok{pch=}\NormalTok{mal.pch[fw.mal.rows])}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(mal.pheno.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(mal.pheno.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}


\KeywordTok{plot}\NormalTok{(fp}\OperatorTok{$}\NormalTok{sites[fw.fem.rows,],}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}
    \DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{4}\NormalTok{,}\DecValTok{12}\NormalTok{),}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(fp}\OperatorTok{$}\NormalTok{sites[fw.fem.rows,],}
    \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(fem.colors[fw.fem.rows],}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{cex=}\NormalTok{ptCex,}
    \DataTypeTok{pch=}\NormalTok{fem.pch[fw.fem.rows])}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(fem.pheno.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(fem.pheno.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}


\KeywordTok{plot}\NormalTok{(bp}\OperatorTok{$}\NormalTok{sites[fw.fem.rows,],}\DataTypeTok{type=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}
    \DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{points}\NormalTok{(bp}\OperatorTok{$}\NormalTok{sites[fw.fem.rows,],}
    \DataTypeTok{pch=}\NormalTok{fem.pch[fw.fem.rows],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(fem.colors[fw.fem.rows],}\FloatTok{0.5}\NormalTok{),}
    \DataTypeTok{cex=}\NormalTok{ptCex)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(band.pc[}\DecValTok{1}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(band.pc[}\DecValTok{2}\NormalTok{],}\DecValTok{2}\NormalTok{),}\StringTok{"%)"}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{2.5}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{v=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{3}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }
    \DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{bty =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{xaxt =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{yaxt =} \StringTok{"n"}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{, }\DataTypeTok{legend=}\NormalTok{ppi}\OperatorTok{$}\NormalTok{Pop, }
    \DataTypeTok{col=}\KeywordTok{as.character}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{col),}
    \DataTypeTok{pt.cex=}\NormalTok{ptCex,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\DataTypeTok{pch=}\NormalTok{ppi}\OperatorTok{$}\NormalTok{pch, }\DataTypeTok{ncol=}\DecValTok{8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{../figs/plotPCA-1} \caption{Principal components analysis of morphological traits in S. scovelli reveals that phenotypic variation among populations is not based on habitat type. The top set of panels show the results of the PCA with all 16 populations, color-coded by populations and point shape. The bottom set of panels show the same PCA results, but with different x- and y-axis scaling and without the saltwater populations plotted, to facilitate visualizing the differences among saltwater populations. The left panels show male body traits (SVL, tail length, trunk depth, head length, snout length, and snout depth), the middle panels show those same traits in females, and the right panels show the female band traits (band number and band area).}\label{fig:plotPCA}
\end{figure}

\subsection{Table of summary
statistics}\label{table-of-summary-statistics}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop_map<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"../fwsw_pops_map.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{ful_vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}
  \StringTok{"filter_rad_20191014@1654/14_filtered/radiator_data_20191014@1710.vcf"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(ful_vcf)<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{-"}\NormalTok{,}\StringTok{"_"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(ful_vcf))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sub_vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.pruned.vcf"}\NormalTok{)}
\NormalTok{sub_all_vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"stacks/populations_subset75/all_pops_subset75/batch_2.vcf"}\NormalTok{)}
\CommentTok{# combine the two}
\NormalTok{sub<-}\KeywordTok{merge}\NormalTok{(sub_vcf,sub_all_vcf,}\DataTypeTok{by=}\StringTok{"ID"}\NormalTok{,}\DataTypeTok{all =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{rmv<-}\KeywordTok{grep}\NormalTok{(}\StringTok{".y"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(sub))}
\NormalTok{sub<-sub[,}\OperatorTok{-}\NormalTok{rmv]}
\KeywordTok{colnames}\NormalTok{(sub)<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{".x"}\NormalTok{,}\StringTok{""}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(sub))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop_summaries<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(pop.list,}\ControlFlowTok{function}\NormalTok{(pop,ful,sub)\{}
\NormalTok{  ful_dat<-ful[,}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{,}\KeywordTok{grep}\NormalTok{(pop,}\KeywordTok{colnames}\NormalTok{(ful)))]}
\NormalTok{  sub_dat<-sub[,}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{,}\KeywordTok{grep}\NormalTok{(pop,}\KeywordTok{colnames}\NormalTok{(sub)))]}
  \CommentTok{# calc observed het values}
\NormalTok{  ful_ho<-}\KeywordTok{apply}\NormalTok{(ful_dat,}\DecValTok{1}\NormalTok{,calc.het)}
\NormalTok{  sub_ho<-}\KeywordTok{apply}\NormalTok{(sub_dat,}\DecValTok{1}\NormalTok{,calc.het)}
  \CommentTok{# estimate allele freqs}
\NormalTok{  ful_afs<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(ful_dat,}\DecValTok{1}\NormalTok{,calc.afs.vcf))}
\NormalTok{  sub_afs<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(sub_dat,}\DecValTok{1}\NormalTok{,calc.afs.vcf))}
  \CommentTok{# save data frame}
\NormalTok{  dat<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{pop=}\NormalTok{pop,}
                  \DataTypeTok{preg_full=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"P"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(ful))),}
                  \DataTypeTok{preg_sub=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"P"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(sub))),}
                  \DataTypeTok{nonp_full=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"NP"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(ful))),}
                  \DataTypeTok{nonp_sub=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"NP"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(sub))),}
                  \DataTypeTok{nfem_full=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"F"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(ful))),}
                  \DataTypeTok{nfem_sub=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"F"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(sub))),}
                  \DataTypeTok{njuv_full=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"J"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(ful)))}\OperatorTok{+}
\StringTok{                    }\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"DB"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(ful))),}
                  \DataTypeTok{njuv_sub=}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"J"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(sub))) }\OperatorTok{+}\StringTok{ }
\StringTok{                    }\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(pop,}\StringTok{"DB"}\NormalTok{),}\KeywordTok{colnames}\NormalTok{(sub))),}
                  \DataTypeTok{ho_full =} \KeywordTok{mean}\NormalTok{(ful_ho,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{hov_full =} \KeywordTok{var}\NormalTok{(ful_ho,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{ho_sub =} \KeywordTok{mean}\NormalTok{(sub_ho,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{hov_sub =} \KeywordTok{var}\NormalTok{(sub_ho,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{poly_ful =} \KeywordTok{nrow}\NormalTok{(ful_afs[ful_afs}\OperatorTok{$}\NormalTok{RefFreq}\OperatorTok{<}\DecValTok{1}\NormalTok{,])}\OperatorTok{/}\KeywordTok{nrow}\NormalTok{(ful_afs)}\OperatorTok{*}\DecValTok{100}\NormalTok{,}
                  \DataTypeTok{poly_sub =} \KeywordTok{nrow}\NormalTok{(sub_afs[sub_afs}\OperatorTok{$}\NormalTok{RefFreq}\OperatorTok{<}\DecValTok{1}\NormalTok{,])}\OperatorTok{/}\KeywordTok{nrow}\NormalTok{(sub_afs)}\OperatorTok{*}\DecValTok{100}\NormalTok{,}
                  \DataTypeTok{p_full =} \KeywordTok{mean}\NormalTok{(ful_afs}\OperatorTok{$}\NormalTok{RefFreq,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{pv_full =} \KeywordTok{var}\NormalTok{(ful_afs}\OperatorTok{$}\NormalTok{RefFreq,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{p_sub =} \KeywordTok{mean}\NormalTok{(sub_afs}\OperatorTok{$}\NormalTok{RefFreq,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{),}
                  \DataTypeTok{pv_sub =} \KeywordTok{var}\NormalTok{(sub_afs}\OperatorTok{$}\NormalTok{RefFreq,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{))}
  \KeywordTok{return}\NormalTok{(dat)}
\NormalTok{\},}\DataTypeTok{ful=}\NormalTok{ful_vcf,}\DataTypeTok{sub=}\NormalTok{sub))}
\KeywordTok{write.csv}\NormalTok{(pop_summaries,}\StringTok{"population_summaries.csv"}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

We can merge the genetic info with the environmental info.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop_summaries<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"population_summaries.csv"}\NormalTok{)}
\NormalTok{env.data<-}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"bayenv/env_data_raw.csv"}\NormalTok{,}\DataTypeTok{row.names =} \DecValTok{1}\NormalTok{)))}
\NormalTok{env.data}\OperatorTok{$}\NormalTok{pop<-}\KeywordTok{rownames}\NormalTok{(env.data)}
\NormalTok{pop_summaries<-}\KeywordTok{merge}\NormalTok{(env.data,pop_summaries,}\DataTypeTok{by=}\StringTok{"pop"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pretty_sum<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Population =}\NormalTok{ pop_summaries}\OperatorTok{$}\NormalTok{pop,}
                       \DataTypeTok{Temperature =}\NormalTok{ pop_summaries}\OperatorTok{$}\NormalTok{temp,}
                       \DataTypeTok{Salinity =}\NormalTok{ pop_summaries}\OperatorTok{$}\NormalTok{salinity,}
                       \DataTypeTok{SeagrassDensity=}\NormalTok{pop_summaries}\OperatorTok{$}\NormalTok{seagrass,}
                       \DataTypeTok{N_Pregnant =} \KeywordTok{paste0}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{preg_full,}
                                           \StringTok{" ("}\NormalTok{,pop_summaries}\OperatorTok{$}\NormalTok{preg_sub,}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{N_NonPregnant =} \KeywordTok{paste0}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{nonp_full,}
                                              \StringTok{" ("}\NormalTok{,pop_summaries}\OperatorTok{$}\NormalTok{nonp_sub,}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{N_Female =} \KeywordTok{paste0}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{nfem_full,}
                                         \StringTok{" ("}\NormalTok{,pop_summaries}\OperatorTok{$}\NormalTok{nfem_sub,}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{N_Juvenile =} \KeywordTok{paste0}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{njuv_full,}
                                           \StringTok{" ("}\NormalTok{,pop_summaries}\OperatorTok{$}\NormalTok{njuv_sub,}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{H_o =} \KeywordTok{paste0}\NormalTok{(}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{ho_full,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                                    \StringTok{"\textbackslash{}u00B1"}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{hov_full,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                                   \StringTok{" ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{ho_sub,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                                   \StringTok{"\textbackslash{}u00B1"}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{hov_sub,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{MinorAlleleFrequency =} \KeywordTok{paste0}\NormalTok{(}
                         \KeywordTok{round}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{pop_summaries}\OperatorTok{$}\NormalTok{p_full,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                         \StringTok{"\textbackslash{}u00B1"}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{pv_full,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                         \StringTok{" ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{pop_summaries}\OperatorTok{$}\NormalTok{p_sub,}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{),}
                         \StringTok{"\textbackslash{}u00B1"}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{pv_sub,}\DataTypeTok{digits =} \DecValTok{3}\NormalTok{),}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{PercentPolymorphicLoci =} \KeywordTok{paste0}\NormalTok{(}
                         \KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{poly_ful,}\DataTypeTok{digits=}\DecValTok{1}\NormalTok{),}
                         \StringTok{" ("}\NormalTok{,}\KeywordTok{round}\NormalTok{(pop_summaries}\OperatorTok{$}\NormalTok{poly_sub,}\DataTypeTok{digits=}\DecValTok{1}\NormalTok{),}\StringTok{")"}\NormalTok{),}
                       \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{pretty_sum}\OperatorTok{$}\NormalTok{Population[pretty_sum}\OperatorTok{$}\NormalTok{Population}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"FLFW"}
\KeywordTok{write.table}\NormalTok{(pretty_sum,}\StringTok{"Table1_populationSummaries.txt"}\NormalTok{,}
            \DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Minor allele frequencies}\label{minor-allele-frequencies}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locus.info<-}\KeywordTok{colnames}\NormalTok{(ful_vcf[}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{])}
\NormalTok{fw.afs<-}\KeywordTok{lapply}\NormalTok{(fw.list,}\ControlFlowTok{function}\NormalTok{(pop,vcf)\{}
\NormalTok{  this.vcf<-}\KeywordTok{cbind}\NormalTok{(vcf[,locus.info],vcf[,}\KeywordTok{grep}\NormalTok{(pop,}\KeywordTok{colnames}\NormalTok{(vcf))])}
\NormalTok{  this.afs<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(this.vcf,}\DecValTok{1}\NormalTok{,calc.afs.vcf))}
\NormalTok{\}, }\DataTypeTok{vcf=}\NormalTok{ful_vcf)}
\KeywordTok{names}\NormalTok{(fw.afs)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLFW"}\NormalTok{)}
\NormalTok{sw.afs<-}\KeywordTok{lapply}\NormalTok{(sw.list,}\ControlFlowTok{function}\NormalTok{(pop,vcf)\{}
\NormalTok{  this.vcf<-}\KeywordTok{cbind}\NormalTok{(vcf[,locus.info],vcf[,}\KeywordTok{grep}\NormalTok{(pop,}\KeywordTok{colnames}\NormalTok{(vcf))])}
\NormalTok{  this.afs<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(this.vcf,}\DecValTok{1}\NormalTok{,calc.afs.vcf))}
\NormalTok{\},}\DataTypeTok{vcf=}\NormalTok{ful_vcf)}
\KeywordTok{names}\NormalTok{(sw.afs)<-sw.list}
\NormalTok{all.afs<-}\KeywordTok{c}\NormalTok{(fw.afs,sw.afs)}
\NormalTok{minAF<-}\KeywordTok{lapply}\NormalTok{(all.afs,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  mins<-}\KeywordTok{apply}\NormalTok{(x,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(row)\{ }\KeywordTok{return}\NormalTok{(}\KeywordTok{min}\NormalTok{(row[}\DecValTok{4}\NormalTok{],row[}\DecValTok{6}\NormalTok{])) \} )}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(mins))}
\NormalTok{\})}
\KeywordTok{names}\NormalTok{(minAF)<-}\KeywordTok{names}\NormalTok{(all.afs)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.5}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(pop.labs))\{}
  \ControlFlowTok{if}\NormalTok{(pop.labs[i] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{names}\NormalTok{(fw.afs))\{}
\NormalTok{    color<-}\StringTok{"cornflowerblue"}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{    color<-}\StringTok{"black"}
\NormalTok{  \}}
  \KeywordTok{hist}\NormalTok{(minAF[[pop.labs[i]]],}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{main=}\StringTok{""}\NormalTok{,}
       \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10000}\NormalTok{),}\DataTypeTok{axes=}\NormalTok{F,}\DataTypeTok{col=}\NormalTok{color,}
       \DataTypeTok{breaks=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.05}\NormalTok{))}
  \KeywordTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\DecValTok{0}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{(i }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{13}\NormalTok{))\{}
    \KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{pos=}\DecValTok{0}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{,}\DataTypeTok{labels =} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10000}\NormalTok{,}\DecValTok{2000}\NormalTok{))}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{}
    \KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{pos=}\DecValTok{0}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{labels =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{2}\NormalTok{)}
\NormalTok{    \}}
  \KeywordTok{mtext}\NormalTok{(pop.labs[i],}\DecValTok{3}\NormalTok{,}\DataTypeTok{col=}\NormalTok{color,}\DataTypeTok{cex=}\DecValTok{2}\OperatorTok{*}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{line=}\OperatorTok{-}\DecValTok{1}\NormalTok{)}
\NormalTok{\}}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Minor Allele Frequency"}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DataTypeTok{outer=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\OperatorTok{*}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Number of SNPs (x 1000)"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{outer =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.75}\OperatorTok{*}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{line=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{../figs/minorAFplot-1.png}
\caption{Minor allele frequency distributions of the full dataset (7433
SNPs) for each population. Freshwater populations are plotted in blue.
The histograms show the number of SNPs with various frequencies of the
reference alleles. All populations are skewed towards having small minor
allele frequencies, but the TXFW and FLFW have additional reductions in
genetic variation.}
\end{figure}

\section*{Population structure of all 16
populations}\label{population-structure-of-all-16-populations}
\addcontentsline{toc}{section}{Population structure of all 16
populations}

\subsection{FSTs}\label{fsts}

This will calculate the pairwise \(F_{ST}\)s (but it's slow)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop_map<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"../fwsw_pops_map.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{fst_mat<-}\KeywordTok{matrix}\NormalTok{(}\OtherTok{NA}\NormalTok{,}
                \DataTypeTok{nrow=}\KeywordTok{length}\NormalTok{(}\KeywordTok{unique}\NormalTok{(pop_map}\OperatorTok{$}\NormalTok{V2)),}\DataTypeTok{ncol=}\KeywordTok{length}\NormalTok{(}\KeywordTok{unique}\NormalTok{(pop_map}\OperatorTok{$}\NormalTok{V2)),}
                \DataTypeTok{dimnames =} \KeywordTok{list}\NormalTok{(pop.list,pop.list))}
\NormalTok{vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"filter_rad_20191014@1654/14_filtered/radiator_data_20191014@1710.vcf"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(vcf)<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{-"}\NormalTok{,}\StringTok{"_"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(vcf)) }\CommentTok{# fix individual names}
\CommentTok{# loop through each population pair}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(fst_mat)}\OperatorTok{-}\DecValTok{1}\NormalTok{))\{}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in}\NormalTok{ (i}\OperatorTok{+}\DecValTok{1}\NormalTok{)}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(fst_mat))\{}
    
    \ControlFlowTok{if}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(fst_mat)[i] }\OperatorTok{!=}\StringTok{ }\KeywordTok{colnames}\NormalTok{(fst_mat)[j])\{ }\CommentTok{# sanity check}
\NormalTok{      map1<-pop_map[pop_map[,}\DecValTok{2}\NormalTok{]}\OperatorTok{==}\KeywordTok{rownames}\NormalTok{(fst_mat)[i],]}
\NormalTok{      map2<-pop_map[pop_map[,}\DecValTok{2}\NormalTok{]}\OperatorTok{==}\KeywordTok{colnames}\NormalTok{(fst_mat)[j],]}
\NormalTok{      pwfsts<-}\KeywordTok{gwsca}\NormalTok{(vcf,}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{],map1[,}\DecValTok{1}\NormalTok{],map2[,}\DecValTok{1}\NormalTok{])}
\NormalTok{      fst_mat[i,j]<-}\KeywordTok{mean}\NormalTok{(pwfsts}\OperatorTok{$}\NormalTok{Fst,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}
\KeywordTok{colnames}\NormalTok{(fst_mat)<-}\KeywordTok{rownames}\NormalTok{(fst_mat)<-pop.labs}
\KeywordTok{write.table}\NormalTok{(fst_mat,}\StringTok{"pairwise_fsts_full.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}
            \DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{full_fsts<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_whitelist/batch_2.fst_summary.tsv"}\NormalTok{,}
                      \DataTypeTok{row.names =} \DecValTok{1}\NormalTok{)}
\NormalTok{full_fsts<-}\KeywordTok{rbind}\NormalTok{(full_fsts,}\DataTypeTok{TXSP=}\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{,}\KeywordTok{ncol}\NormalTok{(full_fsts))) }\CommentTok{#add the final row}
\NormalTok{Tfull_fsts<-}\KeywordTok{t}\NormalTok{(full_fsts)}
\NormalTok{full_fsts[}\KeywordTok{lower.tri}\NormalTok{(full_fsts)]<-Tfull_fsts[}\KeywordTok{lower.tri}\NormalTok{(Tfull_fsts)] }\CommentTok{# now it's symmetric}
\NormalTok{full_fsts<-full_fsts[pop.list,pop.list]}
\KeywordTok{colnames}\NormalTok{(full_fsts)<-}\KeywordTok{rownames}\NormalTok{(full_fsts)<-pop.labs}
\NormalTok{fst_mat<-}\KeywordTok{as.matrix}\NormalTok{(full_fsts)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(lattice); }\KeywordTok{library}\NormalTok{(grid); }\KeywordTok{library}\NormalTok{(RColorBrewer)}
\NormalTok{poporder<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"treemix/poporder"}\NormalTok{)}
\NormalTok{colors<-poporder}\OperatorTok{$}\NormalTok{colors}
\NormalTok{poporder<-poporder}\OperatorTok{$}\NormalTok{poporder}

\NormalTok{nr<-}\KeywordTok{treemix.cov.plot}\NormalTok{(}\StringTok{"treemix/fwsw_k100b"}\NormalTok{,poporder)}
\KeywordTok{dimnames}\NormalTok{(nr)[[}\DecValTok{1}\NormalTok{]]<-}\KeywordTok{dimnames}\NormalTok{(nr)[[}\DecValTok{2}\NormalTok{]]<-pop.labs}
\CommentTok{# colors}
\NormalTok{colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\StringTok{"darkgrey"}\NormalTok{,}\StringTok{"grey"}\NormalTok{,}\StringTok{"lightgrey"}\NormalTok{,}\StringTok{"cornflowerblue"}\NormalTok{)}
\NormalTok{pal<-}\KeywordTok{colorRampPalette}\NormalTok{(colors)}
\NormalTok{ncol=}\DecValTok{80}
\NormalTok{cols<-}\KeywordTok{pal}\NormalTok{(ncol)}
\NormalTok{rev.colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{"cornflowerblue"}\NormalTok{,}\StringTok{"lightgrey"}\NormalTok{,}\StringTok{"grey"}\NormalTok{,}\StringTok{"darkgrey"}\NormalTok{,}\StringTok{"black"}\NormalTok{)}
\NormalTok{rev.pal<-}\KeywordTok{colorRampPalette}\NormalTok{(rev.colors)}
\NormalTok{rev.cols<-}\KeywordTok{rev.pal}\NormalTok{(ncol)}

\NormalTok{hm.height<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{x=}\DecValTok{2}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{)}\CommentTok{#2.2/3.8}
\NormalTok{hm.width<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{x=}\FloatTok{2.4}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{)}\CommentTok{#2.4 in RStudio/3.9}

\NormalTok{heatmaps.name<-}\StringTok{"../figs/fst_heatmaps.png"}

\KeywordTok{png}\NormalTok{(heatmaps.name,}\DataTypeTok{height=}\DecValTok{5}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{)}

\NormalTok{fst.lv<-}\KeywordTok{levelplot}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(fst_mat),}\DataTypeTok{col.regions=}\NormalTok{cols,}\DataTypeTok{alpha.regions=}\FloatTok{0.7}\NormalTok{,}
                  \DataTypeTok{scales =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{rot=}\DecValTok{90}\NormalTok{),}\DataTypeTok{tck =} \DecValTok{0}\NormalTok{),}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{)}
\KeywordTok{print}\NormalTok{(fst.lv,}\DataTypeTok{split=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{more=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{panel.width=}\NormalTok{hm.width,}
      \DataTypeTok{panel.height=}\NormalTok{hm.height,}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}
\KeywordTok{trellis.focus}\NormalTok{(}\StringTok{"legend"}\NormalTok{, }\DataTypeTok{side=}\StringTok{"right"}\NormalTok{, }\DataTypeTok{clipp.off=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{highlight=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{grid.text}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(F)[ST]), }\FloatTok{0.2}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{hjust=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{vjust=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{gp=}\KeywordTok{gpar}\NormalTok{(}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{))}
\KeywordTok{trellis.unfocus}\NormalTok{()}

\NormalTok{nr.lv<-}\KeywordTok{levelplot}\NormalTok{(nr,}\DataTypeTok{col.regions=}\NormalTok{cols,}\DataTypeTok{alpha.regions=}\FloatTok{0.7}\NormalTok{,}
                 \DataTypeTok{scales =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{rot=}\DecValTok{90}\NormalTok{),}\DataTypeTok{tck =} \DecValTok{0}\NormalTok{),}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{)}
\KeywordTok{print}\NormalTok{(nr.lv,}\DataTypeTok{split=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{more=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{newpage=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{panel.width=}\NormalTok{hm.width,}
      \DataTypeTok{panel.height=}\NormalTok{hm.height,}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{)}
\KeywordTok{trellis.focus}\NormalTok{(}\StringTok{"legend"}\NormalTok{, }\DataTypeTok{side=}\StringTok{"right"}\NormalTok{, }\DataTypeTok{clipp.off=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{highlight=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{grid.text}\NormalTok{(}\StringTok{"Treemix"}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{hjust=}\FloatTok{0.5}\NormalTok{, }\DataTypeTok{vjust=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{gp=}\KeywordTok{gpar}\NormalTok{(}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{))}
\KeywordTok{trellis.unfocus}\NormalTok{()}

\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{../figs/fst_heatmaps.png}
\caption{Heatmaps depicting population structure. In all graphs, dark
colors depict similarity between populations and light grey and blue
depict populations with high differentiation. The left panel shows
pairwise FST values calculated by the populations module in Stacks
(Catchen et al. 2013). The right panel shows covariances between
populations as calculated by TreeMix (Pickrell and Pritchard 2012).}
\end{figure}

\subsection*{PCAdapt}\label{pcadapt}
\addcontentsline{toc}{subsection}{PCAdapt}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(pcadapt)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filename<-}\KeywordTok{read.pcadapt}\NormalTok{(}\StringTok{"filter_rad_20191014@1654/14_filtered/radiator_data_20191014@1710.vcf"}\NormalTok{,}
                       \DataTypeTok{type=}\StringTok{"vcf"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## No variant got discarded.
## Summary:
## 
##  - input file:               filter_rad_20191014@1654/14_filtered/radiator_data_20191014@1710.vcf
##  - output file:              /tmp/RtmpWYtABi/file21ac60c77de8.pcadapt
## 
##  - number of individuals detected:   605
##  - number of loci detected:      7433
## 
## 7433 lines detected.
## 605 columns detected.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x<-}\KeywordTok{pcadapt}\NormalTok{(filename, }\DataTypeTok{K=}\DecValTok{20}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(x,}\DataTypeTok{option=}\StringTok{"screeplot"}\NormalTok{) }\CommentTok{#K=7}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/pcadaptChoose-1} \caption{Scree plot from PCAdapt, specifying keeping 20 PC axes.}\label{fig:pcadaptChoose}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pa<-}\KeywordTok{pcadapt}\NormalTok{(filename,}\DataTypeTok{K=}\DecValTok{7}\NormalTok{)}
\KeywordTok{saveRDS}\NormalTok{(pa,}\StringTok{"fwsw_all_pcadapt.RDS"}\NormalTok{)}
\NormalTok{pa.props<-}\KeywordTok{round}\NormalTok{((pa}\OperatorTok{$}\NormalTok{singular.values}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(pa}\OperatorTok{$}\NormalTok{singular.values))}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\KeywordTok{kable}\NormalTok{(pa.props,}\DataTypeTok{caption=}\StringTok{"Proportion of variation explained by all 7 of the retained PC axes in PCAdapt"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:pcadaptAnalyze}Proportion of variation explained by all 7 of the retained PC axes in PCAdapt}
\centering
\begin{tabular}[t]{r}
\hline
x\\
\hline
33.26\\
\hline
20.25\\
\hline
16.71\\
\hline
10.09\\
\hline
7.58\\
\hline
6.68\\
\hline
5.43\\
\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind_dat<-}\KeywordTok{read.table}\NormalTok{(}
  \StringTok{"filter_rad_20191014@1654/14_filtered/individuals.qc.stats_20191014@1654.tsv"}\NormalTok{,}
  \DataTypeTok{header=}\NormalTok{T, }\DataTypeTok{stringsAsFactors =}\NormalTok{ F)}
\NormalTok{pops<-ind_dat}\OperatorTok{$}\NormalTok{STRATA    }
\NormalTok{grp<-pops}
\NormalTok{grp[grp}\OperatorTok{==}\StringTok{"TXFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"LAFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"ALFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"freshwater"}
\NormalTok{grp[grp}\OperatorTok{!=}\StringTok{"freshwater"}\NormalTok{]<-}\StringTok{"saltwater"}

\CommentTok{#colors}
\NormalTok{pap<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Pop=}\NormalTok{pops,}\DataTypeTok{cols=}\NormalTok{pops,}\DataTypeTok{pch=}\NormalTok{pops,}\DataTypeTok{grp=}\NormalTok{grp,}\DataTypeTok{stringsAsFactors =}\NormalTok{ F)}
\NormalTok{pap}\OperatorTok{$}\NormalTok{Pop[pap}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{==}\StringTok{ "FLLG"}\NormalTok{]<-}\StringTok{"FLFW"}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(pap))\{}
\NormalTok{  pap[i,}\StringTok{"cols"}\NormalTok{]<-}\KeywordTok{as.character}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{pap[i,}\StringTok{"Pop"}\NormalTok{],}\StringTok{"cols"}\NormalTok{])}
\NormalTok{\}}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(pap))\{}
\NormalTok{  pap[i,}\StringTok{"pch"}\NormalTok{]<-}\KeywordTok{as.numeric}\NormalTok{(ppi[ppi}\OperatorTok{$}\NormalTok{Pop }\OperatorTok{%in%}\StringTok{ }\NormalTok{pap[i,}\StringTok{"Pop"}\NormalTok{],}\StringTok{"pch"}\NormalTok{])}
\NormalTok{\}}
\KeywordTok{write.table}\NormalTok{(pap,}\StringTok{"pcadapt_colp.txt"}\NormalTok{,}\DataTypeTok{col.names=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{quote=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#plot}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{1}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{2}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch),   }\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,pa.props[}\DecValTok{1}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,pa.props[}\DecValTok{2}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{3}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{4}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch),}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC3 ("}\NormalTok{,pa.props[}\DecValTok{3}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC4 ("}\NormalTok{,pa.props[}\DecValTok{4}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{5}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{6}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch),}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC5 ("}\NormalTok{,pa.props[}\DecValTok{5}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC6 ("}\NormalTok{,pa.props[}\DecValTok{6}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{1}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{2}\NormalTok{],}
     \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{]),}
    \DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,pa.props[}\DecValTok{1}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,pa.props[}\DecValTok{2}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{3}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{4}\NormalTok{],}
     \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{]),}
    \DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC3 ("}\NormalTok{,pa.props[}\DecValTok{3}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC4 ("}\NormalTok{,pa.props[}\DecValTok{4}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{5}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{,}\DecValTok{6}\NormalTok{],}
     \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
     \DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{],}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch[pap}\OperatorTok{$}\NormalTok{grp}\OperatorTok{==}\StringTok{"freshwater"}\NormalTok{]),}
    \DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC5 ("}\NormalTok{,pa.props[}\DecValTok{5}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC6 ("}\NormalTok{,pa.props[}\DecValTok{6}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new =} \OtherTok{TRUE}\NormalTok{,}
    \DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{bty =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{xaxt =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{yaxt =} \StringTok{"n"}\NormalTok{)}

\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{, }\DataTypeTok{legend=}\NormalTok{ppi}\OperatorTok{$}\NormalTok{Pop, }\DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{pch), }\DataTypeTok{pt.cex=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{,}
       \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{cols, }\FloatTok{0.5}\NormalTok{),}\DataTypeTok{pt.bg=}\KeywordTok{alpha}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.25}\NormalTok{), }\DataTypeTok{ncol=}\DecValTok{8}\NormalTok{,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbackslash{}begin\{figure\}{[}H{]}
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotPcadaptInitial-1}
\textbackslash{}caption\{Principal components analysis of genotypes in
S. scovelli reveals population structure due to geographic distance and
habitat type. The top set of panels show the results of the PCA with all
16 populations, color-coded by populations and point shape. The bottom
set of panels show the same PCA results, but with different x- and
y-axis scaling and without the saltwater populations plotted, to
facilitate visualizing the differences among saltwater populations. The
left panels show the first and second PC axes, whcih together account
for 53.5\% of the varation, the middle panels show the 3rd and 4th PC
axes (another 26.8\% of the variation), and the right panels the fifth
and sixth axes (another \% of variation).\}\label{fig:plotPcadaptInitial}
\textbackslash{}end\{figure\}

\subsection*{Admixture scree plots}\label{admixture-scree-plots}
\addcontentsline{toc}{subsection}{Admixture scree plots}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"admixture/K_CVs.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{admixK}\OperatorTok{$}\NormalTok{K<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{".*}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{(K=(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,admixK}\OperatorTok{$}\NormalTok{V1))}
\NormalTok{admixK}\OperatorTok{$}\NormalTok{CV<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"^.*}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{: (}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{.}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)$"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,admixK}\OperatorTok{$}\NormalTok{V1))}

\NormalTok{admixK<-admixK[}\KeywordTok{order}\NormalTok{(admixK}\OperatorTok{$}\NormalTok{K),]}

\KeywordTok{plot}\NormalTok{(admixK}\OperatorTok{$}\NormalTok{K,admixK}\OperatorTok{$}\NormalTok{CV,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{type =} \StringTok{"b"}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{1}\NormalTok{,}\DataTypeTok{xlab =} \StringTok{"K"}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{"CV"}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixScree-1} \caption{Admixture screeplot for K=1 through K=16. The coefficient of variation (CV) is shown on the y-axis.}\label{fig:admixScree}
\end{figure}

Looks like \(K=5\) or \(K=7\) are the best, let's look at all of the
\(K=2\) through \(K=7\).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(RColorBrewer)}
\NormalTok{famfile<-}\StringTok{"admixture/fwsw_all_filt.fam"}

\NormalTok{poporderFile<-}\StringTok{"treemix/poplist"}
\NormalTok{poporderDF<-}\KeywordTok{read.table}\NormalTok{(poporderFile,}\DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{"Pop"}\NormalTok{),}\DataTypeTok{stringsAsFactors =}\NormalTok{ F)}
\NormalTok{poporderDF}\OperatorTok{$}\NormalTok{orderNum<-}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(poporderDF)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixPlotting<-}\ControlFlowTok{function}\NormalTok{(qfile,K,}\DataTypeTok{famfile=}\StringTok{"admixture/fwsw_all_filt.fam"}\NormalTok{,}
                        \DataTypeTok{poporder=}\NormalTok{poporderDF)\{}
  \CommentTok{# read files in }
\NormalTok{  famTable<-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(famfile, }\DataTypeTok{col.names =} 
                        \KeywordTok{c}\NormalTok{(}\StringTok{"Pop"}\NormalTok{,}\StringTok{"Ind"}\NormalTok{,}\StringTok{"Father"}\NormalTok{,}\StringTok{"Mother"}\NormalTok{,}\StringTok{"Sex"}\NormalTok{,}\StringTok{"phenotype"}\NormalTok{),}
                      \DataTypeTok{stringsAsFactors =}\NormalTok{ F)[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{]}

\NormalTok{  qtbl<-}\KeywordTok{read.table}\NormalTok{(qfile,}\DataTypeTok{stringsAsFactors =}\NormalTok{ F)}
  
  \CommentTok{# create useful tables}
\NormalTok{  mergedAdmixtureTable <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(qtbl, famTable)}
\NormalTok{  mergedAdmixTabOrderNs <-}\StringTok{ }\KeywordTok{merge}\NormalTok{(mergedAdmixtureTable,poporder,}\DataTypeTok{by=}\StringTok{"Pop"}\NormalTok{)}
\NormalTok{  ordered <-}\StringTok{ }\NormalTok{mergedAdmixTabOrderNs[}\KeywordTok{order}\NormalTok{(mergedAdmixTabOrderNs}\OperatorTok{$}\NormalTok{orderNum),]}
  
  \KeywordTok{plotting.structure}\NormalTok{(ordered[,}\DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(ordered)}\OperatorTok{-}\DecValTok{2}\NormalTok{)],}\DataTypeTok{k =}\NormalTok{ K,}
                     \DataTypeTok{pop.order =}\NormalTok{ poporder}\OperatorTok{$}\NormalTok{Pop,}\DataTypeTok{make.file =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{  admix<-ordered[,}\DecValTok{1}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(ordered)}\OperatorTok{-}\DecValTok{2}\NormalTok{)]}
  \KeywordTok{return}\NormalTok{(admix)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK2<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.2.Q"}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixK2-1} \caption{Admixture plot for K=2. The colors represent different genetic populations.}\label{fig:admixK2}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK3<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.3.Q"}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixK3-1} \caption{Admixture plot for K=3. The colors represent different genetic populations.}\label{fig:admixK3}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK4<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.4.Q"}\NormalTok{,}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixK4-1} \caption{Admixture plot for K=4. The colors represent different genetic populations.}\label{fig:admixK4}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK5<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.5.Q"}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixk5-1} \caption{Admixture plot for K=5. The colors represent different genetic populations.}\label{fig:admixk5}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{write.table}\NormalTok{(admixK5,}\StringTok{"admixture/admixK5.txt"}\NormalTok{,}\DataTypeTok{sep =} \StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}
            \DataTypeTok{quote =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK6<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.6.Q"}\NormalTok{,}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixk6-1} \caption{Admixture plot for K=6. The colors represent different genetic populations.}\label{fig:admixk6}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{admixK7<-}\KeywordTok{admixPlotting}\NormalTok{(}\StringTok{"admixture/fwsw_all_filt.7.Q"}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/admixk7-1} \caption{Admixture plot for K=7. The colors represent different genetic populations.}\label{fig:admixk7}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{write.table}\NormalTok{(admixK7,}\StringTok{"admixture/admixK7.txt"}\NormalTok{,}\DataTypeTok{sep =} \StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{quote =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection*{Treemix analysis}\label{treemix-analysis}
\addcontentsline{toc}{subsection}{Treemix analysis}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poporder<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}
            \StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}\StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}
            \StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)}
\NormalTok{colors<-poporder}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ "FLLG"}\NormalTok{]<-grp.colors[}\DecValTok{6}\NormalTok{]}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{)]<-grp.colors[}\DecValTok{6}\NormalTok{]}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FLAB"}\NormalTok{)]<-grp.colors[}\DecValTok{5}\NormalTok{]}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{)]<-grp.colors[}\DecValTok{3}\NormalTok{]}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{)]<-grp.colors[}\DecValTok{2}\NormalTok{]}
\NormalTok{colors[colors }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{)]<-grp.colors[}\DecValTok{1}\NormalTok{]}
\KeywordTok{write.table}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(poporder,colors),}\StringTok{"poporder"}\NormalTok{,}\DataTypeTok{quote=}\NormalTok{F,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection{Tree with no migration edges and no
root}\label{tree-with-no-migration-edges-and-no-root}

It's informative to plot the treemix tree that does not have any
migration edges added for comparison later.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# unrooted tree}
\KeywordTok{library}\NormalTok{(ape)}
\NormalTok{tre<-}\KeywordTok{read.tree}\NormalTok{(}\StringTok{"treemix/unrooted_consensus.newick"}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/treemix_unrooted_consense.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(tre)}
\KeywordTok{dev.off}\NormalTok{()}
\KeywordTok{write.tree}\NormalTok{(tre,}\StringTok{'treemix/unrooted_consensus.newick'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{include_graphics}\NormalTok{(}\StringTok{'../figs/treemix_unrooted_consense.png'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics[width=8in,]{../figs/treemix_unrooted_consense} \caption{The consensus tree from running Treemix without any migration edges  and no root.}\label{fig:treemixUnrooted}
\end{figure}

\subsubsection{Tree with FLAB as root}\label{tree-with-flab-as-root}

We ran Treemix assuming the FLAB was the root with 100 bootstrap
replicates. We then used PHYLIP's consense program to build a consensus
tree, assuming that it was a rooted tree. We also re-saved it to file so
it would be in one line and thus compatible with treemix.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# rooted tree}
\NormalTok{tre<-}\KeywordTok{read.tree}\NormalTok{(}\StringTok{"treemix/rooted_consensus.newick"}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../../figs/treemix_rooted_consense.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(tre)}
\KeywordTok{dev.off}\NormalTok{()}
\KeywordTok{write.tree}\NormalTok{(tre,}\StringTok{'treemix/rooted_consensus.newick'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{include_graphics}\NormalTok{(}\StringTok{'../figs/treemix_unrooted_consense.png'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics[width=8in,]{../figs/treemix_unrooted_consense} \caption{The consensus tree from running Treemix without any migration edges and FLAB as root.}\label{fig:treemixRooted}
\end{figure}

\subsubsection{Choosing the optimal number of migration
edges}\label{choosing-the-optimal-number-of-migration-edges}

To choose the optimal number of migration edges, we used the R package
optM ({\textbf{???}}).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(OptM)}
\NormalTok{tmOpt<-}\KeywordTok{optM}\NormalTok{(}\StringTok{"treemix/migrations/"}\NormalTok{)}
\KeywordTok{evanno_treemix}\NormalTok{(tmOpt)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotOptM-1} \caption{Plot showing the comparison of Treemix number of migration edges using the Evanno method.}\label{fig:plotOptM}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lliks<-}\KeywordTok{list.files}\NormalTok{(}\DataTypeTok{path=}\StringTok{"treemix/migrations/"}\NormalTok{,}\DataTypeTok{pattern=}\StringTok{".llik"}\NormalTok{,}\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{likes<-}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(lliks,}\ControlFlowTok{function}\NormalTok{(file)\{}
\NormalTok{  likdat<-}\KeywordTok{read.delim}\NormalTok{(file,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names=}\DecValTok{1}\NormalTok{,}\DataTypeTok{sep=}\StringTok{':'}\NormalTok{)}
\NormalTok{  migs<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{".*m(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,file))}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\DataTypeTok{migs=}\NormalTok{migs,}\DataTypeTok{loglikelihood=}\NormalTok{likdat[}\DecValTok{2}\NormalTok{,]))}
\NormalTok{\})))}
\KeywordTok{rownames}\NormalTok{(likes)<-lliks}

\NormalTok{llikMean<-}\KeywordTok{tapply}\NormalTok{(likes}\OperatorTok{$}\NormalTok{loglikelihood,likes}\OperatorTok{$}\NormalTok{migs,mean)}
\NormalTok{llikSEM<-}\KeywordTok{tapply}\NormalTok{(likes}\OperatorTok{$}\NormalTok{loglikelihood,likes}\OperatorTok{$}\NormalTok{migs,}\ControlFlowTok{function}\NormalTok{(x)\{}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{var}\NormalTok{(x)}\OperatorTok{/}\KeywordTok{length}\NormalTok{(x)))}
\NormalTok{\})}

\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\OperatorTok{:}\DecValTok{5}\NormalTok{,}\KeywordTok{as.numeric}\NormalTok{(llikMean),}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}
     \DataTypeTok{xlab=}\StringTok{"Number of migration edges"}\NormalTok{,}
     \DataTypeTok{ylab=}\StringTok{"Log likelihood"}\NormalTok{,}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{8000}\NormalTok{,}\DecValTok{1200}\NormalTok{))}
\KeywordTok{points}\NormalTok{(}\DecValTok{0}\OperatorTok{:}\DecValTok{5}\NormalTok{,llikMean,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{,}\DataTypeTok{type=}\StringTok{'l'}\NormalTok{)}
\KeywordTok{arrows}\NormalTok{(}\DataTypeTok{x0 =} \DecValTok{0}\OperatorTok{:}\DecValTok{5}\NormalTok{,}\DataTypeTok{y0=}\KeywordTok{c}\NormalTok{(llikMean}\OperatorTok{-}\NormalTok{llikSEM),}
       \DataTypeTok{x1=}\DecValTok{0}\OperatorTok{:}\DecValTok{5}\NormalTok{,}\DataTypeTok{y1=}\KeywordTok{c}\NormalTok{(llikMean}\OperatorTok{+}\NormalTok{llikSEM),}\DataTypeTok{code=}\DecValTok{3}\NormalTok{,}\DataTypeTok{angle=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/treemixLlik-1} \caption{Average log likelihoods of treemix bootstrap replicates with 0 through 5 migration edges. Shown are the means (of 100 bootstraps) and the standard error of the mean.}\label{fig:treemixLlik}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m1s<-}\KeywordTok{list.files}\NormalTok{(}\DataTypeTok{pattern=}\StringTok{"m1.*treeout"}\NormalTok{,}\DataTypeTok{path=}\StringTok{"treemix/migrations/"}\NormalTok{,}\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{edges<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(m1s,}\ControlFlowTok{function}\NormalTok{(file)\{}
\NormalTok{  treeout<-}\KeywordTok{scan}\NormalTok{(file,}\DataTypeTok{what=}\StringTok{"character"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}n}\StringTok{'}\NormalTok{)}
\NormalTok{  edge<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{strsplit}\NormalTok{(treeout[}\DecValTok{2}\NormalTok{],}\StringTok{' '}\NormalTok{))}
  \KeywordTok{return}\NormalTok{(edge)}
\NormalTok{\}))}
\KeywordTok{rownames}\NormalTok{(edges)<-m1s}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{starts<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"[[:digit:]]"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,edges[,}\DecValTok{5}\NormalTok{])}
\NormalTok{starts<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{":"}\NormalTok{,}\StringTok{""}\NormalTok{,starts)}
\NormalTok{starts<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{."}\NormalTok{,}\StringTok{""}\NormalTok{,starts)}
\NormalTok{starts<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"e-"}\NormalTok{,}\StringTok{""}\NormalTok{,starts)}
\NormalTok{starts<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{,}\StringTok{", "}\NormalTok{,starts)}
\NormalTok{starTab<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{tree=}\KeywordTok{names}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(starts))),}
                    \DataTypeTok{counts=}\KeywordTok{summary}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(starts)))}
\KeywordTok{rownames}\NormalTok{(starTab)<-}\OtherTok{NULL}
\KeywordTok{kable}\NormalTok{(starTab,}\StringTok{"latex"}\NormalTok{,}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{longtable=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{"tree location"}\NormalTok{,}\StringTok{"number of bootstraps"}\NormalTok{),}
      \DataTypeTok{caption=}\StringTok{"Number of bootstraps with the one migration edge beginning at each of these points on the population trees."}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable_styling}\NormalTok{(}\DataTypeTok{latex_options=}\KeywordTok{c}\NormalTok{(}\StringTok{"HOLD_position"}\NormalTok{,}\StringTok{"repeat_header"}\NormalTok{))  }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{column_spec}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DataTypeTok{width =} \StringTok{"30em"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{>{\raggedright\arraybackslash}p{30em}r}
\caption{\label{tab:M1Starts}Number of bootstraps with the one migration edge beginning at each of these points on the population trees.}\\
\toprule
tree location & number of bootstraps\\
\midrule
\endfirsthead
\caption[]{\label{tab:M1Starts}Number of bootstraps with the one migration edge beginning at each of these points on the population trees. \textit{(continued)}}\\
\toprule
tree location & number of bootstraps\\
\midrule
\endhead
\
\endfoot
\bottomrule
\endlastfoot
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLHB, ((FLCC, FLLG), FLPB))) & 1\\
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLHB, (FLCC, (FLPB, FLLG)))) & 1\\
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, ((FLHB, FLCC), FLPB))) & 11\\
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLCC, (FLHB, FLPB)))) & 9\\
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLHB, (FLCC, FLPB)))) & 28\\
\addlinespace
(((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLPB, (FLCC, FLHB)))) & 7\\
((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, ((FLHB, FLCC), FLPB))) & 1\\
((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
((((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, (FLHB, (FLCC, FLPB)))) & 8\\
(((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLCC, (FLHB, FLPB)))) & 6\\
\addlinespace
(((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLCC, (FLPB, FLHB)))) & 1\\
(((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), (FLKB, FLSG)), (FLSI, FLFD)), (FLLG, (FLHB, (FLCC, FLPB)))) & 7\\
(((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), (FLSG, FLKB)), (FLSI, FLFD)), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, (FLHB, (FLCC, FLPB)))) & 1\\
\addlinespace
((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), ((FLKB, FLSG), (FLSI, FLFD))), (FLLG, (FLPB, (FLCC, FLHB)))) & 1\\
((((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST), (FLSG, (FLKB, (FLSI, FLFD)))), (FLLG, (FLHB, (FLCC, FLPB)))) & 1\\
(((FLKB, (FLSG, ((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST))), (FLSI, FLFD)), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
(((FLKB, (FLSG, ((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST))), (FLSI, FLFD)), (FLLG, (FLHB, (FLCC, FLPB)))) & 5\\
(((FLKB, (FLSG, ((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST))), (FLSI, FLFD)), (FLLG, (FLHB, (FLPB, FLCC)))) & 1\\
\addlinespace
(((FLKB, (FLSG, ((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST))), (FLSI, FLFD)), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
(((FLKB, (FLSG, ((LAFW, (ALFW, ((TXCB, (TXCC, TXSP)), TXFW))), ALST))), (FLSI, FLFD)), (FLLG, (FLHB, (FLCC, FLPB)))) & 2\\
(((FLKB, (FLSI, FLFD)), (FLSG, ((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST))), (FLLG, (FLCC, (FLHB, FLPB)))) & 1\\
(((FLSG, ((((TXCB, (TXCC, TXSP)), TXFW), (ALFW, LAFW)), ALST)), (FLKB, (FLSI, FLFD))), (FLLG, (FLHB, (FLCC, FLPB)))) & 1\\
(FLLG, ((FLHB, FLCC), FLPB)) & 1\\
\addlinespace
FLLG & 1\\
TXFW & 1\\*
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stops<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"[[:digit:]]"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,edges[,}\DecValTok{6}\NormalTok{])}
\NormalTok{stops<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{":"}\NormalTok{,}\StringTok{""}\NormalTok{,stops)}
\NormalTok{stops<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{."}\NormalTok{,}\StringTok{""}\NormalTok{,stops)}
\NormalTok{stops<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"e-"}\NormalTok{,}\StringTok{""}\NormalTok{,stops)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(stops)),}\StringTok{"latex"}\NormalTok{,}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{"number of bootstraps"}\NormalTok{),}
      \DataTypeTok{caption=}\StringTok{"Number of bootstraps with the one migration edge ending at each of these points on the population trees."}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable_styling}\NormalTok{(}\DataTypeTok{latex_options=}\KeywordTok{c}\NormalTok{(}\StringTok{"HOLD_position"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}[H]

\caption{\label{tab:M1Stops}Number of bootstraps with the one migration edge ending at each of these points on the population trees.}
\centering
\begin{tabular}[t]{lr}
\toprule
  & number of bootstraps\\
\midrule
(TXCB,(TXCC,TXSP)) & 1\\
FLCC & 1\\
FLPB & 99\\
\bottomrule
\end{tabular}
\end{table}

The overwhelming majority of bootstrapped trees with one migration edge
have that edge leading from the main branch of the tree to FLPB (see the
above tables for the common start and end points).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bestM1<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{.llik"}\NormalTok{,}\StringTok{""}\NormalTok{,}
             \KeywordTok{rownames}\NormalTok{(likes[likes}\OperatorTok{$}\NormalTok{migs}\OperatorTok{==}\DecValTok{1}\NormalTok{,])[}
               \KeywordTok{which.max}\NormalTok{(likes}\OperatorTok{$}\NormalTok{loglikelihood[likes}\OperatorTok{$}\NormalTok{migs}\OperatorTok{==}\DecValTok{1}\NormalTok{])])}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/treemix_comparison.png"}\NormalTok{,}\DataTypeTok{height =} \DecValTok{4}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{t0<-}\KeywordTok{plot_tree}\NormalTok{(}\StringTok{"treemix/migrations/fwsw_FLAB_m0"}\NormalTok{,}\DataTypeTok{scale=}\NormalTok{T,}\DataTypeTok{mbar=}\NormalTok{F,}\DataTypeTok{cex =} \FloatTok{1.5}\NormalTok{,}
              \DataTypeTok{lwd=}\DecValTok{2}\NormalTok{,}\DataTypeTok{disp=}\FloatTok{0.002}\NormalTok{,}\DataTypeTok{scadj=}\FloatTok{0.05}\NormalTok{)}
\NormalTok{t1<-}\KeywordTok{plot_tree}\NormalTok{(}\StringTok{"treemix/migrations/fwsw_FLAB_m1"}\NormalTok{,}\DataTypeTok{scale=}\NormalTok{T,}\DataTypeTok{mbar=}\NormalTok{T,}\DataTypeTok{cex =} \FloatTok{1.5}\NormalTok{,}
              \DataTypeTok{lwd=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mig_left=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{disp=}\FloatTok{0.0002}\NormalTok{,}\DataTypeTok{scadj=}\FloatTok{0.05}\NormalTok{)}
\NormalTok{t2<-}\KeywordTok{plot_tree}\NormalTok{(bestM1,}\DataTypeTok{scale=}\NormalTok{T,}\DataTypeTok{mbar=}\NormalTok{T,}\DataTypeTok{cex =} \FloatTok{1.5}\NormalTok{,}
              \DataTypeTok{lwd=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mig_left=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{disp=}\FloatTok{0.0002}\NormalTok{,}\DataTypeTok{scadj=}\FloatTok{0.05}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\OperatorTok{::}\KeywordTok{include_graphics}\NormalTok{(}\StringTok{'../figs/treemix_comparison.png'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics[width=0.9\linewidth,]{../figs/treemix_comparison} \caption{The plot of the tree with FLAB as root but no migration edges (left) compared to the tree with FLAB as root and two migration edges. The drift parameter is plotted on the x-axis, and migration edges are colored based on the migration weight.}\label{fig:treemixCompare}
\end{figure}

\subsubsection{Threepop and fourpop
analysis}\label{threepop-and-fourpop-analysis}

We investigated the two migration edges that are in the best Treemix
model using threepop and fourpop analyses. In the threepop analysis,
significantly negative f3 statistics mean that the first pop in the list
(A in A;B,C) is admixed (Pickrell \& Pritchard, 2012; Reich, Thangaraj,
Patterson, Price, \& Singh, 2009). Therefore, with the threepop analysis
we want to look for the tree (A;B,C) where A corresponds to the end of
an arrow and (B,C) corresponds to where an arrow begins. In the fourpop
analysis, a significantly non-zero value indicates gene flow in the tree
(Pickrell \& Pritchard, 2012; Reich et al., 2009).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{threepop<-}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{do.call}\NormalTok{(rbind,}
                             \KeywordTok{strsplit}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}
                               \StringTok{";"}\NormalTok{,}\KeywordTok{readLines}\NormalTok{(}\StringTok{"treemix/fwsw_threepop.txt"}\NormalTok{),}
                               \DataTypeTok{value =} \OtherTok{TRUE}\NormalTok{),}\StringTok{' '}\NormalTok{)),}
                     \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(threepop)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"pops"}\NormalTok{,}\StringTok{"f3_stat"}\NormalTok{,}\StringTok{"f3_se"}\NormalTok{,}\StringTok{"f3_z"}\NormalTok{)}

\NormalTok{fourpop<-}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{do.call}\NormalTok{(rbind,}
                            \KeywordTok{strsplit}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\StringTok{";"}\NormalTok{,}
                                          \KeywordTok{readLines}\NormalTok{(}\StringTok{"treemix/fwsw_fourpop.txt"}\NormalTok{),}
                                          \DataTypeTok{value =} \OtherTok{TRUE}\NormalTok{),}\StringTok{' '}\NormalTok{)),}
                     \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(fourpop)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"pops"}\NormalTok{,}\StringTok{"f4_stat"}\NormalTok{,}\StringTok{"f4_se"}\NormalTok{,}\StringTok{"f4_z"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The migration edge we investigated indicated potential migration from
the ancestral Florida branch to the FLPB branch. We first investigated
all of the three-population trees with FLPB and FLAB and found that the
majority of these trees are positive, which suggests that FLPB is not
admixed with the other Florida populations. Several trees are negative,
but their standard errors overlap with zero, which suggests that FLPB
may experience some admixtre with those populations. Unsurprisingly,
given the admixture and pcadapt results, these trees are those with
other Atlantic Florida populations (FLHB, FLCC, and FLLG/FLFW).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{FLPB_edge<-threepop[}\KeywordTok{grep}\NormalTok{(}\StringTok{"FLPB;.*FLAB.*"}\NormalTok{,threepop}\OperatorTok{$}\NormalTok{pops),]}
\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{f3_stat<-}\KeywordTok{as.numeric}\NormalTok{(FLPB_edge}\OperatorTok{$}\NormalTok{f3_stat)}
\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{f3_se<-}\KeywordTok{as.numeric}\NormalTok{(FLPB_edge}\OperatorTok{$}\NormalTok{f3_se)}
\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{lowSE<-FLPB_edge}\OperatorTok{$}\NormalTok{f3_stat}\OperatorTok{-}\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{f3_se}
\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{uppSE<-FLPB_edge}\OperatorTok{$}\NormalTok{f3_stat}\OperatorTok{+}\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{f3_se}
\NormalTok{FLPB_edge}\OperatorTok{$}\NormalTok{f3_z<-}\KeywordTok{as.numeric}\NormalTok{(FLPB_edge}\OperatorTok{$}\NormalTok{f3_z)}

\NormalTok{ymax<-}\KeywordTok{max}\NormalTok{(}\KeywordTok{abs}\NormalTok{(}\KeywordTok{c}\NormalTok{(FLPB_edge}\OperatorTok{$}\NormalTok{lowSE,FLPB_edge}\OperatorTok{$}\NormalTok{uppSE)))}\OperatorTok{+}\FloatTok{0.001}

\CommentTok{# all the relevant trees}
\KeywordTok{plot}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(FLPB_edge),}\KeywordTok{as.numeric}\NormalTok{(FLPB_edge}\OperatorTok{$}\NormalTok{f3_stat),}
     \DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(ymax}\OperatorTok{*-}\DecValTok{1}\NormalTok{,ymax),}\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{,}
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{"f3 statistic +/- SE"}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{2}\NormalTok{)}
\KeywordTok{arrows}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(FLPB_edge),FLPB_edge}\OperatorTok{$}\NormalTok{lowSE,}
       \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(FLPB_edge),FLPB_edge}\OperatorTok{$}\NormalTok{uppSE,}\DataTypeTok{code=}\DecValTok{3}\NormalTok{,}\DataTypeTok{angle=}\DecValTok{0}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\OperatorTok{-}\FloatTok{0.05}\NormalTok{,}\FloatTok{0.05}\NormalTok{,}\FloatTok{0.01}\NormalTok{),}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\FloatTok{0.01}\NormalTok{,}\DataTypeTok{at=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(FLPB_edge),}
     \DataTypeTok{labels =}\NormalTok{ FLPB_edge}\OperatorTok{$}\NormalTok{pops,}\DataTypeTok{las=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/f3Edge1-1} \caption{Plot of the f3 statistic for three-population trees including both FLPB and FLAB. Error bars show the standard errors generated from block jackknifes. Trees indicative of admixture in FLPB are those with significantly negative f3 statistics.}\label{fig:f3Edge1}
\end{figure}

To investigate the results of the fourpop analysis for this migration
edge, we focused on four-population trees including both FLAB and FLPB
and other Florida populations. All of these four population trees show
evidence of admixture, which is unsurprising given that these trees
include populations that are in the same population clusters in the
admixture and pcadapt results.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f4s<-fourpop[}\KeywordTok{c}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\StringTok{"FLPB,FL.*;FLAB,FL.*"}\NormalTok{,fourpop}\OperatorTok{$}\NormalTok{pops),}
               \KeywordTok{grep}\NormalTok{(}\StringTok{"FL.*,FLPB;FLAB,FL.*"}\NormalTok{,fourpop}\OperatorTok{$}\NormalTok{pops),}
               \KeywordTok{grep}\NormalTok{(}\StringTok{"FLPB,FL.*;FL.*,FLAB"}\NormalTok{,fourpop}\OperatorTok{$}\NormalTok{pops),}
               \KeywordTok{grep}\NormalTok{(}\StringTok{"FL.*,FLPB;FL.*,FLAB"}\NormalTok{,fourpop}\OperatorTok{$}\NormalTok{pops)),]}
\KeywordTok{kable}\NormalTok{(f4s,}\StringTok{"latex"}\NormalTok{,}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{longtable=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{caption =} \StringTok{"Four-population trees with FLPB and FLAB and their f4 statistic, standard error, z-score, and p-value."}\NormalTok{ )}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable_styling}\NormalTok{(}\DataTypeTok{latex_options=}\KeywordTok{c}\NormalTok{(}\StringTok{"HOLD_position"}\NormalTok{,}\StringTok{"repeat_header"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{lllll}
\caption{\label{tab:f4Edge1}Four-population trees with FLPB and FLAB and their f4 statistic, standard error, z-score, and p-value.}\\
\toprule
  & pops & f4\_stat & f4\_se & f4\_z\\
\midrule
\endfirsthead
\caption[]{\label{tab:f4Edge1}Four-population trees with FLPB and FLAB and their f4 statistic, standard error, z-score, and p-value. \textit{(continued)}}\\
\toprule
  & pops & f4\_stat & f4\_se & f4\_z\\
\midrule
\endhead
\
\endfoot
\bottomrule
\endlastfoot
7569 & FLSG,FLPB;FLAB,FLHB & 0.0108426 & 0.0006659 & 16.2826\\
7572 & FLSG,FLPB;FLAB,FLCC & 0.0108142 & 0.000676126 & 15.9943\\
7575 & FLSG,FLPB;FLAB,FLLG & 0.00958893 & 0.000746125 & 12.8516\\
7674 & FLKB,FLPB;FLAB,FLHB & 0.0108759 & 0.000673324 & 16.1526\\
7677 & FLKB,FLPB;FLAB,FLCC & 0.0108676 & 0.000684369 & 15.8797\\
\addlinespace
7680 & FLKB,FLPB;FLAB,FLLG & 0.00966079 & 0.000769578 & 12.5534\\
7734 & FLFD,FLPB;FLAB,FLHB & 0.0111537 & 0.000685198 & 16.2781\\
7737 & FLFD,FLPB;FLAB,FLCC & 0.0111212 & 0.000694793 & 16.0064\\
7740 & FLFD,FLPB;FLAB,FLLG & 0.00984951 & 0.000772256 & 12.7542\\
7764 & FLSI,FLPB;FLAB,FLHB & 0.0114181 & 0.000690251 & 16.5419\\
\addlinespace
7767 & FLSI,FLPB;FLAB,FLCC & 0.01141 & 0.00070008 & 16.2981\\
7770 & FLSI,FLPB;FLAB,FLLG & 0.0100674 & 0.000766841 & 13.1284\\
13029 & FLSG,FLPB;FLAB,FLHB & 0.0108426 & 0.0006659 & 16.2826\\
13032 & FLSG,FLPB;FLAB,FLCC & 0.0108142 & 0.000676126 & 15.9943\\
13035 & FLSG,FLPB;FLAB,FLLG & 0.00958893 & 0.000746125 & 12.8516\\
\addlinespace
13134 & FLKB,FLPB;FLAB,FLHB & 0.0108759 & 0.000673324 & 16.1526\\
13137 & FLKB,FLPB;FLAB,FLCC & 0.0108676 & 0.000684369 & 15.8797\\
13140 & FLKB,FLPB;FLAB,FLLG & 0.00966079 & 0.000769578 & 12.5534\\
13194 & FLFD,FLPB;FLAB,FLHB & 0.0111537 & 0.000685198 & 16.2781\\
13197 & FLFD,FLPB;FLAB,FLCC & 0.0111212 & 0.000694793 & 16.0064\\
\addlinespace
13200 & FLFD,FLPB;FLAB,FLLG & 0.00984951 & 0.000772256 & 12.7542\\
13224 & FLSI,FLPB;FLAB,FLHB & 0.0114181 & 0.000690251 & 16.5419\\
13227 & FLSI,FLPB;FLAB,FLCC & 0.01141 & 0.00070008 & 16.2981\\
13230 & FLSI,FLPB;FLAB,FLLG & 0.0100674 & 0.000766841 & 13.1284\\
7464 & FLSG,FLPB;FLKB,FLAB & 0.00230133 & 0.000211957 & 10.8575\\
\addlinespace
7509 & FLSG,FLPB;FLFD,FLAB & 0.00177997 & 0.000177424 & 10.0323\\
7538 & FLSG,FLPB;FLSI,FLAB & 0.00179893 & 0.000166984 & 10.7731\\
7614 & FLKB,FLPB;FLFD,FLAB & 0.00185955 & 0.000176447 & 10.5389\\
7643 & FLKB,FLPB;FLSI,FLAB & 0.00188169 & 0.000170658 & 11.0261\\
7703 & FLFD,FLPB;FLSI,FLAB & 0.00222764 & 0.000196885 & 11.3145\\
\addlinespace
12924 & FLSG,FLPB;FLKB,FLAB & 0.00230133 & 0.000211957 & 10.8575\\
12969 & FLSG,FLPB;FLFD,FLAB & 0.00177997 & 0.000177424 & 10.0323\\
12998 & FLSG,FLPB;FLSI,FLAB & 0.00179893 & 0.000166984 & 10.7731\\
13074 & FLKB,FLPB;FLFD,FLAB & 0.00185955 & 0.000176447 & 10.5389\\
13103 & FLKB,FLPB;FLSI,FLAB & 0.00188169 & 0.000170658 & 11.0261\\
\addlinespace
13163 & FLFD,FLPB;FLSI,FLAB & 0.00222764 & 0.000196885 & 11.3145\\*
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f4s}\OperatorTok{$}\NormalTok{lowSE<-}\KeywordTok{as.numeric}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{f4_stat)}\OperatorTok{-}\KeywordTok{as.numeric}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{f4_se)}
\NormalTok{f4s}\OperatorTok{$}\NormalTok{uppSE<-}\KeywordTok{as.numeric}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{f4_stat)}\OperatorTok{+}\KeywordTok{as.numeric}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{f4_se)}
\NormalTok{ymax<-}\KeywordTok{max}\NormalTok{(}\KeywordTok{abs}\NormalTok{(}\KeywordTok{c}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{lowSE,FLPB_edge}\OperatorTok{$}\NormalTok{uppSE)))}\OperatorTok{+}\FloatTok{0.001}

\CommentTok{# all the relevant trees}
\KeywordTok{plot}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(f4s),}\KeywordTok{as.numeric}\NormalTok{(f4s}\OperatorTok{$}\NormalTok{f4_stat),}
     \DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(ymax}\OperatorTok{*-}\DecValTok{1}\NormalTok{,ymax),}\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{,}
     \DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{"f4 statistic +/- SE"}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\DataTypeTok{h=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lty=}\DecValTok{2}\NormalTok{)}
\KeywordTok{arrows}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(f4s),f4s}\OperatorTok{$}\NormalTok{lowSE,}
       \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(f4s),f4s}\OperatorTok{$}\NormalTok{uppSE,}\DataTypeTok{code=}\DecValTok{3}\NormalTok{,}\DataTypeTok{angle=}\DecValTok{0}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{at=}\KeywordTok{seq}\NormalTok{(}\OperatorTok{-}\FloatTok{0.05}\NormalTok{,}\FloatTok{0.05}\NormalTok{,}\FloatTok{0.01}\NormalTok{),}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\FloatTok{0.01}\NormalTok{,}\DataTypeTok{at=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(f4s),}
     \DataTypeTok{labels =}\NormalTok{ f4s}\OperatorTok{$}\NormalTok{pops,}\DataTypeTok{las=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/f4Edge1Fig-1} \caption{Plot of the f4 statistic for four-population trees including both FLPB and FLAB and other Florida populations. Error bars show the standard errors generated from block jackknifes. Trees indicative of admixture in the tree are those with significantly non-zero f4 statistics.}\label{fig:f4Edge1Fig}
\end{figure}

\subsection{Make figure}\label{make-figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grp.colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#af8dc3'}\NormalTok{,}\StringTok{'#e7d4e8'}\NormalTok{,}\StringTok{'#d9f0d3'}\NormalTok{,}\StringTok{'#7fbf7b'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{) }
\NormalTok{grp7colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#9970ab'}\NormalTok{,}\StringTok{'#c2a5cf'}\NormalTok{,}\StringTok{'#d9f0d3'}\NormalTok{,}\StringTok{'#a6dba0'}\NormalTok{,}\StringTok{'#5aae61'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{)}
\NormalTok{grp5colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#c2a5cf'}\NormalTok{,}\StringTok{'#a6dba0'}\NormalTok{,}\StringTok{'#5aae61'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#admixture }
\NormalTok{admixK5<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"admixture/admixK5.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{admixK7<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"admixture/admixK7.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
\CommentTok{#pcadapt}
\NormalTok{pa<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fwsw_all_pcadapt.RDS"}\NormalTok{)}
\NormalTok{pa.props<-}\KeywordTok{round}\NormalTok{((pa}\OperatorTok{$}\NormalTok{singular.values}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(pa}\OperatorTok{$}\NormalTok{singular.values))}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{pap<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"pcadapt_colp.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{)}
\CommentTok{# map}
\KeywordTok{library}\NormalTok{(jpeg)}
\NormalTok{img<-}\KeywordTok{readJPEG}\NormalTok{(}\StringTok{"all_sites_map.jpeg"}\NormalTok{)}

\CommentTok{# stuff for treemix}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/203_treemix_plotting_funcs.R"}\NormalTok{) }\CommentTok{#I've modified the functions from treemix}
\KeywordTok{library}\NormalTok{(lattice); }\KeywordTok{library}\NormalTok{(grid); }\KeywordTok{library}\NormalTok{(RColorBrewer)}
\NormalTok{poporder<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"treemix/poporder"}\NormalTok{)}
\NormalTok{colors<-poporder}\OperatorTok{$}\NormalTok{colors}
\NormalTok{poporder<-poporder}\OperatorTok{$}\NormalTok{poporder}

\NormalTok{d <-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"treemix/migrations/fwsw_FLAB_m1.vertices.gz"}\NormalTok{, }
                \DataTypeTok{as.is  =}\NormalTok{ T, }\DataTypeTok{comment.char =} \StringTok{""}\NormalTok{, }\DataTypeTok{quote =} \StringTok{""}\NormalTok{)}
\NormalTok{branch.cols<-}\KeywordTok{rep}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\KeywordTok{nrow}\NormalTok{(d))}
\NormalTok{branch.cols[d[,}\DecValTok{2}\NormalTok{] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)]<-}\StringTok{"cornflowerblue"}

\NormalTok{tip.names<-}\KeywordTok{as.vector}\NormalTok{(d[d[,}\DecValTok{5}\NormalTok{] }\OperatorTok{==}\StringTok{ "TIP"}\NormalTok{,}\DecValTok{2}\NormalTok{])}
\NormalTok{tip.names<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Original=}\NormalTok{tip.names,}\DataTypeTok{Replacement=}\NormalTok{tip.names,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{tip.names}\OperatorTok{$}\NormalTok{Replacement[tip.names}\OperatorTok{$}\NormalTok{Replacement}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"FLFW"}


\NormalTok{col_vector<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{TXSP=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{TXCC=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{TXFW=}\StringTok{"#2166ac"}\NormalTok{,}\DataTypeTok{TXCB=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{LAFW=}\StringTok{"#2166ac"}\NormalTok{,}\DataTypeTok{ALST=}\StringTok{'#af8dc3'}\NormalTok{,}
              \DataTypeTok{ALFW=}\StringTok{"#2166ac"}\NormalTok{,}\DataTypeTok{FLSG=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{FLKB=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{FLFD=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{FLSI=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{FLAB=}\StringTok{'#7fbf7b'}\NormalTok{,}
              \DataTypeTok{FLPB=}\StringTok{'#1b7837'}\NormalTok{,}\DataTypeTok{FLHB=}\StringTok{'#1b7837'}\NormalTok{,}\DataTypeTok{FLCC=}\StringTok{'#1b7837'}\NormalTok{,}\DataTypeTok{FLFW=}\StringTok{"#2166ac"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{npop<-}\KeywordTok{length}\NormalTok{(pop.list)}
\NormalTok{pseq<-}\DecValTok{1}\OperatorTok{:}\NormalTok{npop}
\NormalTok{m<-}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{16}\NormalTok{),}\KeywordTok{rep}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{),}
            \DecValTok{3}\OperatorTok{:}\DecValTok{18}\NormalTok{,}\KeywordTok{rep}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{),}
            \DecValTok{19}\OperatorTok{:}\DecValTok{34}\NormalTok{,}\KeywordTok{rep}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{),}
            \KeywordTok{rep}\NormalTok{(}\DecValTok{35}\NormalTok{,}\DecValTok{8}\NormalTok{),}\KeywordTok{rep}\NormalTok{(}\DecValTok{36}\NormalTok{,}\DecValTok{8}\NormalTok{),}\KeywordTok{rep}\NormalTok{(}\DecValTok{37}\NormalTok{,}\DecValTok{6}\NormalTok{)),}
          \DataTypeTok{nrow=}\DecValTok{4}\NormalTok{,}\DataTypeTok{ncol=}\NormalTok{npop}\OperatorTok{+}\DecValTok{6}\NormalTok{,}\DataTypeTok{byrow =}\NormalTok{ T)}
\KeywordTok{jpeg}\NormalTok{(}\StringTok{"../figs/NewPopStructure_v1.jpeg"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\DecValTok{10}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{)}
\CommentTok{#set the layout}
\KeywordTok{layout}\NormalTok{(}\DataTypeTok{mat=}\NormalTok{m,}\DataTypeTok{heights=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\CommentTok{#MAP}
\CommentTok{#open an empty plot window with coordinates}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\FloatTok{1.5}\NormalTok{,}\FloatTok{3.5}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{NA}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{14}\NormalTok{,}\DataTypeTok{ty=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\CommentTok{#specify the position of the image through bottom-left and top-right coords}
\KeywordTok{rasterImage}\NormalTok{(img,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x =} \FloatTok{1.5}\NormalTok{,}\DataTypeTok{y=}\FloatTok{11.5}\NormalTok{,}\StringTok{"A"}\NormalTok{,}\DataTypeTok{cex =} \DecValTok{2}\NormalTok{,}\DataTypeTok{font =}\DecValTok{2}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x =} \FloatTok{0.5}\NormalTok{,}\DataTypeTok{y=}\FloatTok{1.2}\NormalTok{,}\StringTok{"C"}\NormalTok{,}\DataTypeTok{cex =} \DecValTok{2}\NormalTok{,}\DataTypeTok{font =}\DecValTok{2}\NormalTok{)}

\CommentTok{#Treemix}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{t2<-}\KeywordTok{plot_tree}\NormalTok{(}\StringTok{"treemix/migrations/fwsw_FLAB_m1"}\NormalTok{,}\DataTypeTok{scale=}\NormalTok{T,}\DataTypeTok{mbar=}\NormalTok{T,}\DataTypeTok{cex =} \FloatTok{1.5}\NormalTok{,}
              \DataTypeTok{lwd=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mig_left=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{disp=}\FloatTok{0.0002}\NormalTok{,}\DataTypeTok{scadj=}\FloatTok{0.05}\NormalTok{,}
              \DataTypeTok{tip.order=}\NormalTok{tip.names,}\DataTypeTok{branch.cols =}\NormalTok{ branch.cols,}
              \DataTypeTok{tip.col=}\NormalTok{col_vector[tip.names}\OperatorTok{$}\NormalTok{Replacement])}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x =} \FloatTok{0.035}\NormalTok{,}\DataTypeTok{y=}\FloatTok{0.9}\NormalTok{,}\StringTok{"B"}\NormalTok{,}\DataTypeTok{cex =} \DecValTok{2}\NormalTok{,}\DataTypeTok{font =}\DecValTok{2}\NormalTok{)}
\CommentTok{#STRUCTURE}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\KeywordTok{plotting.structure}\NormalTok{(admixK5,}\DecValTok{5}\NormalTok{,}\DataTypeTok{pop.order =}\NormalTok{ poporder, pop.list, }\DataTypeTok{make.file=}\OtherTok{FALSE}\NormalTok{, }
                   \DataTypeTok{xlabcol =}\NormalTok{ all.colors,}\DataTypeTok{plot.new=}\OtherTok{FALSE}\NormalTok{,}
                   \DataTypeTok{colors=}\NormalTok{grp5colors[}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)],}\DataTypeTok{xlabel=}\OtherTok{FALSE}\NormalTok{,}
                   \DataTypeTok{ylabel=}\KeywordTok{expression}\NormalTok{(}\KeywordTok{atop}\NormalTok{(}\KeywordTok{italic}\NormalTok{(K)}\OperatorTok{==}\DecValTok{5}\NormalTok{)),}\DataTypeTok{lab.cex=}\FloatTok{0.85}\NormalTok{)}
\KeywordTok{plotting.structure}\NormalTok{(admixK7,}\DecValTok{7}\NormalTok{,}\DataTypeTok{pop.order =}\NormalTok{ poporder,pop.labs, }\DataTypeTok{make.file=}\OtherTok{FALSE}\NormalTok{,}
                   \DataTypeTok{plot.new=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{colors=}\NormalTok{grp7colors[}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)],}\DataTypeTok{xlabel=}\OtherTok{TRUE}\NormalTok{,}
                   \DataTypeTok{xlabcol =}\NormalTok{ all.colors,}
                   \DataTypeTok{ylabel=}\KeywordTok{expression}\NormalTok{(}\KeywordTok{atop}\NormalTok{(}\KeywordTok{italic}\NormalTok{(K)}\OperatorTok{==}\DecValTok{7}\NormalTok{)),}\DataTypeTok{lab.cex=}\FloatTok{0.85}\NormalTok{)}

\CommentTok{#PCADAPT}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{1}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{2}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch),   }\DataTypeTok{cex=}\DecValTok{3}\NormalTok{,}\DataTypeTok{bty=}\StringTok{"L"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{)}

\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC1 ("}\NormalTok{,pa.props[}\DecValTok{1}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \FloatTok{2.5}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC2 ("}\NormalTok{,pa.props[}\DecValTok{2}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \FloatTok{2.5}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x =} \FloatTok{-0.07}\NormalTok{,}\DataTypeTok{y=}\FloatTok{0.1}\NormalTok{,}\StringTok{"D"}\NormalTok{,}\DataTypeTok{cex =} \DecValTok{2}\NormalTok{,}\DataTypeTok{font =}\DecValTok{2}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{3}\NormalTok{],pa}\OperatorTok{$}\NormalTok{scores[,}\DecValTok{4}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{bg=}\KeywordTok{alpha}\NormalTok{(pap}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.75}\NormalTok{),}
     \DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(pap}\OperatorTok{$}\NormalTok{pch),}
     \DataTypeTok{cex=}\DecValTok{3}\NormalTok{, }\DataTypeTok{bty=}\StringTok{"L"}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{cex.axis=}\FloatTok{1.5}\NormalTok{)}

\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC3 ("}\NormalTok{,pa.props[}\DecValTok{3}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{1}\NormalTok{,}\DataTypeTok{line =} \FloatTok{2.5}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"PC4 ("}\NormalTok{,pa.props[}\DecValTok{4}\NormalTok{],}\StringTok{"%)"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line =} \FloatTok{2.5}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{,}\DataTypeTok{ty=}\StringTok{"n"}\NormalTok{,}\DataTypeTok{axes=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"bottom"}\NormalTok{, }\DataTypeTok{legend=}\NormalTok{ppi}\OperatorTok{$}\NormalTok{Pop, }\DataTypeTok{pch=}\KeywordTok{as.numeric}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{pch), }\DataTypeTok{pt.cex=}\DecValTok{3}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{,}
       \DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{cols, }\FloatTok{0.5}\NormalTok{),}\DataTypeTok{pt.bg=}\KeywordTok{alpha}\NormalTok{(ppi}\OperatorTok{$}\NormalTok{cols,}\FloatTok{0.25}\NormalTok{), }\DataTypeTok{ncol=}\DecValTok{2}\NormalTok{,}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{../figs/NewPopStructure_v1.jpeg}
\caption{Population Structure summary plot (Figure 1 in main document)}
\end{figure}

\subsection{Make table}\label{make-table}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{full_fsts<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_whitelist/batch_2.fst_summary.tsv"}\NormalTok{,}
                      \DataTypeTok{row.names =} \DecValTok{1}\NormalTok{)}
\NormalTok{full_fsts<-}\KeywordTok{rbind}\NormalTok{(full_fsts,}\DataTypeTok{TXSP=}\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{,}\KeywordTok{ncol}\NormalTok{(full_fsts))) }\CommentTok{#add the final row}
\NormalTok{Tfull_fsts<-}\KeywordTok{t}\NormalTok{(full_fsts)}
\NormalTok{full_fsts[}\KeywordTok{lower.tri}\NormalTok{(full_fsts)]<-Tfull_fsts[}\KeywordTok{lower.tri}\NormalTok{(Tfull_fsts)] }\CommentTok{# now it's symmetric}
\NormalTok{full_fsts<-full_fsts[pop.list,pop.list]}
\KeywordTok{colnames}\NormalTok{(full_fsts)<-}\KeywordTok{rownames}\NormalTok{(full_fsts)<-pop.labs}
\NormalTok{fst_mat<-}\KeywordTok{as.matrix}\NormalTok{(full_fsts)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cov<-}\KeywordTok{read.table}\NormalTok{(}\KeywordTok{gzfile}\NormalTok{(}\StringTok{"treemix/unrooted/fwsw_ML_consensus.cov.gz"}\NormalTok{), }\DataTypeTok{as.is =}\NormalTok{ T, }\DataTypeTok{head =}\NormalTok{ T, }\DataTypeTok{quote =} \StringTok{""}\NormalTok{, }
                \DataTypeTok{comment.char =} \StringTok{""}\NormalTok{)}
\CommentTok{#reorder}
\NormalTok{covplot <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{nrow =} \KeywordTok{nrow}\NormalTok{(cov), }\DataTypeTok{ncol =} \KeywordTok{ncol}\NormalTok{(cov)))}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(pop.list))\{}
  \ControlFlowTok{for}\NormalTok{( j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(pop.list))\{}
    
\NormalTok{    covplot[i, j] =}\StringTok{ }\NormalTok{cov[}\KeywordTok{which}\NormalTok{(}\KeywordTok{names}\NormalTok{(cov)}\OperatorTok{==}\NormalTok{pop.list[i]), }\KeywordTok{which}\NormalTok{(}\KeywordTok{names}\NormalTok{(cov)}\OperatorTok{==}\NormalTok{pop.list[j])]}
    \KeywordTok{rownames}\NormalTok{(covplot)[i]<-pop.list[i]}
    \KeywordTok{colnames}\NormalTok{(covplot)[j]<-pop.list[j]}
\NormalTok{  \}}
\NormalTok{\}}
\NormalTok{covplot<-}\KeywordTok{as.matrix}\NormalTok{(covplot)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(xlsx); }\KeywordTok{library}\NormalTok{(RColorBrewer); }\KeywordTok{library}\NormalTok{(scales)}

\NormalTok{table2<-fst_mat}
\NormalTok{table2[}\KeywordTok{lower.tri}\NormalTok{(table2)]<-covplot[}\KeywordTok{lower.tri}\NormalTok{(covplot)]}
\KeywordTok{diag}\NormalTok{(table2)<-}\KeywordTok{diag}\NormalTok{(covplot)}
\NormalTok{table2<-}\KeywordTok{round}\NormalTok{(table2,}\DataTypeTok{digits =} \DecValTok{4}\NormalTok{)}

\CommentTok{# first export the data}
\NormalTok{sheetName <-}\StringTok{ "FstCov"}
\NormalTok{file<-}\StringTok{"table2_fst_cov.xlsx"}
\KeywordTok{write.xlsx}\NormalTok{(table2,file,}\DataTypeTok{sheetName =}\NormalTok{ sheetName)}

\NormalTok{wb<-}\KeywordTok{loadWorkbook}\NormalTok{(file)}
\NormalTok{sheets <-}\StringTok{ }\KeywordTok{getSheets}\NormalTok{(wb)               }
\NormalTok{sheet <-}\StringTok{ }\NormalTok{sheets[[sheetName]]          }
\NormalTok{rows <-}\StringTok{ }\KeywordTok{getRows}\NormalTok{(sheet, }\DataTypeTok{rowIndex=}\DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(table2)}\OperatorTok{+}\DecValTok{1}\NormalTok{)) }\CommentTok{# 1st row is headers}
\NormalTok{cells <-}\StringTok{ }\KeywordTok{getCells}\NormalTok{(rows, }\DataTypeTok{colIndex =} \DecValTok{2}\OperatorTok{:}\NormalTok{(}\KeywordTok{ncol}\NormalTok{(table2)}\OperatorTok{+}\DecValTok{1}\NormalTok{)) }\CommentTok{# 1st col is rownames         }
\NormalTok{values<-}\KeywordTok{lapply}\NormalTok{(cells,getCellValue)}

\CommentTok{# set the colors}
\NormalTok{pal<-}\KeywordTok{colorRampPalette}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"#deebf7"}\NormalTok{,}\StringTok{"#3182bd"}\NormalTok{))}
\NormalTok{cols<-}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{nrow =} \KeywordTok{nrow}\NormalTok{(table2),}\DataTypeTok{ncol=}\KeywordTok{nrow}\NormalTok{(table2))}
\NormalTok{cols[}\KeywordTok{upper.tri}\NormalTok{(cols)]<-}\KeywordTok{pal}\NormalTok{(}\DecValTok{10}\NormalTok{)[}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{cut}\NormalTok{(table2[}\KeywordTok{upper.tri}\NormalTok{(table2)],}\DataTypeTok{breaks =} \DecValTok{10}\NormalTok{))]}
\NormalTok{pal<-}\KeywordTok{colorRampPalette}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"#78c679"}\NormalTok{,}\StringTok{"#f7fcb9"}\NormalTok{))}
\NormalTok{cols[}\KeywordTok{lower.tri}\NormalTok{(cols)]<-}\KeywordTok{pal}\NormalTok{(}\DecValTok{10}\NormalTok{)[}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{cut}\NormalTok{(table2[}\KeywordTok{lower.tri}\NormalTok{(table2)],}\DataTypeTok{breaks =} \DecValTok{10}\NormalTok{))]}
\NormalTok{pal<-}\KeywordTok{colorRampPalette}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"#f7f7f7"}\NormalTok{,}\StringTok{"#969696"}\NormalTok{))}
\KeywordTok{diag}\NormalTok{(cols)<-}\KeywordTok{pal}\NormalTok{(}\DecValTok{10}\NormalTok{)[}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{cut}\NormalTok{(}\KeywordTok{diag}\NormalTok{(table2),}\DataTypeTok{breaks =} \DecValTok{10}\NormalTok{))]}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(table2))\{}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(table2))\{}
\NormalTok{    csij<-}\KeywordTok{CellStyle}\NormalTok{(wb,}\DataTypeTok{fill=}\KeywordTok{Fill}\NormalTok{(}\DataTypeTok{foregroundColor =} \KeywordTok{alpha}\NormalTok{(cols[i,j])))}
    \KeywordTok{setCellStyle}\NormalTok{(cells[[}\KeywordTok{paste}\NormalTok{(i}\OperatorTok{+}\DecValTok{1}\NormalTok{,j}\OperatorTok{+}\DecValTok{1}\NormalTok{,}\DataTypeTok{sep=}\StringTok{"."}\NormalTok{)]],}\DataTypeTok{cellStyle =}\NormalTok{ csij)}
\NormalTok{  \}}
\NormalTok{\}}

\KeywordTok{saveWorkbook}\NormalTok{(wb, file)}
\end{Highlighting}
\end{Shaded}

\section*{Fst Outliers}\label{fst-outliers}
\addcontentsline{toc}{section}{Fst Outliers}

The alignments were done with a preliminary genome assembly that is
different from the published, updated one. The data that I need to
convert are the vcf and the stacks files.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{convert.agp<-}\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{locus=}\OtherTok{NULL}\NormalTok{,old.agp,old.scf,new.agp,scf.agp,}
                      \DataTypeTok{chr=}\OtherTok{NULL}\NormalTok{,}\DataTypeTok{bp=}\OtherTok{NULL}\NormalTok{,}\DataTypeTok{id=}\OtherTok{NULL}\NormalTok{)\{}
  
  \ControlFlowTok{if}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.null}\NormalTok{(locus))\{}
\NormalTok{    chr<-locus}\OperatorTok{$}\StringTok{`}\DataTypeTok{#CHROM}\StringTok{`}
\NormalTok{    bp<-locus}\OperatorTok{$}\NormalTok{POS}
\NormalTok{    id<-locus}\OperatorTok{$}\NormalTok{ID}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{    bp<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(bp))}
\NormalTok{    chr<-}\KeywordTok{as.character}\NormalTok{(chr)}
\NormalTok{    id<-}\KeywordTok{as.character}\NormalTok{(id)}
\NormalTok{  \}}
\NormalTok{  component<-}\KeywordTok{as.data.frame}\NormalTok{(old.agp[old.agp}\OperatorTok{$}\NormalTok{object }\OperatorTok{==}\StringTok{ }\NormalTok{chr }\OperatorTok{&}\StringTok{ }
\StringTok{                                     }\NormalTok{old.agp}\OperatorTok{$}\NormalTok{object_beg }\OperatorTok{<=}\StringTok{ }\NormalTok{bp }\OperatorTok{&}\StringTok{ }
\StringTok{                                     }\NormalTok{old.agp}\OperatorTok{$}\NormalTok{object_end }\OperatorTok{>=}\StringTok{ }\NormalTok{bp,],}
                           \DataTypeTok{stringsAsFactors=}\OtherTok{FALSE}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(component)}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
    \CommentTok{# it's found on one of the LGs}
\NormalTok{    comp.id<-component}\OperatorTok{$}\NormalTok{component_id}
    \ControlFlowTok{if}\NormalTok{(comp.id }\OperatorTok{!=}\StringTok{ }\DecValTok{100}\NormalTok{)\{}
      \CommentTok{#make sure it's an actual scaffold as a component}
\NormalTok{      comp.bp<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(component}\OperatorTok{$}\NormalTok{component_beg))}\OperatorTok{+}
\StringTok{        }\NormalTok{(bp}\OperatorTok{-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(component}\OperatorTok{$}\NormalTok{object_beg)))}\OperatorTok{-}\DecValTok{1}
      \CommentTok{#sanity check - is it a reasonable size?}
      \ControlFlowTok{if}\NormalTok{(comp.bp}\OperatorTok{<}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(component}\OperatorTok{$}\NormalTok{component_end)))\{ }
\NormalTok{        updated<-new.agp[new.agp}\OperatorTok{$}\NormalTok{component_id}\OperatorTok{%in%}\NormalTok{comp.id }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(new.agp}\OperatorTok{$}\NormalTok{component_beg)) }\OperatorTok{<=}\NormalTok{comp.bp }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(new.agp}\OperatorTok{$}\NormalTok{component_end)) }\OperatorTok{>=}\StringTok{ }\NormalTok{comp.bp,]}
        \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(updated)}\OperatorTok{==}\DecValTok{0}\NormalTok{)\{ }\CommentTok{#if you didn't find it, check scaffold}
\NormalTok{          updated<-scf.agp[scf.agp}\OperatorTok{$}\NormalTok{object}\OperatorTok{%in%}\NormalTok{comp.id }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(scf.agp}\OperatorTok{$}\NormalTok{object_beg)) }\OperatorTok{<=}\NormalTok{comp.bp }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(scf.agp}\OperatorTok{$}\NormalTok{object_end)) }\OperatorTok{>=}\StringTok{ }\NormalTok{comp.bp,]}
\NormalTok{          updated.bp<-comp.bp}
\NormalTok{          updated.chr<-}\KeywordTok{as.character}\NormalTok{(comp.id)}
\NormalTok{        \} }\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{          updated.bp<-updated}\OperatorTok{$}\NormalTok{object_beg}\OperatorTok{+}\NormalTok{comp.bp}
\NormalTok{          updated.chr<-}\KeywordTok{as.character}\NormalTok{(updated}\OperatorTok{$}\NormalTok{object)  }
\NormalTok{        \}}
\NormalTok{      \}}\ControlFlowTok{else}\NormalTok{ \{}
        \KeywordTok{print}\NormalTok{(}\StringTok{"WARNING: position in component larger than component"}\NormalTok{)}
\NormalTok{        updated.bp<-comp.id}
\NormalTok{        updated.chr<-}\KeywordTok{as.character}\NormalTok{(comp.id)}
\NormalTok{      \}}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
      \KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"WARNING: locus "}\NormalTok{,id, }\StringTok{" is not on a scaffold"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{      updated.bp<-bp}
\NormalTok{      updated.chr<-}\OtherTok{NA}
\NormalTok{    \}}
\NormalTok{    out<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Locus=}\NormalTok{id,}\DataTypeTok{OrigChr=}\NormalTok{chr,}\DataTypeTok{OrigBP=}\NormalTok{bp,}
                    \DataTypeTok{NewChr=}\NormalTok{updated.chr,}\DataTypeTok{NewBP=}\NormalTok{updated.bp,}
                    \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{}
    \CommentTok{#it's not on an LG - let's check the scaffolds}
\NormalTok{    component<-}\KeywordTok{as.data.frame}\NormalTok{(old.scf[old.scf}\OperatorTok{$}\NormalTok{object }\OperatorTok{==}\StringTok{ }\NormalTok{chr }\OperatorTok{&}\StringTok{ }
\StringTok{                                       }\NormalTok{old.scf}\OperatorTok{$}\NormalTok{object_beg }\OperatorTok{<=}\StringTok{ }\NormalTok{bp }\OperatorTok{&}\StringTok{ }
\StringTok{                                       }\NormalTok{old.scf}\OperatorTok{$}\NormalTok{object_end }\OperatorTok{>=}\StringTok{ }\NormalTok{bp,],}
                             \DataTypeTok{stringsAsFactors=}\OtherTok{FALSE}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(component)}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
      \CommentTok{#then we found it}
      \CommentTok{#check to make sure my bp makes sense}
      \ControlFlowTok{if}\NormalTok{(bp }\OperatorTok{<}\StringTok{ }\KeywordTok{max}\NormalTok{(old.scf[old.scf}\OperatorTok{$}\NormalTok{object}\OperatorTok{==}\NormalTok{chr,}\StringTok{"object_end"}\NormalTok{]))\{}
\NormalTok{        comp.bp<-bp}
\NormalTok{        comp.id<-}\KeywordTok{as.character}\NormalTok{(chr)}
        \CommentTok{#look for it in the new assembly}
\NormalTok{        updated<-new.agp[new.agp}\OperatorTok{$}\NormalTok{component_id}\OperatorTok{%in%}\NormalTok{comp.id }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(new.agp}\OperatorTok{$}\NormalTok{component_beg)) }\OperatorTok{<=}\NormalTok{comp.bp }\OperatorTok{&}\StringTok{   }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(new.agp}\OperatorTok{$}\NormalTok{component_end)) }\OperatorTok{>=}\StringTok{ }\NormalTok{comp.bp,]}
        \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(updated)}\OperatorTok{==}\DecValTok{0}\NormalTok{)\{ }\CommentTok{#if you didn't find it, check scaffold}
\NormalTok{          updated<-scf.agp[scf.agp}\OperatorTok{$}\NormalTok{object}\OperatorTok{%in%}\NormalTok{comp.id }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(scf.agp}\OperatorTok{$}\NormalTok{object_beg)) }\OperatorTok{<=}\NormalTok{comp.bp }\OperatorTok{&}\StringTok{ }
\StringTok{                  }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(scf.agp}\OperatorTok{$}\NormalTok{object_end)) }\OperatorTok{>=}\StringTok{ }\NormalTok{comp.bp,]}
\NormalTok{          updated.bp<-comp.bp}
\NormalTok{          updated.chr<-}\KeywordTok{as.character}\NormalTok{(comp.id)}
\NormalTok{        \} }\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{          updated.bp<-updated}\OperatorTok{$}\NormalTok{object_beg}\OperatorTok{+}\NormalTok{comp.bp}
\NormalTok{          updated.chr<-}\KeywordTok{as.character}\NormalTok{(updated}\OperatorTok{$}\NormalTok{object)  }
\NormalTok{        \}}
\NormalTok{      \} }\ControlFlowTok{else}\NormalTok{ \{}
          \KeywordTok{print}\NormalTok{(}\StringTok{"WARNING: position in scaffold larger than scaffold"}\NormalTok{)}
\NormalTok{          updated.bp<-}\OtherTok{NA}
\NormalTok{          updated.chr<-}\OtherTok{NA}
\NormalTok{      \}}
\NormalTok{      out<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Locus=}\NormalTok{id,}\DataTypeTok{OrigChr=}\NormalTok{chr,}\DataTypeTok{OrigBP=}\NormalTok{bp,}
                      \DataTypeTok{NewChr=}\NormalTok{updated.chr,}\DataTypeTok{NewBP=}\NormalTok{updated.bp,}
                      \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{      out<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Locus=}\NormalTok{id,}\DataTypeTok{OrigChr=}\NormalTok{chr,}\DataTypeTok{OrigBP=}\NormalTok{bp,}
                      \DataTypeTok{NewChr=}\OtherTok{NA}\NormalTok{,}\DataTypeTok{NewBP=}\OtherTok{NA}\NormalTok{,}
                      \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
      \KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"WARNING: locus "}\NormalTok{, id, }\StringTok{" not found"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\NormalTok{    \}}
\NormalTok{  \}}
  
  \KeywordTok{return}\NormalTok{(out)}
\NormalTok{\}}
\NormalTok{convert.stacks<-}\ControlFlowTok{function}\NormalTok{(stacks.fst,outname,lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)\{}
\NormalTok{  stacks.fst}\OperatorTok{$}\NormalTok{Chr<-}\KeywordTok{as.character}\NormalTok{(stacks.fst}\OperatorTok{$}\NormalTok{Chr)}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(stacks.fst))\{}
\NormalTok{     convert<-}\KeywordTok{convert.agp}\NormalTok{(}\DataTypeTok{old.agp=}\NormalTok{ssc.agp,}\DataTypeTok{old.scf=}\NormalTok{sscf.agp,}
                          \DataTypeTok{new.agp=}\NormalTok{chr.agp[chr.agp}\OperatorTok{$}\NormalTok{W}\OperatorTok{==}\StringTok{"W"}\NormalTok{,],}\DataTypeTok{scf.agp =}\NormalTok{ scf.agp,}
                          \DataTypeTok{chr=}\KeywordTok{as.character}\NormalTok{(stacks.fst}\OperatorTok{$}\NormalTok{Chr[i]),}
                          \DataTypeTok{bp=}\NormalTok{stacks.fst}\OperatorTok{$}\NormalTok{BP[i],}\DataTypeTok{id=}\KeywordTok{as.character}\NormalTok{(stacks.fst}\OperatorTok{$}\NormalTok{Locus.ID[i]))}
\NormalTok{    stacks.fst[i,}\StringTok{"Chr"}\NormalTok{]<-}\KeywordTok{as.character}\NormalTok{(convert[}\StringTok{"NewChr"}\NormalTok{])}
\NormalTok{    stacks.fst[i,}\StringTok{"BP"}\NormalTok{]<-convert[}\StringTok{"NewBP"}\NormalTok{]}
\NormalTok{  \}}
  \CommentTok{# reorder by chrom}
\NormalTok{  scaffs<-}\KeywordTok{levels}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(stacks.fst}\OperatorTok{$}\NormalTok{Chr))}
\NormalTok{  scaffs[}\DecValTok{1}\OperatorTok{:}\DecValTok{22}\NormalTok{]<-lgs}
\NormalTok{  upd.fst<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(scaffs,}\ControlFlowTok{function}\NormalTok{(lg)\{}
\NormalTok{    this.chr<-stacks.fst[stacks.fst}\OperatorTok{$}\NormalTok{Chr}\OperatorTok{==}\NormalTok{lg,]}
\NormalTok{    this.chr<-this.chr[}\KeywordTok{order}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(this.chr}\OperatorTok{$}\NormalTok{BP)),]}
    \KeywordTok{return}\NormalTok{(this.chr)}
\NormalTok{  \}))}
  \KeywordTok{write.table}\NormalTok{(upd.fst,outname,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{)}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{by}\NormalTok{(upd.fst,upd.fst}\OperatorTok{$}\NormalTok{Chr,}\ControlFlowTok{function}\NormalTok{(chr)\{ }\KeywordTok{return}\NormalTok{(}\KeywordTok{max}\NormalTok{(chr}\OperatorTok{$}\NormalTok{BP)}\OperatorTok{/}\DecValTok{1000000}\NormalTok{) \})[lgs])}
  \KeywordTok{return}\NormalTok{(upd.fst)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# old agps}
\NormalTok{ssc.agp<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"../../scovelli_genome/SSC_genome.agp"}\NormalTok{,}
                    \DataTypeTok{comment.char=}\StringTok{"#"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(ssc.agp)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"object"}\NormalTok{,}\StringTok{"object_beg"}\NormalTok{,}\StringTok{"object_end"}\NormalTok{,}\StringTok{"part_number"}\NormalTok{,}\StringTok{"W"}\NormalTok{,}
                     \StringTok{"component_id"}\NormalTok{,}\StringTok{"component_beg"}\NormalTok{,}\StringTok{"component_end"}\NormalTok{,}\StringTok{"orientation"}\NormalTok{)}
\NormalTok{sscf.agp<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"../../scovelli_genome/SSC_scaffolds.agp"}\NormalTok{,}
                     \DataTypeTok{comment.char=}\StringTok{"#"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(sscf.agp)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"object"}\NormalTok{,}\StringTok{"object_beg"}\NormalTok{,}\StringTok{"object_end"}\NormalTok{,}\StringTok{"part_number"}\NormalTok{,}\StringTok{"W"}\NormalTok{,}
                      \StringTok{"component_id"}\NormalTok{,}\StringTok{"component_beg"}\NormalTok{,}\StringTok{"component_end"}\NormalTok{,}\StringTok{"orientation"}\NormalTok{)}
\CommentTok{# new scaffold and chrom level agps}
\NormalTok{scf.agp<-}\KeywordTok{read.delim}\NormalTok{(}\KeywordTok{gzfile}\NormalTok{(}\StringTok{"../../scovelli_genome/ssc_2016_12_20_scafflevel.agp.gz"}\NormalTok{),}
                    \DataTypeTok{comment.char=}\StringTok{"#"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{)}
\NormalTok{chr.agp<-}\KeywordTok{read.delim}\NormalTok{(}\KeywordTok{gzfile}\NormalTok{(}\StringTok{"../../scovelli_genome/ssc_2016_12_20_chromlevel.agp.gz"}\NormalTok{),}
                    \DataTypeTok{comment.char=}\StringTok{"#"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(scf.agp)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"object"}\NormalTok{,}\StringTok{"object_beg"}\NormalTok{,}\StringTok{"object_end"}\NormalTok{,}\StringTok{"part_number"}\NormalTok{,}\StringTok{"W"}\NormalTok{,}
                     \StringTok{"component_id"}\NormalTok{,}\StringTok{"component_beg"}\NormalTok{,}\StringTok{"component_end"}\NormalTok{,}\StringTok{"orientation"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(chr.agp)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"object"}\NormalTok{,}\StringTok{"object_beg"}\NormalTok{,}\StringTok{"object_end"}\NormalTok{,}\StringTok{"part_number"}\NormalTok{,}\StringTok{"W"}\NormalTok{,}
                     \StringTok{"component_id"}\NormalTok{,}\StringTok{"component_beg"}\NormalTok{,}\StringTok{"component_end"}\NormalTok{,}\StringTok{"orientation"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.pruned.vcf"}\NormalTok{)}
\NormalTok{converted<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Locus=}\KeywordTok{integer}\NormalTok{(),}\DataTypeTok{OrigChr=}\KeywordTok{character}\NormalTok{(),}\DataTypeTok{OrigBP=}\KeywordTok{integer}\NormalTok{(),}
                      \DataTypeTok{NewChr=}\KeywordTok{character}\NormalTok{(),}\DataTypeTok{NewBP=}\KeywordTok{integer}\NormalTok{(),}
                      \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(vcf))\{}
\NormalTok{  converted[i,]<-}\KeywordTok{convert.agp}\NormalTok{(}\DataTypeTok{locus=}\NormalTok{vcf[i,],}\DataTypeTok{old.agp=}\NormalTok{ssc.agp,}\DataTypeTok{old.scf=}\NormalTok{sscf.agp,}
                             \DataTypeTok{new.agp=}\NormalTok{chr.agp[chr.agp}\OperatorTok{$}\NormalTok{W}\OperatorTok{==}\StringTok{"W"}\NormalTok{,],}\DataTypeTok{scf.agp =}\NormalTok{ scf.agp)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lgs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"LG1"}\NormalTok{,}\StringTok{"LG2"}\NormalTok{,}\StringTok{"LG3"}\NormalTok{,}\StringTok{"LG4"}\NormalTok{,}\StringTok{"LG5"}\NormalTok{,}\StringTok{"LG6"}\NormalTok{,}\StringTok{"LG7"}\NormalTok{,}\StringTok{"LG8"}\NormalTok{,}\StringTok{"LG9"}\NormalTok{,}\StringTok{"LG10"}\NormalTok{,}\StringTok{"LG11"}\NormalTok{,}
    \StringTok{"LG12"}\NormalTok{,}\StringTok{"LG13"}\NormalTok{,}\StringTok{"LG14"}\NormalTok{,}\StringTok{"LG15"}\NormalTok{,}\StringTok{"LG16"}\NormalTok{,}\StringTok{"LG17"}\NormalTok{,}\StringTok{"LG18"}\NormalTok{,}\StringTok{"LG19"}\NormalTok{,}\StringTok{"LG20"}\NormalTok{,}\StringTok{"LG21"}\NormalTok{,}
    \StringTok{"LG22"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new.vcf<-}\KeywordTok{as.data.frame}\NormalTok{(vcf,}\DataTypeTok{stringsAsFactor=}\OtherTok{FALSE}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(vcf))\{}
\NormalTok{  new.vcf}\OperatorTok{$}\NormalTok{POS[i]<-converted}\OperatorTok{$}\NormalTok{NewBP[i]}
\NormalTok{  new.vcf}\OperatorTok{$}\StringTok{`}\DataTypeTok{#CHROM}\StringTok{`}\NormalTok{[i]<-}\KeywordTok{as.character}\NormalTok{(converted}\OperatorTok{$}\NormalTok{NewChr[i])}
\NormalTok{\}}
\KeywordTok{write.table}\NormalTok{(new.vcf,}\StringTok{"converted_subset.vcf"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}
            \DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{snps<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/pruned_snps.txt"}\NormalTok{)}

\NormalTok{fwsw.fl<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.fst_FLCC-FLFW.tsv"}\NormalTok{)}
\NormalTok{fwsw.tx<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.fst_TXCC-TXFW.tsv"}\NormalTok{)}
\NormalTok{fwsw.al<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.fst_ALFW-ALST.tsv"}\NormalTok{)}
\NormalTok{fwsw.la<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.fst_ALST-LAFW.tsv"}\NormalTok{)}


\NormalTok{fwsw.tx<-fwsw.tx[}\KeywordTok{paste}\NormalTok{(fwsw.tx}\OperatorTok{$}\NormalTok{Locus.ID,fwsw.tx}\OperatorTok{$}\NormalTok{BP) }\OperatorTok{%in%}\StringTok{ }\KeywordTok{paste}\NormalTok{(snps}\OperatorTok{$}\NormalTok{V1,snps}\OperatorTok{$}\NormalTok{V2),]}
\NormalTok{fwsw.fl<-fwsw.fl[}\KeywordTok{paste}\NormalTok{(fwsw.fl}\OperatorTok{$}\NormalTok{Locus.ID,fwsw.fl}\OperatorTok{$}\NormalTok{BP) }\OperatorTok{%in%}\StringTok{ }\KeywordTok{paste}\NormalTok{(snps}\OperatorTok{$}\NormalTok{V1,snps}\OperatorTok{$}\NormalTok{V2),]}
\NormalTok{fwsw.al<-fwsw.al[}\KeywordTok{paste}\NormalTok{(fwsw.al}\OperatorTok{$}\NormalTok{Locus.ID,fwsw.al}\OperatorTok{$}\NormalTok{BP) }\OperatorTok{%in%}\StringTok{ }\KeywordTok{paste}\NormalTok{(snps}\OperatorTok{$}\NormalTok{V1,snps}\OperatorTok{$}\NormalTok{V2),]}
\NormalTok{fwsw.la<-fwsw.la[}\KeywordTok{paste}\NormalTok{(fwsw.la}\OperatorTok{$}\NormalTok{Locus.ID,fwsw.la}\OperatorTok{$}\NormalTok{BP) }\OperatorTok{%in%}\StringTok{ }\KeywordTok{paste}\NormalTok{(snps}\OperatorTok{$}\NormalTok{V1,snps}\OperatorTok{$}\NormalTok{V2),]}


\NormalTok{upd.tx<-}\KeywordTok{convert.stacks}\NormalTok{(fwsw.tx,}\StringTok{"stacks/populations_subset75/converted.fst_TXCC-TXFW.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\NormalTok{upd.al<-}\KeywordTok{convert.stacks}\NormalTok{(fwsw.al,}\StringTok{"stacks/populations_subset75/converted.fst_ALFW-ALST.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\NormalTok{upd.la<-}\KeywordTok{convert.stacks}\NormalTok{(fwsw.al,}\StringTok{"stacks/populations_subset75/converted.fst_ALST-LAFW.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\NormalTok{upd.fl<-}\KeywordTok{convert.stacks}\NormalTok{(fwsw.fl,}\StringTok{"stacks/populations_subset75/converted.fst_FLCC-FLFW.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{swsw.fl<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_whitelist/batch_2.fst_FLCC-FLHB.tsv"}\NormalTok{)}
\NormalTok{swsw.tx<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_whitelist/batch_2.fst_TXCB-TXCC.tsv"}\NormalTok{)}
\NormalTok{swsw.al<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_whitelist/batch_2.fst_ALST-FLSG.tsv"}\NormalTok{)}

\NormalTok{upd.st<-}\KeywordTok{convert.stacks}\NormalTok{(swsw.tx,}\StringTok{"stacks/converted.fst_TXCB-TXCC.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\NormalTok{upd.sa<-}\KeywordTok{convert.stacks}\NormalTok{(swsw.al,}\StringTok{"stacks/converted.fst_ALST-FLSG.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\NormalTok{upd.sf<-}\KeywordTok{convert.stacks}\NormalTok{(swsw.fl,}\StringTok{"stacks/converted.fst_FLCC-FLHB.txt"}\NormalTok{,}
\NormalTok{                       lgs,ssc.agp,sscf.agp,chr.agp,scf.agp)}
\end{Highlighting}
\end{Shaded}

\subsection*{Stacks}\label{stacks}
\addcontentsline{toc}{subsection}{Stacks}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fwsw.al<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/converted.fst_ALFW-ALST.txt"}\NormalTok{)}
\NormalTok{fwsw.la<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/converted.fst_ALST-LAFW.txt"}\NormalTok{)}
\NormalTok{fwsw.tx<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/converted.fst_TXCC-TXFW.txt"}\NormalTok{)}
\NormalTok{fwsw.fl<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/converted.fst_FLCC-FLFW.txt"}\NormalTok{)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(fwsw.al),}\KeywordTok{nrow}\NormalTok{(fwsw.la),}\KeywordTok{nrow}\NormalTok{(fwsw.tx),}\KeywordTok{nrow}\NormalTok{(fwsw.fl)),}
      \DataTypeTok{col.names=}\KeywordTok{c}\NormalTok{(}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{),}
      \DataTypeTok{caption=}\StringTok{"The number of SNPs in each dataset"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:readStacksFsts}The number of SNPs in each dataset}
\centering
\begin{tabular}[t]{r|r|r|r}
\hline
Alabama & Louisiana & Texas & Florida\\
\hline
6918 & 6918 & 3687 & 2049\\
\hline
\end{tabular}
\end{table}

These datasets do not contain the full 12103 SNPs
(\ref{tab:readStacksFsts}) because some of those SNPs are fixed in the
populations or do not pass coverage or minimum allele frequency
thresholds.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/205_popgenPlotting.R"}\NormalTok{)}
\NormalTok{fst_dat<-}\KeywordTok{list}\NormalTok{(fwsw.al,fwsw.la,fwsw.tx,fwsw.fl)}
\NormalTok{fsts<-}\KeywordTok{plot_multiple_LGs}\NormalTok{(}\DataTypeTok{list_fsts =}\NormalTok{ fst_dat,}\DataTypeTok{fst_name =} \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{,}
                        \DataTypeTok{bp_name=}\StringTok{"BP"}\NormalTok{,}\DataTypeTok{chr_name=}\StringTok{"Chr"}\NormalTok{,}\DataTypeTok{lgs=}\NormalTok{lgs,}
                        \DataTypeTok{plot_labs=}\KeywordTok{list}\NormalTok{(}\StringTok{"ALFW vs ALST"}\NormalTok{,}\StringTok{"ALST vs LAFW"}\NormalTok{,}
                                       \StringTok{"TXFW vs TXCC"}\NormalTok{,}\StringTok{"FLFW vs FLCC"}\NormalTok{),}
                        \DataTypeTok{pt_cols =} \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{3}\NormalTok{],grp.colors[}\DecValTok{2}\NormalTok{]),}
                                       \KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{2}\NormalTok{],grp.colors[}\DecValTok{3}\NormalTok{]),}
                                       \KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{1}\NormalTok{],grp.colors[}\DecValTok{2}\NormalTok{]),}
                                       \KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{6}\NormalTok{],grp.colors[}\DecValTok{5}\NormalTok{])),}
                        \DataTypeTok{ncol=}\DecValTok{1}\NormalTok{,}\DataTypeTok{addSmooth =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{y.lim =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}
                        \DataTypeTok{pt.cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotStacksFsts-1} \caption{Manhattan plot of pairwise AMOVA-corrected Fst values from Stacks for each freshwater - nearest saltwater population pair. The x-axis corresponds to genomic locations, with chromosomes labelled. To the right are loci that mapped to unanchored scaffolds.}\label{fig:plotStacksFsts}
\end{figure}

So this generated a plot for each pairwise comparison. We could look for
shared outliers and see if we can find anything.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tx.sig<-fwsw.tx[fwsw.tx}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{la.sig<-fwsw.la[fwsw.la}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{al.sig<-fwsw.al[fwsw.al}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{fl.sig<-fwsw.fl[fwsw.fl}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\KeywordTok{length}\NormalTok{(tx.sig[(tx.sig }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(la.sig,al.sig,fl.sig))])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 84
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{length}\NormalTok{(la.sig[(la.sig }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(tx.sig,al.sig,fl.sig))])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 189
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{length}\NormalTok{(al.sig[(al.sig }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(la.sig,tx.sig,fl.sig))])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 189
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all.shared<-fl.sig[fl.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{la.sig }\OperatorTok{&}\StringTok{ }\NormalTok{fl.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{al.sig }\OperatorTok{&}\StringTok{ }\NormalTok{fl.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{tx.sig]}

\NormalTok{gulf_shared<-tx.sig[tx.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{la.sig }\OperatorTok{&}\StringTok{ }\NormalTok{tx.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{al.sig]}
\end{Highlighting}
\end{Shaded}

There are 10 outliers (as determined by Fisher's P from stacks
\textless{} 0.01). But because of the large pairwise Fsts between the
Florida populations, we'll focus on the shared SNPs in the Texas,
Alabama, and Louisiana analyeses, in which we have 46

As a point of comparison, we can repeat this with the similar pairwise
saltwater-saltwater \(F_{ST}\) comparisons.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{swsw.fl<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/converted.fst_TXCB-TXCC.txt"}\NormalTok{)}
\NormalTok{swsw.tx<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/converted.fst_ALST-FLSG.txt"}\NormalTok{)}
\NormalTok{swsw.al<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/converted.fst_FLCC-FLHB.txt"}\NormalTok{)}
\NormalTok{fst_dat<-}\KeywordTok{list}\NormalTok{(swsw.fl,swsw.tx,swsw.al)}
\NormalTok{fsts<-}\KeywordTok{plot_multiple_LGs}\NormalTok{(}\DataTypeTok{list_fsts =}\NormalTok{ fst_dat,}\DataTypeTok{fst_name =} \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{,}
                        \DataTypeTok{bp_name=}\StringTok{"BP"}\NormalTok{,}\DataTypeTok{chr_name=}\StringTok{"Chr"}\NormalTok{,}\DataTypeTok{lgs=}\NormalTok{lgs,}
                        \DataTypeTok{plot_labs=}\KeywordTok{list}\NormalTok{(}\StringTok{"TXSP vs TXCC"}\NormalTok{,}\StringTok{"ALST vs FLSG"}\NormalTok{,}\StringTok{"FLHB vs FLCC"}\NormalTok{),}
                        \DataTypeTok{pt_cols =} \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{1}\NormalTok{],grp.colors[}\DecValTok{2}\NormalTok{]),}
                                       \KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{2}\NormalTok{],grp.colors[}\DecValTok{3}\NormalTok{]),}
                                       \KeywordTok{c}\NormalTok{(grp.colors[}\DecValTok{6}\NormalTok{],grp.colors[}\DecValTok{5}\NormalTok{])),}
                        \DataTypeTok{ncol=}\DecValTok{1}\NormalTok{,}\DataTypeTok{addSmooth =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{y.lim =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}
                        \DataTypeTok{pt.cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotStacksFstsSWSW-1} \caption{Manhattan plot of pairwise AMOVA-corrected Fst values from Stacks for the saltwater populations nearest to freshwater populations compared to their nearest saltwater neightbor. The x-axis corresponds to genomic locations, with chromosomes labelled. To the right are loci that mapped to unanchored scaffolds.}\label{fig:plotStacksFstsSWSW}
\end{figure}

So this generated a plot for each pairwise comparison. We could look for
shared outliers and see if we can find anything.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tx.sig<-swsw.tx[swsw.tx}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{al.sig<-swsw.al[swsw.al}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{fl.sig<-swsw.fl[swsw.fl}\OperatorTok{$}\NormalTok{Fisher.s.P}\OperatorTok{<}\FloatTok{0.01}\NormalTok{,}\StringTok{"Locus.ID"}\NormalTok{]}
\NormalTok{all.shared<-fl.sig[fl.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{al.sig }\OperatorTok{&}\StringTok{ }\NormalTok{fl.sig }\OperatorTok{%in%}\StringTok{ }\NormalTok{tx.sig]}
\end{Highlighting}
\end{Shaded}

There are 1 outliers (as determined by Fisher's P from stacks
\textless{} 0.01).

\subsection*{Permutations}\label{permutations}
\addcontentsline{toc}{subsection}{Permutations}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{permute.gwsca<-}\ControlFlowTok{function}\NormalTok{(vcf,map1,nperms,}\DataTypeTok{z=}\FloatTok{1.96}\NormalTok{, }\DataTypeTok{maf.cutoff =} \FloatTok{0.05}\NormalTok{,}\DataTypeTok{cov.thresh=}\FloatTok{0.2}\NormalTok{)\{}
  \CommentTok{# calculate the actuals}
\NormalTok{  actual_fsts<-}\KeywordTok{gwsca}\NormalTok{(vcf,}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{],}
\NormalTok{                     map1[map1[,}\DecValTok{2}\NormalTok{] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unique}\NormalTok{(map1[,}\DecValTok{2}\NormalTok{])[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{],}
\NormalTok{                     map1[map1[,}\DecValTok{2}\NormalTok{] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unique}\NormalTok{(map1[,}\DecValTok{2}\NormalTok{])[}\DecValTok{2}\NormalTok{],}\DecValTok{1}\NormalTok{],}
                     \DataTypeTok{maf.cutoff=}\NormalTok{maf.cutoff,}\DataTypeTok{prop.ind.thresh=}\NormalTok{cov.thresh)}
  \CommentTok{# do the permutations}
\NormalTok{  perm_fsts<-}\KeywordTok{lapply}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{nperms,}\ControlFlowTok{function}\NormalTok{(i,vcf,map1)\{}
\NormalTok{    perm_map<-map1}
\NormalTok{    perm_map[,}\DecValTok{2}\NormalTok{]<-perm_map[,}\DecValTok{2}\NormalTok{][permute}\OperatorTok{::}\KeywordTok{shuffle}\NormalTok{(perm_map[,}\DecValTok{2}\NormalTok{])]}
\NormalTok{    perm_dat<-}\KeywordTok{gwsca}\NormalTok{(vcf,}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{1}\OperatorTok{:}\DecValTok{9}\NormalTok{],}
\NormalTok{                     perm_map[perm_map[,}\DecValTok{2}\NormalTok{] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unique}\NormalTok{(perm_map[,}\DecValTok{2}\NormalTok{])[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{],}
\NormalTok{                     perm_map[perm_map[,}\DecValTok{2}\NormalTok{] }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unique}\NormalTok{(perm_map[,}\DecValTok{2}\NormalTok{])[}\DecValTok{2}\NormalTok{],}\DecValTok{1}\NormalTok{],}
\NormalTok{                     maf.cutoff,cov.thresh)}
   
    \KeywordTok{return}\NormalTok{(perm_dat)}
\NormalTok{  \},}\DataTypeTok{vcf=}\NormalTok{vcf,}\DataTypeTok{map1=}\NormalTok{map1)}
  
  \CommentTok{# calculate stats}
\NormalTok{  fsts<-}\KeywordTok{t}\NormalTok{(}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(perm_fsts,}\StringTok{'[['}\NormalTok{,}\StringTok{"Fst"}\NormalTok{))) }\CommentTok{#extract permuted fsts}
\NormalTok{  perm_fst_mu<-}\KeywordTok{rowMeans}\NormalTok{(fsts)}
\NormalTok{  perm_fst_in<-}\OtherTok{NULL}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(actual_fsts))\{}
\NormalTok{    pmax<-}\KeywordTok{max}\NormalTok{(fsts[i,] )}
\NormalTok{    pmin<-}\KeywordTok{min}\NormalTok{(fsts[i,] )}
    \ControlFlowTok{if}\NormalTok{(actual_fsts[i,}\StringTok{"Fst"}\NormalTok{] }\OperatorTok{>}\StringTok{ }\NormalTok{pmax }\OperatorTok{|}\StringTok{ }\NormalTok{actual_fsts[i,}\StringTok{"Fst"}\NormalTok{] }\OperatorTok{<}\StringTok{ }\NormalTok{pmin )\{}
\NormalTok{      perm_fst_in[i]<-}\DecValTok{1}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{      perm_fst_in[i]<-}\DecValTok{0}
\NormalTok{    \}}
\NormalTok{  \}}
  
\NormalTok{  fst_dat<-}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(actual_fsts,}
                            \DataTypeTok{n_perms=}\NormalTok{nperms,}
                            \DataTypeTok{mean_perm=}\NormalTok{perm_fst_mu,}
                            \DataTypeTok{act_in_perm=}\NormalTok{perm_fst_in))}
  \KeywordTok{return}\NormalTok{(fst_dat)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"converted_subset.vcf"}\NormalTok{)}
\NormalTok{popmap<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{inds=}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{10}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(vcf)],}
                   \DataTypeTok{pops=}\KeywordTok{gsub}\NormalTok{(}\StringTok{"sample_(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\}).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{10}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(vcf)]),}
                   \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{pwise_maps<-}\KeywordTok{list}\NormalTok{(popmap[popmap}\OperatorTok{$}\NormalTok{pops }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{),],}
\NormalTok{                 popmap[popmap}\OperatorTok{$}\NormalTok{pops }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FLLG"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{),],}
\NormalTok{                 popmap[popmap}\OperatorTok{$}\NormalTok{pops }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{),],}
\NormalTok{                 popmap[popmap}\OperatorTok{$}\NormalTok{pops }\OperatorTok{%in%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{),])}

\NormalTok{permuted_fsts<-}\KeywordTok{lapply}\NormalTok{(pwise_maps,permute.gwsca,}\DataTypeTok{vcf=}\NormalTok{vcf,}\DataTypeTok{nperms=}\DecValTok{1000}\NormalTok{, }\DataTypeTok{maf.cutoff=}\DecValTok{0}\NormalTok{)}
\KeywordTok{saveRDS}\NormalTok{(permuted_fsts,}\StringTok{"permuted_fsts.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now let's visualize it.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot_fst_hists<-}\ControlFlowTok{function}\NormalTok{(perms,}\DataTypeTok{plot_lab=}\OtherTok{NULL}\NormalTok{,}\DataTypeTok{cols=}\OtherTok{NULL}\NormalTok{,}\DataTypeTok{permlab=}\StringTok{"mean_perm"}\NormalTok{,}
                         \DataTypeTok{reallab=}\StringTok{"Fst"}\NormalTok{,}\DataTypeTok{baseplot=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{inset=}\OtherTok{NULL}\NormalTok{)\{}
  \KeywordTok{require}\NormalTok{(scales)}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{is.null}\NormalTok{(plot_lab))\{}
\NormalTok{    plot_lab<-}\StringTok{""}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{is.null}\NormalTok{(cols))\{}
\NormalTok{    cols<-}\KeywordTok{c}\NormalTok{(}\StringTok{"grey"}\NormalTok{,}\StringTok{"black"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(cols)}\OperatorTok{==}\DecValTok{1}\NormalTok{)\{}
\NormalTok{    cols<-}\KeywordTok{c}\NormalTok{(}\StringTok{"dark grey"}\NormalTok{,cols)}
\NormalTok{  \}}
  \CommentTok{#inset<-par()$fig}
  \CommentTok{#browser()}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{isTRUE}\NormalTok{(baseplot))\{}
    \KeywordTok{hist}\NormalTok{(perms[,permlab],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{1}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{border =} \KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{1}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.1}\NormalTok{),}\DataTypeTok{main =}\NormalTok{ plot_lab,}
         \DataTypeTok{xlab=}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(F)[ST]),}
         \DataTypeTok{ylab=}\StringTok{"Number of SNPs"}\NormalTok{)}
    \KeywordTok{hist}\NormalTok{(perms[,reallab],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{2}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}\DataTypeTok{border =} \KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{2}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.1}\NormalTok{),}\DataTypeTok{main =} \StringTok{""}\NormalTok{,}
         \DataTypeTok{xlab=}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(F)[ST]),}
         \DataTypeTok{ylab=}\StringTok{"Number of SNPs"}\NormalTok{,}\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.null}\NormalTok{(inset))\{ }\CommentTok{# add an inset}
    \CommentTok{# adjust the fig coordinates}
\NormalTok{    ifig<-}\KeywordTok{c}\NormalTok{(inset[}\DecValTok{1}\NormalTok{]}\OperatorTok{+}\FloatTok{0.25}\OperatorTok{*}\NormalTok{(inset[}\DecValTok{2}\NormalTok{]}\OperatorTok{-}\NormalTok{inset[}\DecValTok{1}\NormalTok{]),inset[}\DecValTok{2}\NormalTok{], }
\NormalTok{            inset[}\DecValTok{3}\NormalTok{]}\OperatorTok{+}\FloatTok{0.25}\OperatorTok{*}\NormalTok{(inset[}\DecValTok{4}\NormalTok{]}\OperatorTok{-}\NormalTok{inset[}\DecValTok{3}\NormalTok{]), inset[}\DecValTok{4}\NormalTok{])}
    \KeywordTok{par}\NormalTok{(}\DataTypeTok{fig =}\NormalTok{ ifig,}\DataTypeTok{new=}\OtherTok{TRUE}\NormalTok{) }\CommentTok{# start x, end x, start y, end y (percent plotting space)}
    \KeywordTok{hist}\NormalTok{(perms[,permlab][perms[,reallab]}\OperatorTok{>}\DecValTok{0}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{1}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{border =} \KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{1}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.1}\NormalTok{),}\DataTypeTok{main =} \StringTok{""}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}
         \DataTypeTok{ylab=}\StringTok{""}\NormalTok{)}
    \KeywordTok{box}\NormalTok{() }\CommentTok{#give it a box}
    \KeywordTok{hist}\NormalTok{(perms[,reallab,][perms[,reallab]}\OperatorTok{>}\DecValTok{0}\NormalTok{],}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{2}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{border =} \KeywordTok{alpha}\NormalTok{(cols[}\DecValTok{2}\NormalTok{],}\FloatTok{0.5}\NormalTok{),}
         \DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.1}\NormalTok{),}\DataTypeTok{main =} \StringTok{""}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{""}\NormalTok{,}
         \DataTypeTok{ylab=}\StringTok{""}\NormalTok{,}\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{  \}}
  \KeywordTok{invisible}\NormalTok{(}\KeywordTok{par}\NormalTok{()}\OperatorTok{$}\NormalTok{fig)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot_labs<-}\KeywordTok{list}\NormalTok{(}\StringTok{"TXFW vs TXCC"}\NormalTok{,}\StringTok{"FLFW vs FLCC"}\NormalTok{,}\StringTok{"ALFW vs ALST"}\NormalTok{,}\StringTok{"ALST vs LAFW"}\NormalTok{)}
\NormalTok{pt_cols<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{TXTX=}\NormalTok{grp.colors[}\DecValTok{1}\NormalTok{],}\DataTypeTok{FLFL=}\NormalTok{grp.colors[}\DecValTok{6}\NormalTok{],}
              \DataTypeTok{ALAL=}\NormalTok{grp.colors[}\DecValTok{3}\NormalTok{],}\DataTypeTok{ALLA=}\NormalTok{grp.colors[}\DecValTok{2}\NormalTok{])}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/permuted_fsts.png"}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{16}\NormalTok{,}\DataTypeTok{height=}\DecValTok{7}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{new=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\CommentTok{#plot the base}
\NormalTok{pars<-}\KeywordTok{mapply}\NormalTok{(plot_fst_hists,}\DataTypeTok{perms=}\NormalTok{permuted_fsts,}\DataTypeTok{plot_lab=}\NormalTok{plot_labs,}
             \DataTypeTok{cols=}\NormalTok{pt_cols,}\DataTypeTok{SIMPLIFY =} \OtherTok{FALSE}\NormalTok{)}
\CommentTok{# add the insets}
\NormalTok{ipars<-}\KeywordTok{mapply}\NormalTok{(plot_fst_hists,}\DataTypeTok{perms=}\NormalTok{permuted_fsts,}\DataTypeTok{plot_lab=}\NormalTok{plot_labs,}\DataTypeTok{cols=}\NormalTok{pt_cols,}
              \DataTypeTok{inset=}\NormalTok{pars,}
              \DataTypeTok{MoreArgs =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{baseplot=}\OtherTok{FALSE}\NormalTok{))}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{../figs/permuted_fsts.png}
\caption{Histograms of pairwise Fst values generated by the
permutations. The inset in each shows the same data but with a smaller
range on the y-axis to provide an imporved visualisation.}
\end{figure}

Now let's start to aggregate everything.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{permuted_fsts<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"permuted_fsts.RDS"}\NormalTok{)}

\NormalTok{perm_dat<-}\KeywordTok{do.call}\NormalTok{(cbind,permuted_fsts)}
\KeywordTok{colnames}\NormalTok{(perm_dat)[}\KeywordTok{colnames}\NormalTok{(perm_dat) }\OperatorTok{%in%}\StringTok{ "act_in_perm"}\NormalTok{]<-}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)}
\NormalTok{perm_dat<-perm_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"Pos"}\NormalTok{,}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)]}
\NormalTok{perm_dat}\OperatorTok{$}\NormalTok{Pos<-}\KeywordTok{as.numeric}\NormalTok{(perm_dat}\OperatorTok{$}\NormalTok{Pos)}

\NormalTok{vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"converted_subset.vcf"}\NormalTok{)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{ID=}\NormalTok{vcf}\OperatorTok{$}\NormalTok{ID,}\DataTypeTok{Chrom=}\NormalTok{vcf}\OperatorTok{$}\StringTok{`}\DataTypeTok{#CHROM}\StringTok{`}\NormalTok{,}\DataTypeTok{Pos=}\NormalTok{vcf}\OperatorTok{$}\NormalTok{POS,}\DataTypeTok{BP=}\NormalTok{vcf}\OperatorTok{$}\NormalTok{POS}\DecValTok{-1}\NormalTok{,}
                       \DataTypeTok{REF=}\NormalTok{vcf}\OperatorTok{$}\NormalTok{REF,}\DataTypeTok{ALT=}\NormalTok{vcf}\OperatorTok{$}\NormalTok{ALT,}
                       \DataTypeTok{perm_TX=}\NormalTok{permuted_fsts[[}\DecValTok{1}\NormalTok{]]}\OperatorTok{$}\NormalTok{act_in_perm,}
                       \DataTypeTok{perm_FL=}\NormalTok{permuted_fsts[[}\DecValTok{2}\NormalTok{]]}\OperatorTok{$}\NormalTok{act_in_perm,}
                       \DataTypeTok{perm_AL=}\NormalTok{permuted_fsts[[}\DecValTok{3}\NormalTok{]]}\OperatorTok{$}\NormalTok{act_in_perm,}
                       \DataTypeTok{perm_LA=}\NormalTok{permuted_fsts[[}\DecValTok{4}\NormalTok{]]}\OperatorTok{$}\NormalTok{act_in_perm,}
                       \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# add Fsts}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.al,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}
                                               \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_AL"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.la,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}
                                               \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_LA"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.tx,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}
                                               \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_TX"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.fl,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}
                                               \StringTok{"Corrected.AMOVA.Fst"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_FL"}
\CommentTok{# add p-values}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.al,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}\StringTok{"Fisher.s.P"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_AL_P"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.la,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}\StringTok{"Fisher.s.P"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_LA_P"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.tx,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}\StringTok{"Fisher.s.P"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_TX_P"}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,fwsw.fl,}\DataTypeTok{by.x=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}\DataTypeTok{by.y=}\KeywordTok{c}\NormalTok{(}\StringTok{"Chr"}\NormalTok{,}\StringTok{"BP"}\NormalTok{),}
                  \DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{,}\DataTypeTok{all.y =} \OtherTok{FALSE}\NormalTok{)[,}\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo),}\StringTok{"Fisher.s.P"}\NormalTok{)] }
\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{ncol}\NormalTok{(fw_SNPinfo)]<-}\StringTok{"stacks_FL_P"}
\KeywordTok{saveRDS}\NormalTok{(fw_SNPinfo,}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Fst plot}\label{fst-plot}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(UpSetR);}\KeywordTok{library}\NormalTok{(scales);}\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(grid);}\KeywordTok{library}\NormalTok{(gwscaR);}\KeywordTok{library}\NormalTok{(gridGraphics)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/upset_hacked.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/205_popgenPlotting.R"}\NormalTok{)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Then we'll plot the Stacks Fst outliers.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop.list<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
    \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)}
\NormalTok{pop.labs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
            \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLFW"}\NormalTok{)}
\NormalTok{lgs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"LG1"}\NormalTok{,}\StringTok{"LG2"}\NormalTok{,}\StringTok{"LG3"}\NormalTok{,}\StringTok{"LG4"}\NormalTok{,}\StringTok{"LG5"}\NormalTok{,}\StringTok{"LG6"}\NormalTok{,}\StringTok{"LG7"}\NormalTok{,}\StringTok{"LG8"}\NormalTok{,}\StringTok{"LG9"}\NormalTok{,}\StringTok{"LG10"}\NormalTok{,}\StringTok{"LG11"}\NormalTok{,}
    \StringTok{"LG12"}\NormalTok{,}\StringTok{"LG13"}\NormalTok{,}\StringTok{"LG14"}\NormalTok{,}\StringTok{"LG15"}\NormalTok{,}\StringTok{"LG16"}\NormalTok{,}\StringTok{"LG17"}\NormalTok{,}\StringTok{"LG18"}\NormalTok{,}\StringTok{"LG19"}\NormalTok{,}\StringTok{"LG20"}\NormalTok{,}\StringTok{"LG21"}\NormalTok{,}
    \StringTok{"LG22"}\NormalTok{)}
\NormalTok{lgn<-}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{22}\NormalTok{)}
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{perm=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#e41a1c'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{sal=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#377eb8'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pc=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#a65628'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}
        \DataTypeTok{stacks=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#f781bf'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{xtx=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#ff7f00'}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\NormalTok{grp7colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#9970ab'}\NormalTok{,}\StringTok{'#c2a5cf'}\NormalTok{,}\StringTok{'#d9f0d3'}\NormalTok{,}\StringTok{'#a6dba0'}\NormalTok{,}\StringTok{'#5aae61'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/FstOutliers_NoBayenv.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\FloatTok{8.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{pointsize=}\DecValTok{20}\NormalTok{)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\CommentTok{# plot TX}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_TX"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}
                   \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{1}\NormalTok{],grp7colors[}\DecValTok{2}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{2}\NormalTok{)}
\CommentTok{#points(plot_dat$plot.pos[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#       plot_dat$stacks_TX[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#       col=cols["sal"],cex=1,pch=2)}
\CommentTok{#points(plot_dat$plot.pos[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#       plot_dat$stacks_TX[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#       col=cols["xtx"],cex=1,pch=3,lwd=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\CommentTok{#points(plot_dat$plot.pos[plot_dat$pcadaptQ<0.01],}
\CommentTok{#       plot_dat$stacks_TX[plot_dat$pcadaptQ<0.01],}
\CommentTok{#       col=cols["pc"],cex=1,pch=0,lwd=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{ )],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{8}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}

\CommentTok{# plot AL}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_AL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}
                   \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{3}\NormalTok{],}\StringTok{"lightgrey"}\NormalTok{),}\DataTypeTok{pt.cex =} \DecValTok{2}\NormalTok{)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        plot_dat$stacks_AL[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        col=cols["xtx"],cex=1,pch=3,lwd=2)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        plot_dat$stacks_AL[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        col=cols["sal"],cex=1,pch=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        plot_dat$stacks_AL[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        col=cols["pc"],cex=1,pch=0,lwd=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{8}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Alabama"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}

\CommentTok{# plot LA}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_LA"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}
                   \DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(}\StringTok{"lightgrey"}\NormalTok{,grp7colors[}\DecValTok{3}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{2}\NormalTok{)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        plot_dat$stacks_LA[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        col=cols["sal"],cex=1,pch=2)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        plot_dat$stacks_LA[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        col=cols["xtx"],cex=1,pch=3,lwd=2)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        plot_dat$stacks_LA[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        col=cols["pc"],cex=1,pch=0,lwd=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}

\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{ )],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{8}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Louisiana"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}


\CommentTok{# FL}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_FL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}
                   \DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{6}\NormalTok{],grp7colors[}\DecValTok{7}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{2}\NormalTok{)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        plot_dat$stacks_FL[plot_dat$logSalBF>=quantile(plot_dat$logSalBF,0.99)],}
\CommentTok{#        col=cols["sal"],cex=1,pch=2)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        plot_dat$stacks_FL[plot_dat$XtX>=quantile(plot_dat$XtX,0.99)],}
\CommentTok{#        col=cols["xtx"],cex=1,pch=3,lwd=2)}
\CommentTok{# points(plot_dat$plot.pos[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        plot_dat$stacks_FL[plot_dat$pcadaptQ<0.01],}
\CommentTok{#        col=cols["pc"],cex=1,pch=0,lwd=2)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{3}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{8}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{3}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{,}\DataTypeTok{cex.axis=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"Florida"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\FloatTok{1.2}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{)}

\CommentTok{# add outside legend}

\NormalTok{opar <-}\StringTok{ }\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),}
            \DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{on.exit}\NormalTok{(}\KeywordTok{par}\NormalTok{(opar))}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{xaxt=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{yaxt=}\StringTok{'n'}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}
       \KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\StringTok{"Permutation"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{]),}
         \KeywordTok{expression}\NormalTok{(}\StringTok{"Stacks"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{])}
         \CommentTok{#"PCAdapt",expression(italic("X")^T~italic("X")),"Salinity BF"}
\NormalTok{         ),}
       \CommentTok{#xjust = 0.5,x.intersp = 0.5,}
       \DataTypeTok{col =}\NormalTok{ cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{)],}
       \DataTypeTok{pt.bg=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{)],}
       \CommentTok{#pch=c(4,5,0,3,2),}
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{8}\NormalTok{),}\DataTypeTok{pt.lwd =}\DecValTok{2}\NormalTok{,}\DataTypeTok{pt.cex=}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}
       \DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{2}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{outliers<-}\KeywordTok{list}\NormalTok{( }\DataTypeTok{permutations=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}
                 \KeywordTok{rowSums}\NormalTok{(fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
               
               \DataTypeTok{Alabama=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)], }
               \DataTypeTok{Louisiana=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Texas=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Florida=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{sharedStacks=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                                  }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                 }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)])}
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{permutations=}\StringTok{'#e41a1c'}\NormalTok{,}\DataTypeTok{salBF=}\StringTok{'#377eb8'}\NormalTok{,}\DataTypeTok{pcadapt=}\StringTok{'#a65628'}\NormalTok{,}
        \DataTypeTok{xtx=}\StringTok{'#ff7f00'}\NormalTok{,}\DataTypeTok{sharedStacks=}\StringTok{'#f781bf'}\NormalTok{,}
        \DataTypeTok{Alabama=}\StringTok{'#af8dc3'}\NormalTok{,}\DataTypeTok{Louisiana=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{Texas=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{Florida=}\StringTok{'#1b7837'}\NormalTok{)}

\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/sharedStacks.png"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\FloatTok{7.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{20}\NormalTok{)}
\KeywordTok{upset}\NormalTok{(}\KeywordTok{fromList}\NormalTok{(outliers),}\DataTypeTok{sets=}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{),}
      \DataTypeTok{point.size=}\DecValTok{7}\NormalTok{,}\DataTypeTok{line.size=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mainbar.y.label =} \StringTok{"Shared Stacks Outliers"}\NormalTok{,}
      \DataTypeTok{sets.x.label =} \StringTok{"# Outliers"}\NormalTok{,}\DataTypeTok{text.scale=}\KeywordTok{rep}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{),}
      \DataTypeTok{sets.bar.color =}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{)],}
      \DataTypeTok{margin1scale =} \FloatTok{0.2}\NormalTok{,}
      \DataTypeTok{sets.pt.color=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{)],}
      \DataTypeTok{keep.order =} \OtherTok{TRUE}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## png 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outliers<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{permutations=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}
                 \KeywordTok{rowSums}\NormalTok{(fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
               \DataTypeTok{Alabama=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{perm_AL}\OperatorTok{==}\DecValTok{1}\NormalTok{)], }
               \DataTypeTok{Louisiana=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{perm_LA }\OperatorTok{==}\DecValTok{1}\NormalTok{)],}
               \DataTypeTok{Texas=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{perm_TX}\OperatorTok{==}\DecValTok{1}\NormalTok{)],}
               \DataTypeTok{Florida=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{perm_FL}\OperatorTok{==}\DecValTok{1}\NormalTok{)],}
               \DataTypeTok{sharedStacks=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                                  }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                                                  }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)])}
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{permutations=}\StringTok{'#e41a1c'}\NormalTok{,}\DataTypeTok{salBF=}\StringTok{'#377eb8'}\NormalTok{,}\DataTypeTok{pcadapt=}\StringTok{'#a65628'}\NormalTok{,}
        \DataTypeTok{xtx=}\StringTok{'#ff7f00'}\NormalTok{,}\DataTypeTok{sharedStacks=}\StringTok{'#f781bf'}\NormalTok{,}
        \DataTypeTok{Alabama=}\StringTok{'#af8dc3'}\NormalTok{,}\DataTypeTok{Louisiana=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{Texas=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{Florida=}\StringTok{'#1b7837'}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/sharedPerms.png"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\FloatTok{8.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{20}\NormalTok{)}
\KeywordTok{upset}\NormalTok{(}\KeywordTok{fromList}\NormalTok{(outliers),}\DataTypeTok{sets=}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{),}
      \DataTypeTok{point.size=}\DecValTok{7}\NormalTok{,}\DataTypeTok{line.size=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mainbar.y.label =} \StringTok{"Shared Permutation Outliers"}\NormalTok{,}
      \DataTypeTok{sets.x.label =} \StringTok{"# Outliers"}\NormalTok{,}\DataTypeTok{text.scale=}\KeywordTok{rep}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{),}
      \DataTypeTok{sets.bar.color =}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{)],}
      \DataTypeTok{margin1scale =} \FloatTok{0.2}\NormalTok{,}
      \DataTypeTok{sets.pt.color=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"Texas"}\NormalTok{,}\StringTok{"Alabama"}\NormalTok{,}\StringTok{"Louisiana"}\NormalTok{,}\StringTok{"Florida"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{)],}
      \DataTypeTok{keep.order =} \OtherTok{TRUE}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## png 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(magick);}\KeywordTok{library}\NormalTok{(multipanelfigure)}

\NormalTok{image_files <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"../figs/FstOutliers_NoBayenv.png"}\NormalTok{,}
                 \StringTok{"../figs/sharedStacks.png"}\NormalTok{,}
                 \StringTok{"../figs/sharedPerms.png"}\NormalTok{)}


\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/fstPlots.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{4}\NormalTok{,}\DataTypeTok{width=}\FloatTok{6.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{20}\NormalTok{)}
\NormalTok{figure <-}\StringTok{ }\KeywordTok{multi_panel_figure}\NormalTok{(}
  \DataTypeTok{width =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{2}\NormalTok{),}
  \DataTypeTok{height =} \KeywordTok{c}\NormalTok{(}\FloatTok{1.8}\NormalTok{,}\FloatTok{1.8}\NormalTok{),}
  \DataTypeTok{unit =} \StringTok{"inches"}\NormalTok{,}
  \DataTypeTok{row_spacing =} \FloatTok{0.0}\NormalTok{,}
  \DataTypeTok{column_spacing =} \DecValTok{0}\NormalTok{,}
    
\NormalTok{)}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{1}\NormalTok{],}\DataTypeTok{row =} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{,}
                        \DataTypeTok{allow_panel_overwriting =} \OtherTok{TRUE}\NormalTok{) )}
\CommentTok{#(figure %<>% fill_panel(image_files[2],column=2,row=1:2,scaling="fit"))}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{2}\NormalTok{], }\DataTypeTok{column=}\DecValTok{2}\NormalTok{, }\DataTypeTok{row=}\DecValTok{1}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{,}
                        \DataTypeTok{allow_panel_overwriting =} \OtherTok{TRUE}\NormalTok{) )}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{3}\NormalTok{],}\DataTypeTok{column=}\DecValTok{2}\NormalTok{,}\DataTypeTok{row=}\DecValTok{2}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{,}
                        \DataTypeTok{allow_panel_overwriting =} \OtherTok{TRUE}\NormalTok{) )}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\subsection*{PCAdapt}\label{pcadapt-1}
\addcontentsline{toc}{subsection}{PCAdapt}

For this analysis, to maintain consistency with the other outlier
analyses, I'm using the subestted dataset. So I need to run PCAdapt
({\textbf{???}}) another time.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vcf<-}\KeywordTok{parse.vcf}\NormalTok{(}\StringTok{"converted_subset.vcf"}\NormalTok{)}
\KeywordTok{write.table}\NormalTok{(}\StringTok{"##fileformat=VCFv"}\NormalTok{,}\StringTok{"pcadapt_fw/fwsw.pruned.vcf"}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{,}
            \DataTypeTok{col.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{suppressWarnings}\NormalTok{(}\KeywordTok{write.table}\NormalTok{(vcf,}\StringTok{"pcadapt_fw/fwsw.pruned.vcf"}\NormalTok{,}
                             \DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{append =} \OtherTok{TRUE}\NormalTok{,}
                             \DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(pcadapt)}
\CommentTok{#need to remove the first line with a # }
\NormalTok{filename<-}\KeywordTok{read.pcadapt}\NormalTok{(}\StringTok{"pcadapt_fw/fwsw.pruned.vcf"}\NormalTok{,}\DataTypeTok{type=}\StringTok{"vcf"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## No variant got discarded.
## Summary:
## 
##  - input file:               pcadapt_fw/fwsw.pruned.vcf
##  - output file:              /tmp/RtmpWYtABi/file21ac69a1c01c.pcadapt
## 
##  - number of individuals detected:   303
##  - number of loci detected:      12103
## 
## 12103 lines detected.
## 303 columns detected.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x<-}\KeywordTok{pcadapt}\NormalTok{(filename, }\DataTypeTok{K=}\DecValTok{20}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(x,}\DataTypeTok{option=}\StringTok{"screeplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/pcadaptOutliers-1} \caption{Screeplot for the subsetted dataset with 20 PC axes retained in the analysis.}\label{fig:pcadaptOutliers}
\end{figure}

\(K=4\) seems like the best choice here to keep values to the left of
the straight line (or could be \(K=6\)).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Organize pop info}
\NormalTok{pops<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"sample_(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\}).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(vcf)[}\DecValTok{10}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(vcf)])   }
\NormalTok{grp<-pops}
\NormalTok{grp[grp}\OperatorTok{==}\StringTok{"TXFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"LAFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"ALFW"} \OperatorTok{|}\StringTok{ }\NormalTok{grp}\OperatorTok{==}\StringTok{"FLLG"}\NormalTok{]<-}\StringTok{"freshwater"}
\NormalTok{grp[grp}\OperatorTok{!=}\StringTok{"freshwater"}\NormalTok{]<-}\StringTok{"saltwater"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res<-}\KeywordTok{pcadapt}\NormalTok{(filename,}\DataTypeTok{K=}\DecValTok{4}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(res, }\DataTypeTok{option=}\StringTok{"manhattan"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptK4-1-1} \caption{Manhattan plot for the PCAdapt outlier analysis with the subsetted dataset and 4 PC axes retained in the analysis.}\label{fig:PcadaptK4-1}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(res, }\DataTypeTok{option=}\StringTok{"qqplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptK4-2-1} \caption{Q-Q plot for the PCAdapt outlier analysis with the subsetted dataset and 4 PC axes retained in the analysis.}\label{fig:PcadaptK4-2}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(res, }\DataTypeTok{option=}\StringTok{"stat.distribution"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptK4-3-1} \caption{Distribution of the  for the PCAdapt outlier analysis with the subsetted dataset and 4 PC axes retained in the analysis.}\label{fig:PcadaptK4-3}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(res, }\DataTypeTok{option=}\StringTok{"scores"}\NormalTok{,}\DataTypeTok{pop=}\NormalTok{pops)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptK4-4-1} \caption{Plot of the scores from the PCAdapt outlier analysis with the subsetted dataset and 4 PC axes retained in the analysis.}\label{fig:PcadaptK4-4}
\end{figure}

The PCAdapt vignette recommends displaying the loadings and evaluate if
loadings are clustered in single or several genomic regions

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow =} \KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)}
  \KeywordTok{plot}\NormalTok{(res}\OperatorTok{$}\NormalTok{loadings[, i], }\DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{.3}\NormalTok{, }\DataTypeTok{ylab =} \KeywordTok{paste0}\NormalTok{(}\StringTok{"Loadings PC"}\NormalTok{, i))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptLoadings-1} \caption{Plots of the loadings for the four PC axes according to genomic position (on the x-axis).}\label{fig:PcadaptLoadings}
\end{figure}

This suggests that loadings are not clustered (assuming these are
grouped by space), so we don't need to worry about LD thinning. Now
let's look chromosome by chromosome:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\FloatTok{1.5}\NormalTok{))}
\NormalTok{l<-}\KeywordTok{lapply}\NormalTok{(lgs, }\ControlFlowTok{function}\NormalTok{(lg,vcf)\{}
  \KeywordTok{plot}\NormalTok{(res}\OperatorTok{$}\NormalTok{loadings[}\KeywordTok{which}\NormalTok{(vcf}\OperatorTok{$}\StringTok{`}\DataTypeTok{#CHROM}\StringTok{`} \OperatorTok{%in%}\StringTok{ }\NormalTok{lg), }\DecValTok{1}\NormalTok{], }\DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{.3}\NormalTok{, }
       \DataTypeTok{xlab =} \KeywordTok{paste0}\NormalTok{(}\StringTok{"Position on "}\NormalTok{, lg), }\DataTypeTok{ylab =} \StringTok{"Loadings PC 1"}\NormalTok{)}
  \KeywordTok{mtext}\NormalTok{(lg,}\DecValTok{3}\NormalTok{,}\DataTypeTok{outer=}\OtherTok{FALSE}\NormalTok{)}
\NormalTok{\},}\DataTypeTok{vcf=}\NormalTok{vcf)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/PcadaptLoadingsChr-1} \caption{Inspecting the loadings for the four PC axes according to genomic position (on the x-axis) for each chromosome individually.}\label{fig:PcadaptLoadingsChr}
\end{figure}

None of the LGs seem to have huge clusters of outliers so we can move
on, lumping them all together.

We need to choose a cutoff for outlier detection. I'll use the qvalue
approach, which identifies outliers with a false discovery rate of
\(\alpha\), which I'm setting here to 0.05.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(qvalue)}
\NormalTok{qval <-}\StringTok{ }\KeywordTok{qvalue}\NormalTok{(res}\OperatorTok{$}\NormalTok{pvalues)}\OperatorTok{$}\NormalTok{qvalues}
\NormalTok{alpha <-}\StringTok{ }\FloatTok{0.05}
\NormalTok{outliers <-}\StringTok{ }\KeywordTok{which}\NormalTok{(qval }\OperatorTok{<}\StringTok{ }\NormalTok{alpha)}
\NormalTok{snp_pc<-}\KeywordTok{get.pc}\NormalTok{(res,outliers) }\CommentTok{# Get the PCs associated with outliers}
\end{Highlighting}
\end{Shaded}

We identified 181 outliers with this analysis, which are associated with
4 of the 4 clusters. If we look at the distribution of these, though, we
see that most are associated with PC 1

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{table}\NormalTok{(snp_pc}\OperatorTok{$}\NormalTok{PC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##   1   2   3   4 
## 115  36  10  20
\end{verbatim}

Now we can add the qvalues to the fw\_SNPinfo dataframe

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{pcadaptQ<-qval}
\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{pcadaptPC<-}\KeywordTok{get.pc}\NormalTok{(res,}\DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(qval))}\OperatorTok{$}\NormalTok{PC}
\KeywordTok{saveRDS}\NormalTok{(fw_SNPinfo,}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

I should note that for some of these PCAdapt gives ``NA'' -- not sure
what causes this behaviour but there it is. It's true for the residuals
and everything else. It looks to be due to low allele frequencies --
though stacks should have been run with a minimum allele frequency
cutoff, so this is perplexing.

\section*{Bayenv}\label{bayenv}
\addcontentsline{toc}{section}{Bayenv}

Investigate the environmental data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{env.data<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"bayenv/env_data_raw.csv"}\NormalTok{,}\DataTypeTok{row.names =} \DecValTok{1}\NormalTok{)}
\NormalTok{env.data<-}\KeywordTok{rbind}\NormalTok{(env.data,}\DataTypeTok{pop=}\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\StringTok{"SW"}\NormalTok{,}\DecValTok{12}\NormalTok{),}\KeywordTok{rep}\NormalTok{(}\StringTok{"FW"}\NormalTok{,}\DecValTok{4}\NormalTok{)))}
\NormalTok{env.data<-}\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(env.data))}
\KeywordTok{wilcox.test}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(env.data}\OperatorTok{$}\NormalTok{temp)}\OperatorTok{~}\NormalTok{env.data}\OperatorTok{$}\NormalTok{pop) }\CommentTok{#ties, but p=0.539}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  as.numeric(env.data$temp) by env.data$pop
## W = 18.5, p-value = 0.5392
## alternative hypothesis: true location shift is not equal to 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{wilcox.test}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(env.data}\OperatorTok{$}\NormalTok{seagrass)}\OperatorTok{~}\NormalTok{env.data}\OperatorTok{$}\NormalTok{pop) }\CommentTok{#ties, but p=0.897}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  as.numeric(env.data$seagrass) by env.data$pop
## W = 25.5, p-value = 0.8968
## alternative hypothesis: true location shift is not equal to 0
\end{verbatim}

This analysis is of just the freshwater and saltwater populations. First
I ran bayenv using the script \texttt{run\_bayenv2\_matrix\_general.sh}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set up correct file formats}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ FILEMANIP \textbackslash{}}
\NormalTok{bayenv/sub75.pruned.clust stacks/populations_subset75/batch_2.pruned.ped \textbackslash{}}
\NormalTok{stacks/populations_subset75/batch_2.pruned.map bayenv ~/Programs/bayenv 7}
\CommentTok{# estimate matrices}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ MATRIX bayenv ~/Programs/bayenv/ 7}
\end{Highlighting}
\end{Shaded}

At this point I looked at the matrices

\begin{figure}
\centering
\includegraphics{../fwsw_results/bayenv/fwsw75_pruned.png}
\caption{Heatmap plots of each of the ten replicate Bayenv matrices, run
without the Florida populations. Colors represent (co)variances, with
larger values shown in darker colors}
\end{figure}

They all looked fine so I chose the randomly selected a matrix to use
for the remainder of the analyses.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create the SNPFILES}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ SNPFILES SNPSFILE SNPFILES}
\CommentTok{# Run bayenv}
\FunctionTok{nohup}\NormalTok{ ../../scripts/run_bayenv2_matrix_general.sh BAYENV \textbackslash{}}
\NormalTok{~/Programs/bayenv/ matrix env_data_sub75.txt 7 3 SNPFILES }\OperatorTok{>}\NormalTok{ bayenv.log }\KeywordTok{&}
\end{Highlighting}
\end{Shaded}

\subsubsection{Analyze Bayenv output}\label{analyze-bayenv-output}

Once Bayenv was finished running, I first aggregated all of the output.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{get_bayenv_results<-}\ControlFlowTok{function}\NormalTok{(dir,env_vars)\{}
  \CommentTok{# process the variable names}
\NormalTok{  var_names<-}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{lapply}\NormalTok{(env_vars,}\ControlFlowTok{function}\NormalTok{(var)\{}
\NormalTok{    nms<-}\KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(var,}\StringTok{"_BF"}\NormalTok{),}\KeywordTok{paste0}\NormalTok{(var,}\StringTok{"_rho"}\NormalTok{),}\KeywordTok{paste0}\NormalTok{(var,}\StringTok{"_rs"}\NormalTok{))}
    \KeywordTok{return}\NormalTok{(nms)}
\NormalTok{  \}))}
  \CommentTok{# list all the files}
\NormalTok{  bf.files<-}\KeywordTok{list.files}\NormalTok{(}\DataTypeTok{pattern=}\StringTok{"bf"}\NormalTok{,}\DataTypeTok{path =}\NormalTok{ dir,}\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{  xtx.files<-}\KeywordTok{list.files}\NormalTok{(}\DataTypeTok{pattern=}\StringTok{"xtx"}\NormalTok{,}\DataTypeTok{path=}\NormalTok{dir,}\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{)}
  \CommentTok{# get the bf files}
\NormalTok{  bf.dat<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(bf.files,}\ControlFlowTok{function}\NormalTok{(filename)\{}
\NormalTok{    bf<-}\KeywordTok{read.table}\NormalTok{(filename,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{  \}))}
  \KeywordTok{colnames}\NormalTok{(bf.dat)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"locus"}\NormalTok{, var_names)}
  
  \CommentTok{# xtx files}
\NormalTok{  xtx.files<-}\KeywordTok{list.files}\NormalTok{(}\DataTypeTok{pattern=}\StringTok{"xtx"}\NormalTok{,}\DataTypeTok{path=}\NormalTok{dir,}\DataTypeTok{full.names =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{  xtx.dat<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(xtx.files,}\ControlFlowTok{function}\NormalTok{(filename)\{}
\NormalTok{    xtx<-}\KeywordTok{read.table}\NormalTok{(filename,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{  \}))}
  \KeywordTok{colnames}\NormalTok{(xtx.dat)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"locus"}\NormalTok{,}\StringTok{"XtX"}\NormalTok{)}
  
  \CommentTok{# combine the two}
\NormalTok{  bayenv.dat<-}\KeywordTok{merge}\NormalTok{(xtx.dat,bf.dat,}\DataTypeTok{by=}\StringTok{"locus"}\NormalTok{)}
  \KeywordTok{return}\NormalTok{(bayenv.dat)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

The SNP names are uninformative, just the row number the SNP was in. We
can make these better using the freq info

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bayenv_dat<-}\KeywordTok{get_bayenv_results}\NormalTok{(}\DataTypeTok{dir=}\StringTok{"bayenv/SNPFILES"}\NormalTok{,}
                               \DataTypeTok{env_vars=}\KeywordTok{c}\NormalTok{(}\StringTok{"temp"}\NormalTok{,}\StringTok{"salinity"}\NormalTok{,}\StringTok{"seagrass"}\NormalTok{))}

\NormalTok{freq<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"bayenv/bayenv.frq.strat"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T, }\DataTypeTok{stringsAsFactors=}\NormalTok{F)}
\CommentTok{#want to get $MAC for every snp at every pop }
\CommentTok{#and NCHROBS-MAC for every stnp at every pop}
\NormalTok{freq<-}\KeywordTok{cbind}\NormalTok{(freq,freq}\OperatorTok{$}\NormalTok{NCHROBS}\OperatorTok{-}\NormalTok{freq}\OperatorTok{$}\NormalTok{MAC)}
\KeywordTok{colnames}\NormalTok{(freq)[}\KeywordTok{ncol}\NormalTok{(freq)]<-}\StringTok{"NAC"}
\NormalTok{snp.names<-}\KeywordTok{split}\NormalTok{(freq}\OperatorTok{$}\NormalTok{SNP,freq}\OperatorTok{$}\NormalTok{CLST)[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{snp.names<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,snp.names)}

\NormalTok{snp_dat<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{ID=}\NormalTok{snp.names,}\DataTypeTok{loc=}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\KeywordTok{length}\NormalTok{(snp.names)}\OperatorTok{*}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\NormalTok{bayenv_dat}\OperatorTok{$}\NormalTok{locus<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"SNPFILES}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{/(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,bayenv_dat}\OperatorTok{$}\NormalTok{locus))}
\NormalTok{bayenv_dat<-bayenv_dat[}\KeywordTok{order}\NormalTok{(bayenv_dat}\OperatorTok{$}\NormalTok{locus),]}
\NormalTok{bayenv_dat<-}\KeywordTok{merge}\NormalTok{(snp_dat,bayenv_dat,}\DataTypeTok{by.x=}\StringTok{"loc"}\NormalTok{,}\DataTypeTok{by.y=}\StringTok{"locus"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(bayenv_dat)[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{]<-}\KeywordTok{c}\NormalTok{(}\StringTok{"index"}\NormalTok{,}\StringTok{"SNPID"}\NormalTok{)}

\NormalTok{pmap<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.pruned.map"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{) }
\CommentTok{# the position location is wrong in this ^ file}
\NormalTok{pmap}\OperatorTok{$}\NormalTok{locus<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,pmap[,}\DecValTok{2}\NormalTok{])}

\NormalTok{bayenv_dat<-}\KeywordTok{merge}\NormalTok{(pmap[,}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{)],bayenv_dat,}\DataTypeTok{by.x=}\StringTok{"locus"}\NormalTok{,}\DataTypeTok{by.y=}\StringTok{"SNPID"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(bayenv_dat)[}\DecValTok{2}\OperatorTok{:}\DecValTok{3}\NormalTok{]<-}\KeywordTok{c}\NormalTok{(}\StringTok{"Chrom"}\NormalTok{,}\StringTok{"SNPID"}\NormalTok{)}
\KeywordTok{write.table}\NormalTok{(bayenv_dat,}\StringTok{"bayenv/bayenv_output.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{,}
            \DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Merge it with other snp info

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bayenv_dat<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"bayenv/bayenv_output.txt"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{bayenv_dat}\OperatorTok{$}\NormalTok{logSalBF<-}\KeywordTok{log}\NormalTok{(bayenv_dat}\OperatorTok{$}\NormalTok{salinity_BF)}
\NormalTok{bayenv_dat}\OperatorTok{$}\NormalTok{logTemBF<-}\KeywordTok{log}\NormalTok{(bayenv_dat}\OperatorTok{$}\NormalTok{temp_BF)}
\NormalTok{bayenv_dat}\OperatorTok{$}\NormalTok{logSegBF<-}\KeywordTok{log}\NormalTok{(bayenv_dat}\OperatorTok{$}\NormalTok{seagrass_BF)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,}
\NormalTok{                  bayenv_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"SNPID"}\NormalTok{,}\StringTok{"XtX"}\NormalTok{,}\StringTok{"logSalBF"}\NormalTok{,}\StringTok{"logTemBF"}\NormalTok{,}\StringTok{"logSegBF"}\NormalTok{)],}
                  \DataTypeTok{by.x=}\StringTok{"ID"}\NormalTok{,}\DataTypeTok{by.y=}\StringTok{"SNPID"}\NormalTok{,}\DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{saveRDS}\NormalTok{(fw_SNPinfo,}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now we can investigate the outliers etc.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#taken directly from fwsw_analysis.R}
\NormalTok{bayenv.dat<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"bayenv/bayenv_output.txt"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T)}
\CommentTok{# calculate quantiles for bayes factors}
\CommentTok{#focus on Bayes Factors, because of Lotterhos & Whitlock (2015)}
\NormalTok{bf.co<-}\KeywordTok{apply}\NormalTok{(bayenv.dat[,}\KeywordTok{grep}\NormalTok{(}\StringTok{"BF"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(bayenv.dat))],}\DecValTok{2}\NormalTok{,quantile,}\FloatTok{0.99}\NormalTok{) }
\NormalTok{temp.bf.sig<-bayenv.dat[bayenv.dat}\OperatorTok{$}\NormalTok{temp_BF}\OperatorTok{>}\NormalTok{bf.co[}\StringTok{"temp_BF"}\NormalTok{],]}
\NormalTok{sal.bf.sig<-bayenv.dat[bayenv.dat}\OperatorTok{$}\NormalTok{salinity_BF}\OperatorTok{>}\NormalTok{bf.co[}\StringTok{"salinity_BF"}\NormalTok{],]}
\NormalTok{grass.bf.sig<-bayenv.dat[bayenv.dat}\OperatorTok{$}\NormalTok{seagrass_BF}\OperatorTok{>}\NormalTok{bf.co[}\StringTok{"seagrass_BF"}\NormalTok{],]}
\CommentTok{#get the log transformed Bayes Factors}
\NormalTok{bayenv.dat}\OperatorTok{$}\NormalTok{logSal<-}\KeywordTok{log}\NormalTok{(bayenv.dat}\OperatorTok{$}\NormalTok{salinity_BF)}
\NormalTok{bayenv.dat}\OperatorTok{$}\NormalTok{logTemp<-}\KeywordTok{log}\NormalTok{(bayenv.dat}\OperatorTok{$}\NormalTok{temp_BF)}
\NormalTok{bayenv.dat}\OperatorTok{$}\NormalTok{logSeagrass<-}\KeywordTok{log}\NormalTok{(bayenv.dat}\OperatorTok{$}\NormalTok{seagrass_BF)}

\CommentTok{# xtx}
\NormalTok{xtx.sig<-bayenv.dat[bayenv.dat}\OperatorTok{$}\NormalTok{XtX }\OperatorTok{>}\StringTok{ }\KeywordTok{quantile}\NormalTok{(bayenv.dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

There are 0 overlapping outliers between temperature-, salinity-, and
seagrass-associated loci.

But if we only care about salinity ones, there are 122 outliers. Are any
of those XtX outliers too? 0 overlap -- not bad!

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(scales)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{perm=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#e41a1c'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{sal=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#377eb8'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pc=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#a65628'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}
        \DataTypeTok{stacks=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#f781bf'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{xtx=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#ff7f00'}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\CommentTok{#png("../figs/BayenvOutliers.png",height=5,width=8.5,units="in",res=300,pointsize=12)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\CommentTok{# plot XtX}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"XtX"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{stacks_AL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX[plot_dat}\OperatorTok{$}\NormalTok{stacks_AL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)}\OperatorTok{^}\StringTok{"T"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}

\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\DecValTok{0}\NormalTok{)}

\CommentTok{# plot Bayes Factors}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(plot_dat,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"logSalBF"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{stacks_AL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF[plot_dat}\OperatorTok{$}\NormalTok{stacks_AL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"log(Salinity Bayes Factors)"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}

\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\DecValTok{5}\NormalTok{)}

\CommentTok{# add outside legend}

\NormalTok{opar <-}\StringTok{ }\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),}
            \DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{on.exit}\NormalTok{(}\KeywordTok{par}\NormalTok{(opar))}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{xaxt=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{yaxt=}\StringTok{'n'}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\StringTok{"Permutation"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{]),}
         \KeywordTok{expression}\NormalTok{(}\StringTok{"Stacks"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{]),}
         \StringTok{"PCAdapt"}\NormalTok{,}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)}\OperatorTok{^}\NormalTok{T}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)),}\StringTok{"Salinity BF"}\NormalTok{),}
       \DataTypeTok{xjust =} \FloatTok{0.5}\NormalTok{,}\DataTypeTok{x.intersp =} \FloatTok{0.5}\NormalTok{,}
       \DataTypeTok{col =}\NormalTok{ cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{,}\StringTok{"pc"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pt.bg=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{,}\StringTok{"pc"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotBayenv-1} \caption{Manhattan plots of the Bayenv XTX statistic and the log of the Bayes factors associated with salinity. Shown are only loci that mapped to regions on chromosomes. Grey points represent loci that are not outlier in any analyses. Colored points represent outliers in both the Bayenv analyses and the other outlier analyses.}\label{fig:plotBayenv}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#dev.off()}
\end{Highlighting}
\end{Shaded}

\subsubsection{Bayenv without Florida}\label{bayenv-without-florida}

First I need to subset the ped file so that it doesn't contain the
Florida samples.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ped<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"stacks/populations_subset75/batch_2.pruned.ped"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{sep=}\StringTok{' '}\NormalTok{)}
\NormalTok{keep_ped<-ped[}\KeywordTok{grep}\NormalTok{(}\StringTok{"FL"}\NormalTok{,ped}\OperatorTok{$}\NormalTok{V2,}\DataTypeTok{invert=}\OtherTok{TRUE}\NormalTok{),]}
\NormalTok{keep_ped}\OperatorTok{$}\NormalTok{V1<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"sample_(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\}).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,keep_ped}\OperatorTok{$}\NormalTok{V2)))}
\KeywordTok{write.table}\NormalTok{(keep_ped,}\StringTok{"stacks/populations_subset75/noFL_subset75.ped"}\NormalTok{,}\DataTypeTok{col.names=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

And create a cluster file (i.e., pop map)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clust<-keep_ped[,}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{]}
\NormalTok{clust}\OperatorTok{$}\NormalTok{clust<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"sample_(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w\{4\}).*"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,clust}\OperatorTok{$}\NormalTok{V2)}
\KeywordTok{write.table}\NormalTok{(clust,}\StringTok{"bayenv/noFL/sub75.noFL.clust"}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

And I want to use the correctly specified locations

Then I can use the \texttt{run\_bayenv2\_matrix\_general.sh} script to
run the matrices.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# set up correct file formats creating a clust file - run from bayenv/ dir}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ FILEMANIP \textbackslash{}}
\NormalTok{noFL/sub75.noFL.clust ../stacks/populations_subset75/noFL_subset75.ped \textbackslash{}}
\NormalTok{../stacks/populations_subset75/batch_2.pruned.map noFL/ ~/Programs/bayenv 5}
\CommentTok{# estimate matrices}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ MATRIX noFL ~/Programs/bayenv/ 5}
\end{Highlighting}
\end{Shaded}

They're all really similar-looking so I used a randomly-selected one (it
was \#9).

\begin{figure}
\centering
\includegraphics{../fwsw_results/bayenv/noFL/fwsw75_noFL.png}
\caption{Heatmap plots of each of the ten replicate Bayenv matrices.
Colors represent (co)variances, with larger values shown in darker
colors}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create the SNPFILES}
\ExtensionTok{../../scripts/run_bayenv2_matrix_general.sh}\NormalTok{ SNPFILES noFL/SNPSFILE noFL/SNPFILES}
\end{Highlighting}
\end{Shaded}

Before running the analysis, I need to subset and standardize the
environmental data too.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{env_dat<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"bayenv/env_data_sub75.csv"}\NormalTok{,}\DataTypeTok{row.names=}\DecValTok{1}\NormalTok{)}

\CommentTok{# make sure it's in the same order as the plinkfile}
\NormalTok{freq<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"bayenv/noFL/bayenv.frq.strat"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T, }\DataTypeTok{stringsAsFactors=}\NormalTok{F)}
\NormalTok{freq<-}\KeywordTok{cbind}\NormalTok{(freq,freq}\OperatorTok{$}\NormalTok{NCHROBS}\OperatorTok{-}\NormalTok{freq}\OperatorTok{$}\NormalTok{MAC)}
\KeywordTok{colnames}\NormalTok{(freq)[}\KeywordTok{ncol}\NormalTok{(freq)]<-}\StringTok{"NAC"}
\NormalTok{pop.order<-}\KeywordTok{levels}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(freq}\OperatorTok{$}\NormalTok{CLST))}
\NormalTok{snp.names<-}\KeywordTok{split}\NormalTok{(freq}\OperatorTok{$}\NormalTok{SNP,freq}\OperatorTok{$}\NormalTok{CLST)[[}\DecValTok{1}\NormalTok{]]}

\NormalTok{env_dat<-env_dat[,pop.order]}
\NormalTok{std_dat<-}\KeywordTok{t}\NormalTok{(}\KeywordTok{apply}\NormalTok{(env_dat,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  stands<-(x}\OperatorTok{-}\KeywordTok{mean}\NormalTok{(x))}\OperatorTok{/}\KeywordTok{sd}\NormalTok{(x)}
  \KeywordTok{return}\NormalTok{(stands)}
\NormalTok{\}))}

\KeywordTok{write.table}\NormalTok{(std_dat[,pop.order],}
            \StringTok{"bayenv/noFL/env_data_noFL.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{'}\CharTok{\textbackslash{}t}\StringTok{'}\NormalTok{,}\DataTypeTok{col.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Run bayenv}
\FunctionTok{nohup}\NormalTok{ ../../scripts/run_bayenv2_matrix_general.sh BAYENV \textbackslash{}}
\NormalTok{~/Programs/bayenv/ noFL/matrix noFL/env_data_noFL.txt 5 3 noFL/SNPFILES }\OperatorTok{>}\NormalTok{ ../../logs/bayenv_noFL.log }\OperatorTok{2>&1} \KeywordTok{&}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bayenv_noFL<-}\KeywordTok{get_bayenv_results}\NormalTok{(}\DataTypeTok{dir=}\StringTok{"bayenv/noFL/SNPFILES/"}\NormalTok{,}
                               \DataTypeTok{env_vars=}\KeywordTok{c}\NormalTok{(}\StringTok{"temp"}\NormalTok{,}\StringTok{"salinity"}\NormalTok{,}\StringTok{"seagrass"}\NormalTok{))}
\CommentTok{# match up SNP names and IDS}
\NormalTok{snp_names<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"bayenv/noFL/SNPFILES_names.txt"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{FALSE}\NormalTok{)}
\NormalTok{snpsfile<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"bayenv/noFL/SNPSFILE"}\NormalTok{,}\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{)}

\NormalTok{snp_names}\OperatorTok{$}\NormalTok{BayenvID<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(snpsfile)[}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,(}\KeywordTok{nrow}\NormalTok{(snpsfile)}\OperatorTok{-}\DecValTok{1}\NormalTok{),}\DecValTok{2}\NormalTok{)])}
\KeywordTok{colnames}\NormalTok{(snp_names)[}\DecValTok{1}\NormalTok{]<-}\StringTok{"SNP_name"}
\NormalTok{snp_names}\OperatorTok{$}\NormalTok{ID<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,snp_names}\OperatorTok{$}\NormalTok{SNP_name))}
\NormalTok{snp_names}\OperatorTok{$}\NormalTok{Column<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)_(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{2"}\NormalTok{,snp_names}\OperatorTok{$}\NormalTok{SNP_name))}

\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{BayenvID<-}\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{".*/(}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+)"}\NormalTok{,}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,bayenv_noFL}\OperatorTok{$}\NormalTok{locus))}
\NormalTok{bayenv_noFL<-}\KeywordTok{merge}\NormalTok{(bayenv_noFL,snp_names)}

\CommentTok{# get positional info from the master information file}
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{bayenv_noFL<-}\KeywordTok{merge}\NormalTok{(bayenv_noFL,fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{,}\DecValTok{21}\OperatorTok{:}\DecValTok{24}\NormalTok{)],}\DataTypeTok{by=}\StringTok{"ID"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(bayenv_noFL)[}\DecValTok{4}\OperatorTok{:}\DecValTok{13}\NormalTok{]<-}\KeywordTok{paste0}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(bayenv_noFL[,}\DecValTok{4}\OperatorTok{:}\DecValTok{13}\NormalTok{]),}\StringTok{"_noFL"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(bayenv_noFL)[}\DecValTok{19}\OperatorTok{:}\DecValTok{22}\NormalTok{]<-}\KeywordTok{paste0}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(bayenv_noFL[,}\DecValTok{19}\OperatorTok{:}\DecValTok{22}\NormalTok{]),}\StringTok{"_FL"}\NormalTok{)}
\KeywordTok{colnames}\NormalTok{(bayenv_noFL)<-}\KeywordTok{gsub}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{.}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{w"}\NormalTok{,}\StringTok{""}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(bayenv_noFL))}

\CommentTok{# calculate logs of Bayes factors}
\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{logSalBF_noFL<-}\KeywordTok{log}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{salinity_BF_noFL)}
\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{logTemBF_noFL<-}\KeywordTok{log}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{temp_BF_noFL)}
\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{logSegBF_noFL<-}\KeywordTok{log}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{seagrass_BF_noFL)}

\CommentTok{# save to file}
\KeywordTok{write.table}\NormalTok{(bayenv_noFL,}\StringTok{"bayenv/bayenv_output_noFL.txt"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{,}
            \DataTypeTok{col.names =} \OtherTok{TRUE}\NormalTok{,}\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{,}\DataTypeTok{quote =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(scales)}
\NormalTok{bayenv_noFL<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"bayenv/bayenv_output_noFL.txt"}\NormalTok{,}\DataTypeTok{header=}\OtherTok{TRUE}\NormalTok{)}

\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{perm=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#e41a1c'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{sal=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#377eb8'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pc=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#a65628'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}
        \DataTypeTok{stacks=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#f781bf'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{xtx=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#ff7f00'}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\CommentTok{#png("../figs/BayenvOutliers.png",height=5,width=8.5,units="in",res=300,pointsize=12)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\CommentTok{# plot XtX}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(bayenv_noFL,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"XtX_noFL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL[plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL[plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)}\OperatorTok{^}\StringTok{"T"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)),}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}

\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\DecValTok{0}\NormalTok{)}

\CommentTok{# plot Bayes Factors}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(plot_dat,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"logSalBF_noFL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL[plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.85}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL[plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\FloatTok{0.75}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"log(Salinity Bayes Factors)"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{2}\NormalTok{)}

\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\DecValTok{5}\NormalTok{)}

\CommentTok{# add outside legend}

\NormalTok{opar <-}\StringTok{ }\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),}
            \DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{on.exit}\NormalTok{(}\KeywordTok{par}\NormalTok{(opar))}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{xaxt=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{yaxt=}\StringTok{'n'}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)}\OperatorTok{^}\NormalTok{T}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)),}\StringTok{"Salinity BF"}\NormalTok{),}
       \DataTypeTok{xjust =} \FloatTok{0.5}\NormalTok{,}\DataTypeTok{x.intersp =} \FloatTok{0.5}\NormalTok{,}
       \DataTypeTok{col =}\NormalTok{ cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pt.bg=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/plotBayenvNoFL-1} \caption{Manhattan plots of the Bayenv XTX statistic and the log of the Bayes factors associated with salinity from the analysis without the Florida populations. Shown are only loci that mapped to regions on chromosomes. Grey points represent loci that are not outlier in any analyses. Colored points represent outliers in both the Bayenv analyses and the other outlier analyses.}\label{fig:plotBayenvNoFL}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#dev.off()}
\end{Highlighting}
\end{Shaded}

Let's compare the results of the analyses with and without the Florida
populations.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bayenv_cor<-}\KeywordTok{cor}\NormalTok{(bayenv_noFL[,}\KeywordTok{c}\NormalTok{(}\StringTok{"XtX_noFL"}\NormalTok{,}
                   \StringTok{"logSalBF_noFL"}\NormalTok{,}
                   \StringTok{"logTemBF_noFL"}\NormalTok{,}
                   \StringTok{"logSegBF_noFL"}\NormalTok{,}
                   \StringTok{"XtX_FL"}\NormalTok{,}\StringTok{"logSalBF_FL"}\NormalTok{,}\StringTok{"logTemBF_FL"}\NormalTok{,}\StringTok{"logSegBF_FL"}\NormalTok{)])}
\KeywordTok{kable}\NormalTok{(bayenv_cor[}\KeywordTok{grep}\NormalTok{(}\StringTok{"_FL"}\NormalTok{,}\KeywordTok{rownames}\NormalTok{(bayenv_cor)),}\KeywordTok{grep}\NormalTok{(}\StringTok{"_noFL"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(bayenv_cor))],}
      \StringTok{"latex"}\NormalTok{,}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{caption=}\StringTok{"Correlations between the Bayenv analyses without the Florida populations ('noFL') and with the Florida popualtions ('FL'). The comparison of each statistic with itself in each analysis is on the diagonal."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:BayenvCompareFL}Correlations between the Bayenv analyses without the Florida populations ('noFL') and with the Florida popualtions ('FL'). The comparison of each statistic with itself in each analysis is on the diagonal.}
\centering
\begin{tabular}[t]{lrrrr}
\toprule
  & XtX\_noFL & logSalBF\_noFL & logTemBF\_noFL & logSegBF\_noFL\\
\midrule
XtX\_FL & 0.5482418 & 0.3697998 & 0.4264008 & 0.4234426\\
logSalBF\_FL & 0.4926238 & 0.5913697 & 0.3864321 & 0.4268952\\
logTemBF\_FL & 0.3977142 & 0.4089924 & 0.4567702 & 0.3327506\\
logSegBF\_FL & 0.3772125 & 0.3057937 & 0.2178636 & 0.3283923\\
\bottomrule
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{XtX_FL, bayenv_noFL}\OperatorTok{$}\NormalTok{XtX_noFL,}
     \DataTypeTok{xlab=}\StringTok{"XtX with Florida populations"}\NormalTok{,}\DataTypeTok{ylab=}\StringTok{"XtX without Florida Populations"}\NormalTok{,}
     \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(}\StringTok{"dark grey"}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{logSalBF_FL, bayenv_noFL}\OperatorTok{$}\NormalTok{logSalBF_noFL,}
     \DataTypeTok{xlab=}\StringTok{"log of Salinity Bayes Factors with Florida populations"}\NormalTok{,}
     \DataTypeTok{ylab=}\StringTok{"log of Salinity Bayes Factors without Florida Populations"}\NormalTok{,}
     \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(}\StringTok{"dark grey"}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{logTemBF_FL, bayenv_noFL}\OperatorTok{$}\NormalTok{logTemBF_noFL,}
     \DataTypeTok{xlab=}\StringTok{"log of Temperature Bayes Factors with Florida populations"}\NormalTok{,}
     \DataTypeTok{ylab=}\StringTok{"log of Temperature Bayes Factors without Florida Populations"}\NormalTok{,}
     \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(}\StringTok{"dark grey"}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(bayenv_noFL}\OperatorTok{$}\NormalTok{logSegBF_FL, bayenv_noFL}\OperatorTok{$}\NormalTok{logSegBF_noFL,}
     \DataTypeTok{xlab=}\StringTok{"log of Seagrass cover Bayes Factors with Florida populations"}\NormalTok{,}
     \DataTypeTok{ylab=}\StringTok{"log of Seagrass cover Bayes Factors without Florida Populations"}\NormalTok{,}
     \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{1.5}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{alpha}\NormalTok{(}\StringTok{"dark grey"}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]
\includegraphics{202_fwsw_reanalysis_files/figure-latex/BayenvCompareFLPlots-1} \caption{Plots of the Bayenv statistics in the analysis with the Florida populations (x-axis) vs without the Florida populations (y-axis).}\label{fig:BayenvCompareFLPlots}
\end{figure}

Are any of the outliers the same in the two analyses?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bothXtX<-bayenv_noFL}\OperatorTok{$}\NormalTok{ID[bayenv_noFL}\OperatorTok{$}\NormalTok{XtX_FL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_FL,}\FloatTok{0.99}\NormalTok{) }\OperatorTok{&}
\StringTok{                 }\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{XtX_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX_noFL,}\FloatTok{0.99}\NormalTok{)]}
\NormalTok{bothSal<-bayenv_noFL}\OperatorTok{$}\NormalTok{ID[bayenv_noFL}\OperatorTok{$}\NormalTok{logSalBF_FL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_FL,}\FloatTok{0.99}\NormalTok{) }\OperatorTok{&}
\StringTok{                 }\NormalTok{bayenv_noFL}\OperatorTok{$}\NormalTok{logSalBF_noFL}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF_noFL,}\FloatTok{0.99}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

There are 33 SNPs that are XtX outliers in both Bayenv analyses and 58
salinity-associated outliers in both.

\subsection{Bayenv Plots}\label{bayenv-plots}

First we'll get set up with the libraries, code, and data.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(UpSetR);}\KeywordTok{library}\NormalTok{(scales);}\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(grid);}\KeywordTok{library}\NormalTok{(gwscaR);}\KeywordTok{library}\NormalTok{(gridGraphics)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/upset_hacked.R"}\NormalTok{)}
\KeywordTok{source}\NormalTok{(}\StringTok{"../R/205_popgenPlotting.R"}\NormalTok{)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{outliers<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{xtx=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[fw_SNPinfo}\OperatorTok{$}\NormalTok{XtX }\OperatorTok{>=}\StringTok{ }\KeywordTok{quantile}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)],}
               \DataTypeTok{salBF=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[fw_SNPinfo}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}
\StringTok{                                     }\KeywordTok{quantile}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{,}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{)],}
               \DataTypeTok{permutations=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}
                 \KeywordTok{rowSums}\NormalTok{(fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
               \DataTypeTok{pcadapt=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{)],}
               \DataTypeTok{Alabama=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)], }
               \DataTypeTok{Louisiana=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Texas=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Florida=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{sharedStacks=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                                  }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                 }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

Then we'll plot the Stacks Fst outliers.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop.list<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
    \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLLG"}\NormalTok{)}
\NormalTok{pop.labs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"TXSP"}\NormalTok{,}\StringTok{"TXCC"}\NormalTok{,}\StringTok{"TXFW"}\NormalTok{,}\StringTok{"TXCB"}\NormalTok{,}\StringTok{"LAFW"}\NormalTok{,}\StringTok{"ALST"}\NormalTok{,}\StringTok{"ALFW"}\NormalTok{,}\StringTok{"FLSG"}\NormalTok{,}\StringTok{"FLKB"}\NormalTok{,}
            \StringTok{"FLFD"}\NormalTok{,}\StringTok{"FLSI"}\NormalTok{,}\StringTok{"FLAB"}\NormalTok{,}\StringTok{"FLPB"}\NormalTok{,}\StringTok{"FLHB"}\NormalTok{,}\StringTok{"FLCC"}\NormalTok{,}\StringTok{"FLFW"}\NormalTok{)}
\NormalTok{lgs<-}\KeywordTok{c}\NormalTok{(}\StringTok{"LG1"}\NormalTok{,}\StringTok{"LG2"}\NormalTok{,}\StringTok{"LG3"}\NormalTok{,}\StringTok{"LG4"}\NormalTok{,}\StringTok{"LG5"}\NormalTok{,}\StringTok{"LG6"}\NormalTok{,}\StringTok{"LG7"}\NormalTok{,}\StringTok{"LG8"}\NormalTok{,}\StringTok{"LG9"}\NormalTok{,}\StringTok{"LG10"}\NormalTok{,}\StringTok{"LG11"}\NormalTok{,}
    \StringTok{"LG12"}\NormalTok{,}\StringTok{"LG13"}\NormalTok{,}\StringTok{"LG14"}\NormalTok{,}\StringTok{"LG15"}\NormalTok{,}\StringTok{"LG16"}\NormalTok{,}\StringTok{"LG17"}\NormalTok{,}\StringTok{"LG18"}\NormalTok{,}\StringTok{"LG19"}\NormalTok{,}\StringTok{"LG20"}\NormalTok{,}\StringTok{"LG21"}\NormalTok{,}
    \StringTok{"LG22"}\NormalTok{)}
\NormalTok{lgn<-}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{22}\NormalTok{)}
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{perm=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#e41a1c'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{sal=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#377eb8'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{pc=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#a65628'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}
        \DataTypeTok{stacks=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#f781bf'}\NormalTok{,}\FloatTok{0.75}\NormalTok{),}\DataTypeTok{xtx=}\KeywordTok{alpha}\NormalTok{(}\StringTok{'#ff7f00'}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\NormalTok{grp7colors<-}\KeywordTok{c}\NormalTok{(}\StringTok{'#762a83'}\NormalTok{,}\StringTok{'#9970ab'}\NormalTok{,}\StringTok{'#c2a5cf'}\NormalTok{,}\StringTok{'#d9f0d3'}\NormalTok{,}\StringTok{'#a6dba0'}\NormalTok{,}\StringTok{'#5aae61'}\NormalTok{,}\StringTok{'#1b7837'}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/FstOutliers.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{8}\NormalTok{,}\DataTypeTok{width=}\FloatTok{8.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{pointsize=}\DecValTok{20}\NormalTok{)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{xpd=}\OtherTok{TRUE}\NormalTok{)}
\CommentTok{# plot TX}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_TX"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}
                   \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{1}\NormalTok{],grp7colors[}\DecValTok{2}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{1}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_TX[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"TXFW vs. TXCC"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.65}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{)}

\CommentTok{# plot AL}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_AL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}
                   \DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}\DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{3}\NormalTok{],}\StringTok{"lightgrey"}\NormalTok{),}\DataTypeTok{pt.cex =} \DecValTok{1}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_AL[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"ALFW vs. ALST"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.65}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{)}

\CommentTok{# plot LA}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_LA"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}
                   \DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(}\StringTok{"lightgrey"}\NormalTok{,grp7colors[}\DecValTok{3}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{1}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_LA[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"LAFW vs. ALST"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.65}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{)}


\CommentTok{# FL}
\NormalTok{plot_dat<-}\KeywordTok{fst.plot}\NormalTok{(fw_SNPinfo,}\DataTypeTok{scaffs.to.plot =}\NormalTok{ lgs,}\DataTypeTok{fst.name =} \StringTok{"stacks_FL"}\NormalTok{,}
                   \DataTypeTok{chrom.name =} \StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp.name =} \StringTok{"Pos"}\NormalTok{,}\DataTypeTok{axis.size =} \DecValTok{0}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{19}\NormalTok{,}
                   \DataTypeTok{pt.cols =} \KeywordTok{c}\NormalTok{(grp7colors[}\DecValTok{6}\NormalTok{],grp7colors[}\DecValTok{7}\NormalTok{]),}\DataTypeTok{pt.cex =} \DecValTok{1}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[plot_dat}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"sal"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[plot_dat}\OperatorTok{$}\NormalTok{XtX}\OperatorTok{>=}\KeywordTok{quantile}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"xtx"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{3}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}
  \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[}
         \KeywordTok{rowSums}\NormalTok{(plot_dat[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"perm"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{4}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[plot_dat}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"pc"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{0}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{points}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                 }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
\NormalTok{       plot_dat}\OperatorTok{$}\NormalTok{stacks_FL[}\KeywordTok{which}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                  }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                           }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                             }\NormalTok{plot_dat}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
       \DataTypeTok{col=}\NormalTok{cols[}\StringTok{"stacks"}\NormalTok{],}\DataTypeTok{cex=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pch=}\DecValTok{5}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{2}\NormalTok{)}
\KeywordTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DataTypeTok{las=}\DecValTok{1}\NormalTok{,}\DataTypeTok{pos=}\OperatorTok{-}\DecValTok{1500000}\NormalTok{)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"FLFW vs. FLCC"}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DataTypeTok{line=}\DecValTok{1}\NormalTok{,}\DataTypeTok{cex=}\FloatTok{0.65}\NormalTok{)}
\CommentTok{# add the LG labels}
\NormalTok{midpts<-}\KeywordTok{tapply}\NormalTok{(plot_dat}\OperatorTok{$}\NormalTok{plot.pos,plot_dat}\OperatorTok{$}\NormalTok{Chrom,median)}
\KeywordTok{text}\NormalTok{(}\DataTypeTok{x=}\NormalTok{midpts[lgs],}\DataTypeTok{y=}\OperatorTok{-}\FloatTok{0.15}\NormalTok{)}

\CommentTok{# add outside legend}

\NormalTok{opar <-}\StringTok{ }\KeywordTok{par}\NormalTok{(}\DataTypeTok{fig=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{oma=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),}
            \DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{new=}\OtherTok{TRUE}\NormalTok{)}
\KeywordTok{on.exit}\NormalTok{(}\KeywordTok{par}\NormalTok{(opar))}
\KeywordTok{plot}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DataTypeTok{type=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{xaxt=}\StringTok{'n'}\NormalTok{, }\DataTypeTok{yaxt=}\StringTok{'n'}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"top"}\NormalTok{,}\KeywordTok{c}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\StringTok{"Permutation"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{]),}
         \KeywordTok{expression}\NormalTok{(}\StringTok{"Stacks"}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"F"}\NormalTok{)[}\StringTok{"ST"}\NormalTok{]),}
         \StringTok{"PCAdapt"}\NormalTok{,}\KeywordTok{expression}\NormalTok{(}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)}\OperatorTok{^}\NormalTok{T}\OperatorTok{~}\KeywordTok{italic}\NormalTok{(}\StringTok{"X"}\NormalTok{)),}\StringTok{"Salinity BF"}\NormalTok{),}
       \DataTypeTok{xjust =} \FloatTok{0.5}\NormalTok{,}\DataTypeTok{x.intersp =} \FloatTok{0.5}\NormalTok{,}
       \DataTypeTok{col =}\NormalTok{ cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{,}\StringTok{"pc"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pt.bg=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"perm"}\NormalTok{,}\StringTok{"stacks"}\NormalTok{,}\StringTok{"pc"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"sal"}\NormalTok{)],}
       \DataTypeTok{pch=}\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{bty=}\StringTok{'n'}\NormalTok{,}\DataTypeTok{ncol=}\DecValTok{5}\NormalTok{)}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

And create upset plots to show overlap between pairwise Stacks
comparisons and between all outlier methods.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cols<-}\KeywordTok{c}\NormalTok{(}\DataTypeTok{permutations=}\StringTok{'#e41a1c'}\NormalTok{,}\DataTypeTok{salBF=}\StringTok{'#377eb8'}\NormalTok{,}\DataTypeTok{pcadapt=}\StringTok{'#a65628'}\NormalTok{,}
        \DataTypeTok{xtx=}\StringTok{'#ff7f00'}\NormalTok{,}\DataTypeTok{sharedStacks=}\StringTok{'#f781bf'}\NormalTok{,}
        \DataTypeTok{Alabama=}\StringTok{'#af8dc3'}\NormalTok{,}\DataTypeTok{Louisiana=}\StringTok{'#e7d4e8'}\NormalTok{,}\DataTypeTok{Texas=}\StringTok{'#762a83'}\NormalTok{,}\DataTypeTok{Florida=}\StringTok{'#1b7837'}\NormalTok{)}
\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/upsetOutliers.png"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{height=}\DecValTok{4}\NormalTok{,}\DataTypeTok{width=}\FloatTok{7.5}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{20}\NormalTok{)}
\KeywordTok{upset}\NormalTok{(}\KeywordTok{fromList}\NormalTok{(outliers),}\DataTypeTok{sets=}\KeywordTok{c}\NormalTok{(}\StringTok{"permutations"}\NormalTok{,}\StringTok{"salBF"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"pcadapt"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{),}
      \DataTypeTok{point.size=}\FloatTok{3.5}\NormalTok{,}\DataTypeTok{line.size=}\DecValTok{2}\NormalTok{,}\DataTypeTok{mainbar.y.label =} \StringTok{"Number of Shared Outliers"}\NormalTok{,}
      \DataTypeTok{sets.x.label =} \StringTok{" Number of Outliers"}\NormalTok{,}\DataTypeTok{text.scale=}\KeywordTok{c}\NormalTok{(}\FloatTok{1.5}\NormalTok{,}\FloatTok{1.5}\NormalTok{,}\FloatTok{1.5}\NormalTok{,}\FloatTok{1.5}\NormalTok{,}\FloatTok{1.5}\NormalTok{,}\FloatTok{1.5}\NormalTok{),}
      \DataTypeTok{sets.bar.color =}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"permutations"}\NormalTok{,}\StringTok{"salBF"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"pcadapt"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{)],}
      \DataTypeTok{margin1scale =} \FloatTok{0.2}\NormalTok{,}
      \DataTypeTok{sets.pt.color=}\NormalTok{cols[}\KeywordTok{c}\NormalTok{(}\StringTok{"permutations"}\NormalTok{,}\StringTok{"salBF"}\NormalTok{,}\StringTok{"xtx"}\NormalTok{,}\StringTok{"pcadapt"}\NormalTok{,}\StringTok{"sharedStacks"}\NormalTok{)])}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

And finally we'll stitch them together into a final image.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(magick);}\KeywordTok{library}\NormalTok{(multipanelfigure)}

\NormalTok{image_files <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"../figs/FstOutliers.png"}\NormalTok{,}
                 \StringTok{"../figs/upsetOutliers.png"}\NormalTok{,}
                 \StringTok{"../figs/sharedStacks.png"}\NormalTok{)}


\KeywordTok{png}\NormalTok{(}\StringTok{"../figs/fstPlots.png"}\NormalTok{,}\DataTypeTok{height=}\DecValTok{4}\NormalTok{,}\DataTypeTok{width=}\DecValTok{8}\NormalTok{,}\DataTypeTok{units=}\StringTok{"in"}\NormalTok{,}\DataTypeTok{res=}\DecValTok{300}\NormalTok{,}\DataTypeTok{pointsize =} \DecValTok{11}\NormalTok{)}
\NormalTok{figure <-}\StringTok{ }\KeywordTok{multi_panel_figure}\NormalTok{(}
  \DataTypeTok{width =} \KeywordTok{c}\NormalTok{(}\FloatTok{4.5}\NormalTok{, }\DecValTok{3}\NormalTok{),}
  \DataTypeTok{height =} \KeywordTok{c}\NormalTok{(}\FloatTok{1.8}\NormalTok{,}\FloatTok{1.8}\NormalTok{),}
  \DataTypeTok{unit =} \StringTok{"inches"}\NormalTok{,}
  \DataTypeTok{row_spacing =} \FloatTok{0.0}\NormalTok{,}\DataTypeTok{column_spacing =} \DecValTok{0}
\NormalTok{)}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{1}\NormalTok{],}\DataTypeTok{row =} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{,}
                        \DataTypeTok{allow_panel_overwriting =} \OtherTok{TRUE}\NormalTok{) )}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{3}\NormalTok{], }\DataTypeTok{column=}\DecValTok{2}\NormalTok{, }\DataTypeTok{row=}\DecValTok{1}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{) )}
\NormalTok{(figure }\OperatorTok{%<>%}\StringTok{ }\KeywordTok{fill_panel}\NormalTok{(image_files[}\DecValTok{2}\NormalTok{],}\DataTypeTok{column=}\DecValTok{2}\NormalTok{,}\DataTypeTok{row=}\DecValTok{2}\NormalTok{,}\DataTypeTok{scaling=}\StringTok{"fit"}\NormalTok{))}
\KeywordTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{../figs/fstPlots.png}
\caption{Multipanel figure showing the locations of outlier loci in the
genome (A) as well as overlap between the outlier analyses (B and C).
This figure is Figure 2 in the main text.}
\end{figure}

\subsection*{Annotations}\label{annotations}
\addcontentsline{toc}{subsection}{Annotations}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{annotate_snps<-}\ControlFlowTok{function}\NormalTok{(snpDF,gff,genome.blast,}\DataTypeTok{ID=}\StringTok{"Locus.ID"}\NormalTok{,}
                        \DataTypeTok{chrom=}\StringTok{"Chr"}\NormalTok{,}\DataTypeTok{bp=}\StringTok{"BP"}\NormalTok{,}\DataTypeTok{pos=}\StringTok{"Column"}\NormalTok{)}
\NormalTok{\{}
\NormalTok{  fw.sig.reg<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(snpDF,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(sig)\{}
\NormalTok{    this.gff<-gff[}\KeywordTok{as.character}\NormalTok{(gff}\OperatorTok{$}\NormalTok{seqname) }\OperatorTok{%in%}\StringTok{ }
\StringTok{                    }\KeywordTok{as.character}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(sig[chrom])),]}
\NormalTok{    description<-}\OtherTok{NA}
\NormalTok{    SSCID<-}\OtherTok{NA}
    \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(this.gff)}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
      
\NormalTok{      this.reg<-this.gff[}\KeywordTok{which}\NormalTok{(this.gff}\OperatorTok{$}\NormalTok{start }\OperatorTok{<=}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sig[bp]) }\OperatorTok{&}\StringTok{ }
\StringTok{                           }\NormalTok{this.gff}\OperatorTok{$}\NormalTok{end }\OperatorTok{>=}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(sig[bp])),]}
      \ControlFlowTok{if}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(this.reg) }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
        \ControlFlowTok{if}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(sig[bp]) }\OperatorTok{>}\StringTok{ }\KeywordTok{max}\NormalTok{(}\KeywordTok{as.numeric}\NormalTok{(this.gff}\OperatorTok{$}\NormalTok{end)))\{}
\NormalTok{          region<-}\StringTok{"beyond.last.contig"}
\NormalTok{        \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{          region<-}\OtherTok{NA}
\NormalTok{        \}}
\NormalTok{      \}}\ControlFlowTok{else}\NormalTok{\{}
        \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\StringTok{"SSCG}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{,this.reg}\OperatorTok{$}\NormalTok{attribute))}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
\NormalTok{          geneID<-}\KeywordTok{unique}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{".*(SSCG}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+).*"}\NormalTok{,}
                              \StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{,}
\NormalTok{                              this.reg}\OperatorTok{$}\NormalTok{attribute[}\KeywordTok{grep}\NormalTok{(}\StringTok{"SSCG}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{,}
\NormalTok{                                                      this.reg}\OperatorTok{$}\NormalTok{attribute)]))}
\NormalTok{          gene<-genome.blast[genome.blast}\OperatorTok{$}\NormalTok{sscv4_gene_ID }\OperatorTok{%in%}\StringTok{ }\NormalTok{geneID,}
                             \StringTok{"blastp_hit_description"}\NormalTok{]}
\NormalTok{        \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{          geneID<-}\OtherTok{NA}
\NormalTok{          gene<-}\OtherTok{NA}
\NormalTok{        \}}
        \CommentTok{# if there are multiples they'll be in separated by a semi-colon}
\NormalTok{        region<-}\KeywordTok{paste}\NormalTok{(this.reg}\OperatorTok{$}\NormalTok{feature,}\DataTypeTok{collapse =} \StringTok{";"}\NormalTok{)}
\NormalTok{        description<-}\KeywordTok{paste}\NormalTok{(gene,}\DataTypeTok{collapse=}\StringTok{";"}\NormalTok{)}
\NormalTok{        SSCID<-}\KeywordTok{paste}\NormalTok{(geneID,}\DataTypeTok{collapse=}\StringTok{";"}\NormalTok{)}
\NormalTok{      \}}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{      region<-}\StringTok{"scaffNotFound"}
\NormalTok{    \}}
    \KeywordTok{return}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Locus=}\NormalTok{sig[[ID]],}\DataTypeTok{Chr=}\NormalTok{sig[chrom],}\DataTypeTok{BP=}\NormalTok{sig[bp],}\DataTypeTok{SNPCol=}\NormalTok{sig[pos],}
                      \DataTypeTok{region=}\NormalTok{region, }\DataTypeTok{description=}\NormalTok{description,}\DataTypeTok{SSCID=}\NormalTok{SSCID,}
                      \DataTypeTok{row.names=}\OtherTok{NULL}\NormalTok{))}
\NormalTok{  \}))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gff.name<-}\StringTok{"ssc_2016_12_20_chromlevel.gff.gz"}
\ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(}\StringTok{"gz"}\NormalTok{,gff.name))}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
\NormalTok{  gff<-}\KeywordTok{read.delim}\NormalTok{(}\KeywordTok{gzfile}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"../../scovelli_genome/"}\NormalTok{,gff.name,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{)),}\DataTypeTok{header=}\NormalTok{F)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{  gff<-}\KeywordTok{read.delim}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"../../scovelli_genome/"}\NormalTok{,gff.name,}\DataTypeTok{sep=}\StringTok{""}\NormalTok{),}\DataTypeTok{header=}\NormalTok{F)}
\NormalTok{\}}
\KeywordTok{colnames}\NormalTok{(gff)<-}\KeywordTok{c}\NormalTok{(}\StringTok{"seqname"}\NormalTok{,}\StringTok{"source"}\NormalTok{,}\StringTok{"feature"}\NormalTok{,}\StringTok{"start"}\NormalTok{,}\StringTok{"end"}\NormalTok{,}\StringTok{"score"}\NormalTok{,}
                 \StringTok{"strand"}\NormalTok{,}\StringTok{"frame"}\NormalTok{,}\StringTok{"attribute"}\NormalTok{)}
\NormalTok{genome.blast<-}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"../../scovelli_genome/ssc_2016_12_20_cds_nr_blast_results.csv"}\NormalTok{,}
                       \DataTypeTok{skip=}\DecValTok{1}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T)}\CommentTok{#I saved it as a csv}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}

\NormalTok{snp_annotate<-}\KeywordTok{annotate_snps}\NormalTok{(fw_SNPinfo,gff,genome.blast,}\DataTypeTok{ID=}\StringTok{"ID"}\NormalTok{,}
                            \DataTypeTok{chrom=}\StringTok{"Chrom"}\NormalTok{,}\DataTypeTok{bp=}\StringTok{"BP"}\NormalTok{,}\DataTypeTok{pos =} \StringTok{"Pos"}\NormalTok{)}
\NormalTok{snp_annotate}\OperatorTok{$}\NormalTok{Locus<-}\KeywordTok{as.character}\NormalTok{(snp_annotate}\OperatorTok{$}\NormalTok{Locus)}
\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID<-}\KeywordTok{as.character}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{ID)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,snp_annotate[,}\OperatorTok{-}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)],}
                  \DataTypeTok{by.x=}\StringTok{"ID"}\NormalTok{,}\DataTypeTok{by.y=}\StringTok{"Locus"}\NormalTok{,}\DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{)}

\KeywordTok{saveRDS}\NormalTok{(fw_SNPinfo,}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fw_SNPinfo<-}\KeywordTok{readRDS}\NormalTok{(}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\NormalTok{outliers<-}\KeywordTok{list}\NormalTok{(}\DataTypeTok{xtx=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[fw_SNPinfo}\OperatorTok{$}\NormalTok{XtX }\OperatorTok{>=}\StringTok{ }\KeywordTok{quantile}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{XtX,}\FloatTok{0.99}\NormalTok{,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)],}
               \DataTypeTok{salBF=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[fw_SNPinfo}\OperatorTok{$}\NormalTok{logSalBF}\OperatorTok{>=}
\StringTok{                                     }\KeywordTok{quantile}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{logSalBF,}\FloatTok{0.99}\NormalTok{,}\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)],}
               \DataTypeTok{permutations=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}
                 \KeywordTok{rowSums}\NormalTok{(fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\StringTok{"perm_TX"}\NormalTok{,}\StringTok{"perm_FL"}\NormalTok{,}\StringTok{"perm_AL"}\NormalTok{,}\StringTok{"perm_LA"}\NormalTok{)])}\OperatorTok{==}\DecValTok{4}\NormalTok{],}
               \DataTypeTok{pcadapt=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{pcadaptQ}\OperatorTok{<}\FloatTok{0.01}\NormalTok{)],}
               \DataTypeTok{Alabama=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)], }
               \DataTypeTok{Louisiana=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Texas=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{Florida=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)],}
               \DataTypeTok{sharedStacks=}\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{which}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_AL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }
\StringTok{                                                  }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_LA_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}
\StringTok{                 }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_TX_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05} \OperatorTok{&}\StringTok{ }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{stacks_FL_P }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{)])}
\NormalTok{out_snps<-fw_SNPinfo[fw_SNPinfo}\OperatorTok{$}\NormalTok{ID }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unlist}\NormalTok{(outliers),]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{annInfo<-fw_SNPinfo[,}\KeywordTok{c}\NormalTok{(}\StringTok{"ID"}\NormalTok{,}\StringTok{"region"}\NormalTok{)]}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{region<-}\KeywordTok{as.character}\NormalTok{(annInfo}\OperatorTok{$}\NormalTok{region)}

\NormalTok{annInfo}\OperatorTok{$}\NormalTok{region[}\KeywordTok{grep}\NormalTok{(}\StringTok{"UTR"}\NormalTok{,annInfo}\OperatorTok{$}\NormalTok{region)]<-}\StringTok{"regulatory"}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{region[}\KeywordTok{grep}\NormalTok{(}\StringTok{"gene"}\NormalTok{,annInfo}\OperatorTok{$}\NormalTok{region)]<-}\StringTok{"coding"}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{region[annInfo}\OperatorTok{$}\NormalTok{region }\OperatorTok{%in%}\StringTok{ "contig"}\NormalTok{]<-}\StringTok{"non-coding"}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{region[annInfo}\OperatorTok{$}\NormalTok{region }\OperatorTok{%in%}\StringTok{ "scaffNotFound"}\NormalTok{]<-}\StringTok{"unkown"}

\NormalTok{annInfo}\OperatorTok{$}\NormalTok{outlier<-}\StringTok{"not-outlier"}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{outlier[annInfo}\OperatorTok{$}\NormalTok{ID }\OperatorTok{%in%}\StringTok{ }\KeywordTok{unlist}\NormalTok{(outliers)]<-}\StringTok{"outlier"}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{table}\NormalTok{(annInfo}\OperatorTok{$}\NormalTok{region,annInfo}\OperatorTok{$}\NormalTok{outlier),}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{caption=}\StringTok{"The number of SNPs in the subsetted dataset that were outliers in coding and non-coding regions of the genome."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:summarizeAnnotations}The number of SNPs in the subsetted dataset that were outliers in coding and non-coding regions of the genome.}
\centering
\begin{tabular}[t]{lrr}
\toprule
  & not-outlier & outlier\\
\midrule
coding & 4469 & 764\\
non-coding & 3535 & 620\\
regulatory & 363 & 59\\
unkown & 1 & 0\\
\bottomrule
\end{tabular}
\end{table}

If our null hypothesis is that we have randomly selected outliers with
equal probability from coding and non-coding regions, we can use a
Fisher's exact test to calculate the probability of our observed
distribution of outliers.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{fisher.test}\NormalTok{(}\KeywordTok{table}\NormalTok{(annInfo}\OperatorTok{$}\NormalTok{region,annInfo}\OperatorTok{$}\NormalTok{outlier))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Fisher's Exact Test for Count Data
## 
## data:  table(annInfo$region, annInfo$outlier)
## p-value = 0.8654
## alternative hypothesis: two.sided
\end{verbatim}

Based on this, we could conclude that our table of outliers in coding
regions is more extreme than expected under the null.

Now let's look at a more specific set of genes -- those from our
salinity-associated gene set.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{put_genes<-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"putative_genes.txt"}\NormalTok{,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{s<-}\KeywordTok{strsplit}\NormalTok{(put_genes}\OperatorTok{$}\NormalTok{Scovelli_geneID,}\StringTok{","}\NormalTok{)}
\NormalTok{genes<-}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Gene=}\KeywordTok{rep}\NormalTok{(put_genes}\OperatorTok{$}\NormalTok{Gene,}\KeywordTok{sapply}\NormalTok{(s,length)),}
                  \DataTypeTok{SSCID=}\KeywordTok{unlist}\NormalTok{(s),}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{dat<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{apply}\NormalTok{(genes,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(gene,snpinfo)\{}
  \ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{grep}\NormalTok{(gene[}\StringTok{"SSCID"}\NormalTok{],snpinfo}\OperatorTok{$}\NormalTok{SSCID))}\OperatorTok{>}\DecValTok{0}\NormalTok{)\{}
\NormalTok{    ID<-}\KeywordTok{cbind}\NormalTok{(snpinfo}\OperatorTok{$}\NormalTok{ID[}\KeywordTok{grep}\NormalTok{(gene[}\StringTok{"SSCID"}\NormalTok{],snpinfo}\OperatorTok{$}\NormalTok{SSCID)])}
\NormalTok{    out<-}\KeywordTok{data.frame}\NormalTok{(ID,}\KeywordTok{rbind}\NormalTok{(gene),}\DataTypeTok{row.names =} \OtherTok{NULL}\NormalTok{)}
    \KeywordTok{return}\NormalTok{(out)}
\NormalTok{  \}}
\NormalTok{\},}\DataTypeTok{snpinfo=}\NormalTok{fw_SNPinfo))}
\NormalTok{dat<-}\KeywordTok{unique}\NormalTok{(dat)}

\CommentTok{# combine any duplicate annotations}
\NormalTok{dati<-}\KeywordTok{do.call}\NormalTok{(rbind,}\KeywordTok{lapply}\NormalTok{(}\KeywordTok{unique}\NormalTok{(dat}\OperatorTok{$}\NormalTok{ID),}\ControlFlowTok{function}\NormalTok{(id,dat)\{}
\NormalTok{  td<-dat[dat}\OperatorTok{$}\NormalTok{ID }\OperatorTok{%in%}\StringTok{ }\NormalTok{id,]}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{ID=}\NormalTok{id,}
                    \DataTypeTok{Gene=}\KeywordTok{paste}\NormalTok{(td}\OperatorTok{$}\NormalTok{Gene,}\DataTypeTok{collapse =} \StringTok{";"}\NormalTok{),}
                    \DataTypeTok{SSCID=}\KeywordTok{paste}\NormalTok{(td}\OperatorTok{$}\NormalTok{SSCID,}\DataTypeTok{collapse =} \StringTok{";"}\NormalTok{),}
                    \DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{))}
\NormalTok{\},}\DataTypeTok{dat=}\NormalTok{dat))}

\NormalTok{dati}\OperatorTok{$}\NormalTok{ID<-}\KeywordTok{as.character}\NormalTok{(dati}\OperatorTok{$}\NormalTok{ID)}
\NormalTok{fw_SNPinfo<-}\KeywordTok{merge}\NormalTok{(fw_SNPinfo,dati,}\DataTypeTok{by=}\StringTok{"ID"}\NormalTok{,}\DataTypeTok{all.x=}\OtherTok{TRUE}\NormalTok{)}

\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)[}\KeywordTok{colnames}\NormalTok{(fw_SNPinfo)}\OperatorTok{==}\StringTok{"SSCID.x"}\NormalTok{]<-}\StringTok{"SSCID"}
\KeywordTok{saveRDS}\NormalTok{(fw_SNPinfo,}\StringTok{"fw_SNPinfo.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{salgene<-}\StringTok{"not-putative"}
\NormalTok{annInfo}\OperatorTok{$}\NormalTok{salgene[annInfo}\OperatorTok{$}\NormalTok{ID }\OperatorTok{%in%}\StringTok{ }\NormalTok{fw_SNPinfo}\OperatorTok{$}\NormalTok{ID[}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(fw_SNPinfo}\OperatorTok{$}\NormalTok{Gene)]]<-}\StringTok{"putative"}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{table}\NormalTok{(annInfo}\OperatorTok{$}\NormalTok{outlier,annInfo}\OperatorTok{$}\NormalTok{salgene),}\DataTypeTok{booktabs=}\OtherTok{TRUE}\NormalTok{,}
      \DataTypeTok{caption=}\StringTok{"The number of SNPs in the subsetted dataset that were outliers in putative salinity genes or not."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:putativeGeneAnns}The number of SNPs in the subsetted dataset that were outliers in putative salinity genes or not.}
\centering
\begin{tabular}[t]{lrr}
\toprule
  & not-putative & putative\\
\midrule
not-outlier & 10248 & 117\\
outlier & 1714 & 24\\
\bottomrule
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{fisher.test}\NormalTok{(}\KeywordTok{table}\NormalTok{(annInfo}\OperatorTok{$}\NormalTok{outlier,annInfo}\OperatorTok{$}\NormalTok{salgene))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Fisher's Exact Test for Count Data
## 
## data:  table(annInfo$outlier, annInfo$salgene)
## p-value = 0.3967
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.7533815 1.9217177
## sample estimates:
## odds ratio 
##   1.226425
\end{verbatim}

Putative salinity genes do not appear to be enriched with outliers.

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\hypertarget{ref-pickrellInferencePopulationSplits2012}{}
Pickrell, J. K., \& Pritchard, J. K. (2012). Inference of Population
Splits and Mixtures from Genome-Wide Allele Frequency Data. \emph{PLoS
Genetics}, \emph{8}(11), e1002967. doi:
\href{https://doi.org/10.1371/journal.pgen.1002967}{10.1371/journal.pgen.1002967}

\hypertarget{ref-reichReconstructingIndianPopulation2009}{}
Reich, D., Thangaraj, K., Patterson, N., Price, A. L., \& Singh, L.
(2009). Reconstructing Indian population history. \emph{Nature},
\emph{461}(7263, 7263), 489--494. doi:
\href{https://doi.org/10.1038/nature08365}{10.1038/nature08365}

\end{document}
